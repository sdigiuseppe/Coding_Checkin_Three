YUI.add("hermes-lang-default",function(e,t){e.Intl.add("hermes/default","en-US",{UNTITLED:["Untitled"]})},"@VERSION@",{requires:["intl"]});
YUI.add("display-item-tile",function(e){"use strict";var t,n=this.name,r=e.flutil,i=e.Flog;t=e.Base.create(n,e.Views["display-item"],[],{langBundles:this.details.langBundles,initializer:function(t){this.options=r.extend({templateName:"display-item-tile"},t),this.subviews={},this.photo=null,this.assetManager=null,this.bleedWidth=0,this.bleedHeight=0,this.frameWidth=0,this.frameHeight=0,this._style={},this._el={},this.photo=this.options.photo||null;if(this.options.disableFave||this.options.disableMeta||this.options.disableComments)this.subviewConfig=[],this.options.disableFave||this.subviewConfig.push("display-widget-fave"),this.options.disableMeta||this.subviewConfig.push("display-widget-meta"),this.options.disableComments||this.subviewConfig.push("display-widget-comment");return this.photo&&(this.assetManager=new e.AssetManager(this.photo,{maxUpSampleAmount:.05,container:this.get("container"),selector:".ui-display-image",normalizeAspect:!0,noSquares:t.noSquares||!1})),this.paft=t.paft,this},subviewConfig:["display-widget-fave","display-widget-meta","display-widget-comment"],initialize:function(){if(this.is("rendering")||this.is("rendered"))return;this.setupSubviews().then(this.render.bind(this)).then(null,function(e){i.error("ERROR IN "+n,e.stack||e)})},activate:function(){var e=this,t;if(this.is("activating")||this.is("activated"))return;this.options.disableMeta&&this.get("container").addClass("no-meta"),this.get("container").on("click",function(e){var t=2;(e.ctrlKey||e.metaKey||e.which===t)&&e.stopPropagation()}),this.options.photoDeleteRights&&(this.options.photoDeleteRights.allPhotos?t=!0:this.options.photoDeleteRights.ownPhotos&&this.photo.getValue("isOwner")&&(t=!0),t&&(this.get("container").one(".ui-delete-button").addClass("enabled"),this.attachEvents({":delete":function(t){e.fire("deletePhoto",{photo:e.photo})}}))),this.activateSubviews(),this.fire("activated")},render:function(){this.buildContainer({paft:this.paft,photo:this.getPhotoJSON()}),this.resetStyles()},getPhotoJSON:function(){var e=this.photo.toJSON();return e.url+=this.options.context||"",e.current=this.assetManager.toJSON(),e},resize:function(e,t){this.assetManager.setSize(e,t),this.bleedWidth=this.frameWidth=this.assetManager.naturalWidth,this.bleedHeight=this.frameHeight=this.assetManager.naturalHeight,this.fitToSize(this.assetManager.width,this.assetManager.height),this.fire("resize",{width:e||null,height:t||null})},fitToSize:function(e,t){var n={};n.overflow="hidden",n.width=this.frameWidth=e,n.width+="px",n.height=this.frameHeight=t,n.height+="px",this.setStyles("displayMask",n)},hibernate:function(){var e;if(this.is("hibernating"))return;this.is("hibernating",!0),e=this.get("container"),this.assetManager&&this.assetManager.cancel(),this.ancestor=this.ancestor||e.ancestor(),this.ancestor&&this.ancestor.addClass("ui-state-hibernating")},wake:function(){var e;if(!this.is("hibernating"))return;this.is("hibernating",!1),e=this.get("container"),this.ancestor=this.ancestor||e.ancestor(),this.ancestor&&this.ancestor.removeClass("ui-state-hibernating"),this.assetManager.load()},remove:function(){var e=this.get("container");e.addClass("no-meta"),e.addClass("deleted")},destructor:function(){this._style=null,this._el=null,this.assetManager=null}}),e.namespace("Views")[n]=t},"@VERSION@",{requires:["flutil","flog","display-item","hermes-template-display-item-tile","display-item-tile-css"],optional:["display-widget-fave","display-widget-comment","display-widget-meta"],langBundles:["groups"]});
YUI.add("hermes-lang-groups",function(e,t){e.Intl.add("hermes/groups","en-US",{POST_THRESHOLD_EVER:["Members can post ",{type:"plural",valueName:"count",options:{one:"<b>${#}</b> thing",other:"<b>${#}</b> things"}}," to the pool."],POST_THRESHOLD_DAY:["Members can post ",{type:"plural",valueName:"count",options:{one:"<b>${#}</b> thing",other:"<b>${#}</b> things"}}," to the pool each day."],POST_THRESHOLD_MONTH:["Members can post ",{type:"plural",valueName:"count",options:{one:"<b>${#}</b> thing",other:"<b>${#}</b> things"}}," to the pool each month."],POST_THRESHOLD_WEEK:["Members can post ",{type:"plural",valueName:"count",options:{one:"<b>${#}</b> thing",other:"<b>${#}</b> things"}}," to the pool each year."],ACCEPTED_CONTENT_TYPES:["Accepted content types:"],ACCEPTED_SAFETY_LEVELS:["Accepted safety levels:"],PHOTOS:["Photos"],VIDEOS:["Videos"],IMAGES:["Images"],SCREENSHOTS:["Screenshots"],ART:["Art"],SAFE:["Safe"],MODERATE:["Moderate"],RESTRICTED:["Restricted"],SEE_ALL_DISCUSSIONS:["See all discussions"],DISCUSSION_TITLE:["Title"],DISCUSSION_AUTHOR:["Author"],DISCUSSION_REPLIES:["Replies"],DISCUSSION_LAST_POST:["Latest Post"],DISCUSSION_LAST_REPLIER:["Last Replier"],NO_DISCUSSIONS:["Be the first to start a group discussion!"],BE_THE_FIRST:["Be the first to add a photo to the group!"],BE_THE_FIRST_JOIN:["Help get this group started: click the join button above!"],BE_THE_FIRST_SIGN_IN:["Help get this group started: sign in and contribute photos!"],NO_PHOTOS_BY_YOU:["You haven't added any photos yet. What are you waiting for?"],WHO_IS_ME:['Who is this "me" of which you speak?'],INVALID_PERSON:["Never heard of him. her? ...it. Sorry!"],ADD_SOME_PHOTOS:["Add some photos"],NO_PHOTOS:["No photos in this group"],POOL_PREVIEW_HEADER:["Photo pool"],POOL_HEADER:["Group pool"],ADD_PHOTO:["Add photo"],VIEW_X_PHOTOS:[{type:"plural",valueName:"count",options:{one:"View ${#} photos",other:"View ${#} photos"}}],DISCUSSIONS:["Discussions"],ADD_TOPIC:["Add topic"],SEARCH_DISCUSSIONS:["Search discussions"],SEARCH_POOL:["Search pool"],ADD_A_TOPIC:["Add a topic"],TOP_CONTRIBUTORS:["Top Contributors"],CONTRIBUTORS:["Contributors"],CONTRIBUTORS_RANK:["Rank"],CONTRIBUTORS_LATEST_PHOTO:["Latest Photo"],CONTRIBUTORS_PHOTOS:["Photos"],CONTRIBUTORS_DISCUSSIONS:["Discussions"],CONTRIBUTORS_JOINED_GROUP:["Joined Group"],SEE_ALL_MEMBERS:["View all members"],TOTAL_DISCUSSIONS:[{type:"plural",valueName:"count",options:{one:"1 discussion in",other:"${#} discussions in"}}," ","${groupname}"],DISCUSSION_STICKY:["Sticky"],RANKING:["#","${count}"],BLAST_INVITED_MEMBER:["MEMBER"],BLAST_PENDING_MEMBER:["MEMBER"],BLAST_GROUP_MEMBER:["MEMBER"],BLAST_MODERATOR:["MODERATOR"],BLAST_ADMIN:["ADMIN"],SHARE:["Share"],EIGHTTEEN_PLUS_SIGNEDIN:["This group is 18+, do you want to enter?"],EIGHTEEN_PLUS_SIGNEDOUT:["This group is 18+. Sign in to view the group."],NO:["No"],YES:["Yes"],GROUP_POOL_LOADING_ERROR:["Error loading the group's pool photos"],GROUP_DISCUSSION_LOADING_ERROR:["Error loading the group's discussion list"],GROUP_TOP_CONTRIBUTORS_LOADING_ERROR:["Error loading the group's top contributors"],GROUP_DELETION_ERROR:["Something went wrong deleting the photo...please try again."],RETRY:["Retry"],ADDED_NOTIFICATION:['Success! Would you like to <a href="',"${url}",'">add something else</a>?'],NOT_ADDED_NOTIFICATION:['That\u2019s already in the group pool. <a href="',"${url}",'">Try something else?</a>'],PENDING_NOTIFICATION:['Your photo/video has been submitted the group. If approved by the group administrator, it will show up in the group pool. Would you like to <a href="',"${url}",'">add another</a>?'],DONE_PENDING_NOTIFICATION:["All done! There's nothing else to moderate."],DELETED_NOTIFICATION:["That item has been removed from the pool."],POOL_MEMBERS_ONLY:["This group pool is for members only."],DISCUSSION_MEMBERS_ONLY:["This group discussion is for members only."],DISCUSSION_MEMBERS_ONLY_INTERSTITIAL:["This group discussion is for members only. Join the conversation with the Join group button above, or click Overview to learn more about the group."],REMOVE_PHOTO:["Remove this photo from the group pool?"],PENDING_COUNT_NOTIFICATION:['You have <a href="',"${url}",'">',{type:"plural",valueName:"pendingCount",options:{zero:"0 photos",one:"${#} photo",other:"${#} photos"}}," pending</a>"],X_GROUPS:[{type:"plural",valueName:"count",options:{one:"${#} Group",other:"${#} Groups"}}],HAS_NONE:["Looks like you don't belong to any group, so there is a list of ones you might like below."],SIGNED_OUT:["Groups are a fabulous way to share content and conversation, either privately or with the world. Believe us when we say there's probably a group for everyone, but if you can't find one you like, feel free to start your own."],LAST_REPLY_TIME_AGO:['<a href="',"${replyurl}",'" data-track="groupDiscussionTopicLastReplyClick">',"${time}"," ago</a>"],MEMBERS_ONLY_POOL_JOIN:["Only members can see this group pool. Click Overview above to learn more about the group, or the Join group button above to, uh...join!"],MEMBERS_ONLY_POOL_SIGN_IN:["Only members can see this group pool. Sign in to join the group."],PRIVATE_GROUP:["You've reached a private group."],RETURN_HOME:["Return home"],DISCUSSIONS_DISABLED:["Discussions are disabled for this group."],GO_TO_GROUP_HOME:["Go to group home"],GROUP_JOIN_RULES_DIALOG_TITLE:["Group Rules"],GROUP_JOIN_RULES_DIALOG_MESSAGE:["If you agree to these rules, you can join the group."],GROUP_JOIN_RULES_DIALOG_ACCEPT:["I agree"],GROUP_JOIN_RULES_DIALOG_DECLINE:["No, thanks"],GROUP_JOIN_ERROR:["Something went wrong with joining the group."],GROUP_LEAVE_ERROR:["Something went wrong with leaving the group."],GROUPS:["Groups"],GROUPS_LIST_LOADING_ERROR:['There was an issue loading the groups.<br>Click <a class="retry">Reload</a> to try again.'],GROUPS_LIST_ERROR_HEADER:["Error loading groups"],CONTRIBUTORS_DISCUSSION_TOPICS:["Topics"],GROUPS_LIST_GROUPS:["Groups"],GROUPS_LIST_MEMBERS:["Members"],GROUPS_LIST_PHOTOS:["Photos"
],GROUPS_LIST_TOPICS:["Topics"],GROUPS_LIST_LATEST:["Latest"],GROUPS_LIST_LATEST_DISCUSSION:["Latest Post"],GROUPS_LIST_LATEST_PHOTO:["Latest Photo"],GROUPS_LEAVE_WARNING_TITLE:["Leave ","${title}","?"],GROUPS_LEAVE_WARNING:['Do you really want to leave the group "',"${title}",'?"'],GROUPS_LEAVE_WARNING_LAST_MEMBER:['Do you really want to leave the group "',"${title}",'"? Because you are the last person in this group, the group will be deleted if you leave.'],GROUPS_LEAVE_WARNING_ADMIN:['Do you really want to leave the group "',"${title}",'"? If you are the last administrator in this group, the longest serving member will be promoted to administrator after you leave.'],GROUPS_LEAVE_WARNING_REMOVE_PHOTOS:["<div class='checkbox-prompt'><label><input type=\"checkbox\">Also remove all the photos & videos you have added to the group pool?</input></label></div>"],GROUPS_LEAVE_WARNING_LEAVE_BUTTON:["Leave this group"],GROUPS_LEAVE_WARNING_CANCEL_BUTTON:["Cancel"],EMPTY_BLAST:["There's no admin blast."],ADD_BLAST:["Why don't you add one?"],REMOVING_BLAST:["Removing Blast..."],CREATE_BLAST:["Add Group Admin Blast"],BACK_TO_OVERVIEW:["Back to group overview"],GROUP_POOL:["Group pool"],NO_VISIBLE_PHOTOS:["${screenname}"," doesn't have any photos visible to you in the ","${groupTitle}"," pool."],UPDATE_BLAST_ERROR:["Could not update the group blast at this time"],DELETE_BLAST_ERROR:["Could not delete the group blast at this time"],LONG_BLAST_ERROR:[{type:"plural",valueName:"count",options:{one:"Group blast is 1 character, it must be less than 496 characters.",other:"Group blast is ${#} characters, it must be less than 496 characters."}}],GROUPS_LIST_BELONG_HEADER:["Groups you are a member of"],GROUPS_LIST_BELONG_MORE:["View all groups you are a member of"],PENDING:[{type:"plural",valueName:"count",options:{one:"1 pending",other:"${#} pending"}}],GROUPS_ADMIN:["Groups you administer"],GROUPS_MODERATED:["Groups you moderate"],GROUPS_BELONG:["Groups you are a member of"],GROUPS_FAVED:["Groups you faved"],VIEW_ALL_GROUPS_ADMIN:["View all groups you administer"],VIEW_ALL_GROUPS_MODERATED:["View all groups you moderate"],GROUP_DESCRIPTION:["Group Description"],GROUP_RULES:["Group Rules"],GROUP_ADDITIONAL_INFO:["Additional Info"],PENDING_MEMBER_COUNT_NOTIFICATION:['You have <a href="',"${url}",'">',{type:"plural",valueName:"pendingCount",options:{zero:"0 pending members",one:"${#} pending member",other:"${#} pending members"}},"</a>"],BLAST_DATE_ADDED:[{type:"date",valueName:"blastDateAdded",format:"long"}],GROUP_DISCUSSION_DELETE_REPLY:["Delete reply"],GROUP_DISCUSSION_CONFIRM_DELETE:["Are you sure you want to delete this reply?"],GROUP_DISCUSSION_DELETE:["Delete"],GROUP_DISCUSSION_DELETE_FAILED:["Failed to delete reply, please try again."],GROUP_DISCUSSION_PUBLISH_FAILED:["Failed to publish reply, please try again."],GROUP_DISCUSSION_PUBLISH_REPLY:["Publish reply"],GROUP_DISCUSSION_RECENT_DISCUSSIONS:["Discussions"],GROUP_DISCUSSION_POST_REPLY:["Post reply"],GROUP_DISCUSSION_PUBLISH:["Publish"],GROUP_DISCUSSION_PREVIEW:["Preview"],GROUP_DISCUSSION_EDIT_FAILED:["Failed to edit reply, please try again."],GROUP_DISCUSSION_EDIT_REPLY:["Edit reply"],GROUP_DISCUSSION_PREVIEW_EDIT_FAILED:["Failed to preview edit, please try again."],GROUP_DISCUSSION_PREVIEW_EDIT:["Preview edit"],GROUP_DISCUSSION_PREVIEW_REPLY_FAILED:["Failed to preview reply, please try again."],GROUP_DISCUSSION_PREVIEW_REPLY:["Preview reply"],GROUP_DISCUSSION_POST_LOCKED_WITH_LINK:["Group discussion in ","${groupname}",' has been locked. (<a href="',"${unlockUrl}",'">unlock?</a>)'],GROUP_DISCUSSION_POST_LOCKED:["This topic has been locked."],GROUP_DISCUSSION_REPLY_EDITED:["Posted ","${createdAgo}",". Edited ","${editedAgo}"],GROUP_DISCUSSION_REPLY_EDITED_WITH_ROLE:["Posted ","${createdAgo}",". Edited by ","${editAuthor}"," (","{{editRole}}",") ","${editedAgo}"],GROUP_DISCUSSION_REPLY_EDITED_BY_STAFF:["Posted ","${createdAgo}",". Edited by ","${editAuthor}"," (Staff) ","${editedAgo}"],GROUP_DISCUSSION_DELETE_TOPIC:["Delete topic"],GROUP_DISCUSSION_CONFIRM_DELETE_TOPIC:["Are you sure you want to delete this topic?"],GROUP_DISCUSSION_STICKY_FAILED:["Failed to mark/unmark this topic as sticky.  Please try again"],GROUP_DISCUSSION_STICKY:["Sticky"],GROUP_DISCUSSION_LOCK_FAILED:["Failed to lock/unlock this topic.  Please try again"],GROUP_DISCUSSION_LOCK:["Lock Topic"],DISCUSSION_REPLY_REPLY_PROMPT:["Click to reply to the reply"],DISCUSSION_REPLY_PERMALINK_PROMPT:["Permalink"],DISCUSSION_REPLY_DELETE_PROMPT:["Click to delete this reply"],DISCUSSION_REPLY_EDIT_PROMPT:["Click to edit this reply"],GROUP_DISCUSSION_LOCK_CONFIRMATION_TITLE:["Lock topic"],GROUP_DISCUSSION_LOCK_CONFIRMATION:["Are you sure you want to lock this topic?"],GROUP_DISCUSSION_LOCK_BUTTON:["Lock"],GROUP_DISCUSSION_UNLOCK_CONFIRMATION_TITLE:["Unlock topic"],GROUP_DISCUSSION_UNLOCK_CONFIRMATION:["Are you sure you want to unlock this topic?"],GROUP_DISCUSSION_UNLOCK_BUTTON:["Unlock"],DISCUSSION_MORE_LINK:["More..."],DISCUSSION_SEARCH_LINK:["Search this group's discussions"],DISCUSSION_FORMAT_REPLY:["Want to format your reply?"],GROUP_DISCUSSION_FORMATTING_TITLE:["Discussion Formatting"],GROUP_DISCUSSION_FORMATTING_CLOSE:["Close"],SIGN_IN_TO_REPLY:["Sign in to reply"],DISCUSSION_SIGN_IN_TO_REPLY:["Sign in to reply!"],GROUP_DISCUSSION_PUBLISH_FAILED_LOCKED:["Failed to publish reply. This topic has now been locked."],GROUP_DISCUSSION_PUBLISH_FAILED_LOCKED_OR_NONMEMBER:["Failed to publish reply. This topic is locked or you are not a member of the group."],GROUP_DISCUSSION_PUBLISH_FAILED_DELETED:["Failed to publish reply.  This topic has been deleted."],GROUP_DISCUSSION_GROUP_LOCKED:["All discussions are locked for this group"],GROUP_DISCUSSION_GROUP_LOCKED_WITH_LINK:['All discussions are locked for this group (<a title="unlock group discussions?" href="',"${unlockUrl}",'">unlock?</a>)'],CREATED_YEAR:["Since ","${createdYear}"],UPDATED_TIME_AGO:["Updated ","${updatedAgo}"],GROUP_JOIN:["Join Group"
],GROUP_JOIN_SHORT:["Join"],GROUP_JOINED:["Joined"],GROUP_JOIN_REQUESTED:["Join Requested"],GROUP_JOIN_REQUESTED_SHORT:["Requested"],GROUP_LEAVE_GROUP:["Leave Group"],GROUP_LEAVE_GROUP_SHORT:["Leave"],PHOTOS_LINK_LABEL:["Photos"],DISCUSSIONS_LINK_LABEL:["Discussions"],ADMIN_LINK_LABEL:["Administration"]})},"@VERSION@",{requires:["intl"]});
YUI.add("display-collection",function(e){"use strict";var t,n=e.flutil;t=e.Base.create("DisplayCollection",e.FlickrView,[],{initializer:function(t){this.layout=null,this.payload=[],this.displayItemExtras=t.displayItemExtras||{},this.options=n.extend({displayItemCtr:e.Views["display-item-tile"]},t),this._dataEvents=[],t.paft&&(this.paft=t.paft)},initialize:function(){var t=this,n;return n=new e.FlickrPromise(function(e,n){t.once("rendered",e),t.render()}),n=n.then(null,function(e){console.error("DisplayCollection.render",e+e.stack)}),n},activate:function(){return this},appendPhotos:function(e,t){t||(t=this.options.displayItemCtr),Array.isArray(e)||(e=[e]),this.payload=this.payload.concat(e.map(function(e){return{displayItem:null,displayItemCtr:t,type:"PhotoModel",service:null,renderBatch:null,params:{photo:e}}}))},appendDisplayItems:function(e){Array.isArray(e)||(e=[e]),this.payload=this.payload.concat(e.map(function(e){return{displayItem:e,displayItemCtr:e.constructor,type:"DisplayItem",service:null,renderBatch:null,params:null}}))},appendCollection:function(e,t){var n=this,r,i,s;t||(t=this.options.displayItemCtr),r=function(e,t){t?n.payload=i(e).concat(n.payload):n.payload=n.payload.concat(i(e))},i=function(n){return n.map(function(n){return{displayItem:null,displayItemCtr:t,type:"CollectionPaginator",service:e,renderBatch:null,params:{photo:n}}})},this.detachDataEvents(),s=e.on("listValueChanged",function(e){e.prepended?r(e.prepended,!0):r(e.added||[]),n.render()}),n._dataEvents.push(s),r(e.getCurrentPageAsList())},removePhotos:function(e){var t=this,n;n=e.map(function(e){var n;return t.payload.some(function(t){return t.params&&t.params.photo===e?(n=t,!0):!1}),n}).filter(function(e){return!!e}),n.length&&n.forEach(function(e){e.displayItem.remove()})},clear:function(){if(!this.payload||!this.payload.length)return;this.payload.forEach(function(e){e.displayItem&&e.displayItem.destroy(),e.layout=e.params=null}),this.layout&&this.layout.destroy(),this.initializer(e.merge({},this.options))},createDisplayItem:function(e){var t,r,i=this;return e.displayItem?e.displayItem:(t=n.extend(this.displayItemExtras,e.params,{appContext:this.appContext}),r=e.displayItem=new e.displayItemCtr(t),this.displayItemExtras.photoDeleteRights&&this._dataEvents.push(r.on("deletePhoto",function(e){i.fire("deletePhoto",e)})),r)},render:function(){var e=this,t;this._batch||(this._batch=0),this._batch++,t=this.payload.reduce(function(t,n){if(n.renderBatch)return t;n.renderBatch=e._batch;var r=e.createDisplayItem(n);return t.push(r),t},[]),this.layout.append(t)},positionFromHistory:function(){console.warn("display-collection::positionFromHistory() is a no-op. Implement on a subclass if needed.")},next:function(){var e=this.payload.slice(-1)[0];if(!e||!e.service||!e.service.next)return;return e.service.next()},getId:function(){return"DC-"+this.name.toUpperCase()},detachDataEvents:function(){this._dataEvents.forEach(function(e){e.detach()}),this._dataEvents=[]},destructor:function(){this.detachDataEvents(),this._dataEvents=null,this.layout&&this.layout.destroy(),this.layout=null,this.payload.forEach(function(e){e.displayItem&&e.displayItem.destroy(),e.layout=e.params=null}),this.options=null}},{ATTRS:{container:{value:"",setter:function(e){var t=e||this.getContainer({viewName:n.unCamelCaseify(this.name)});return t}}}}),e.DisplayCollection=t},"@VERSION@",{requires:["flickr-view","flutil","display-item-tile"]});
YUI.add("layout-engine",function(e){"use strict";var t,n,r,i,s=e.flutil,o,u,a;u={debug:!1,displayCollectionListSelector:'[data-layout-element="displayCollection"]'},a={},o=s.getLogger(u.debug),t=function(){e.SimpleEventEmitter.apply(this),this.payload=[],this._style={},this._el={},this.options={}},t.prototype=s.objectCreate(e.SimpleEventEmitter.prototype,{init:function(e){e||(e=this.options),this.container=e.container,this.template=e.template,this.templatePartial=e.templatePartial},renderFragment:function(e){if(!e||!e.length)return this.renderFragmentWrappers([]);var t=this,n,r,i=e.length;n=function(n){if(--i)return;t.renderFragmentWrappers(e)},r=function(e){var t=e.view||e;YUI.Env.isServer||(t.updateDom(),t.activate()),n()},e.forEach(function(e){var t=e.displayItem;if(t.is("rendered"))return r(t);t.once("rendered",r),t.initialize()})},renderFragmentWrappers:function(e){var t=this,i,s,o,a,f,l;this.container.hasChildNodes()||(f=(YUI.Env.isServer?e:e.slice(0,1)).map(function(e){return e.toTemplateJSON()}),o={displayWrappers:f,layout:{styles:this.stylesToJSON()}},this.resetStyles(),i=this.template(o),this.container.setHTML(i),YUI.Env.isServer||(a=this.container.one(u.displayCollectionListSelector),a&&a.setHTML(""))),YUI.Env.isServer||(s=new n,e.forEach(function(e){var n;e.isRendered?e.updateDom():(n=new r,n.render(t.templatePartial,e.toTemplateJSON()),e.setContainer(n.get("firstChild")),s.appendChild(e.container))}),this.updateDom(),s.numNodes()&&(l=this.container.one(u.displayCollectionListSelector),l.appendChild(s.getNode()))),this.fire("rendered")},setStyles:function(e,t){this._style[e]||(this._style[e]={}),s.extend(this._style[e],t)},stylesToJSON:function(){var e=this;return Object.keys(this._style).reduce(function(t,n){var r=e._style[n];return t[n]=Object.keys(r).reduce(function(e,t){return e+t+":"+r[t]+";"},""),t},{})},updateDom:function(){if(YUI.Env.isServer)return;var e=this,t=this.container||this.get("container");Object.keys(this._style).forEach(function(n){var r=e._el[n];r||(e._el[n]=r=t.getDOMNode().getAttribute("data-layout-element")===n?t:t.one('[data-layout-element="'+n+'"]'));if(!r)return;r.setStyles(e._style[n])}),this.resetStyles()},resetStyles:function(){this._style={}},render:function(){console.warn("layout-engine::render() is a no-op. Implement on a subclass if needed.")},append:function(){console.warn("layout-engine::append() is a no-op. Implement on a subclass if needed.")},remove:function(){console.warn("layout-engine::remove() is a no-op. Implement on a subclass if needed.")},scrollTo:function(){console.warn("layout-engine::scrollTo() is a no-op. Implement on a subclass if needed.")},destroy:function(){var t=this.container.one(u.displayCollectionListSelector);t&&t.remove(),this.options=null,this.container.detach(),this.container=null,this._el=null,this._style=null,e.SimpleEventEmitter.prototype.destroy.apply(this)}}),i=t.DisplayWrapper=function(e){this.layout=null,this.container=null,this.displayItem=e,this._style={},this._el={},this.isRendered=!1},i.prototype={setContainer:function(e){this.container=e;var t=this.container.one(".view");t&&this.displayItem.acquireContainer(t),this.isRendered=!0},bindLayout:function(e){this.layout=e},hasLayout:function(){return!!this.layout},setStyles:function(e,t){this._style[e]||(this._style[e]={}),s.extend(this._style[e],t)},position:function(e,t){this.setStyles("displayWrapper",{top:e+"px",left:t+"px"}),this.displayItem.fire("position",{top:e||null,left:t||null})},resetStyles:function(){this._style={}},updateDom:function(){if(YUI.Env.isServer)return;var e=this,t=this.container;Object.keys(this._style).forEach(function(n){var r=e._el[n];r||(e._el[n]=r=t.getDOMNode().getAttribute("data-layout-element")===n?t:t.one('[data-layout-element="'+n+'"]'));if(!r)return;r.setStyles(e._style[n])}),this.resetStyles()},getId:function(){return"DW"+this.displayItem.photo.id},toStylesJSON:function(){var e=this;return Object.keys(this._style).reduce(function(t,n){var r=e._style[n];return t[n]=Object.keys(r).reduce(function(e,t){return e+t+":"+r[t]+";"},""),t},{})},toTemplateJSON:function(){return{layout:{styles:this.toStylesJSON()},displayItem:this.displayItem,id:this.getId()}},destroy:function(){}},n=t.DocumentFragment=function(){this.init()},n.prototype=YUI.Env.isServer?{init:function(){this.html=""},appendChild:function(e){this.html+=e.html},getNode:function(){return this}}:{init:function(e){this._nodes=0,this._fragment=document.createDocumentFragment()},appendChild:function(e){this._nodes++,this._fragment.appendChild(e.getDOMNode())},getNode:function(){return this._fragment},numNodes:function(){return this._nodes}},r=t.DocumentElement=function(){this.init()},r.prototype=YUI.Env.isServer?{init:function(){this.html=""},render:function(e,t){this.setHTML(e(t))},setHTML:function(e){this.html=e},get:function(e){if(e==="firstChild")return this},getDOMNode:function(){return null}}:{init:function(){this.el=document.createElement("div")},setHTML:function(e){this.el.innerHTML=e},render:function(e,t){this.setHTML(e(t));var n=Object.keys(t).reduce(function(e,n){return t[n].render&&(e[t[n].getId()]=t[n].get("container").getDOMNode()),e},{});Array.prototype.slice.call(this.el.getElementsByClassName("hb-placeholder")).forEach(function(e){e.parentNode.replaceChild(n[e.id],e)})},get:function(t){if(t==="firstChild")return e.one(this.el.firstChild)},getDOMNode:function(){return this.el}},e.LayoutEngine=t},"@VERSION@",{requires:["flutil","flickr-promise","simple-event-emitter"]});
YUI.add("layout-engine-justified-row",function(e){"use strict";var t,n=e.flutil,r,i;i={debug:!1,sizeBreakPoint:1500,sizeBump:1.3},r=n.getLogger(i.debug),t=function(t){e.SimpleEventEmitter.apply(this),this.payload=[],this.layoutEngine=null,this.rowIndex=null,this.options=n.extend({vertPadding:5,horizPadding:5,targetHeight:299,targetHeightTolerance:.29,width:"auto",layoutEngine:{}},t),this._targetRange={},this.init()},t.prototype=n.objectCreate(e.SimpleEventEmitter.prototype,{init:function(e){e||(e=this.options),this.height=0,this.displayWidth=this.availableWidth=typeof e.width=="number"?e.width:800,this.width=0,this.overflow=0,this.offsetTop=0},bindLayout:function(e){this.layoutEngine=e.layoutEngine,this.rowIndex=e.rowIndex},addItem:function(e){var t,n=this.getTargetAreaSize();this.payload.push(e);if(this.getScaledWidth()>this.displayWidth&&this.payload.length>1){t=this.getScaledHeight();if(t<n.minHeight||t>n.maxHeight){this.payload.pop(),e.bindLayout(null);return}}e.bindLayout({row:this})},end:function(){var e;e=this.getScaledWidth(this.targetHeight),this.displayWidth=Math.min(e,this.availableWidth)},clear:function(){this.displayWidth=this.availableWidth,this.payload.forEach(function(e){e.bindLayout(null)});var e=this.payload;return this.payload=[],e},getTargetAreaSize:function(){if(this._targetRange._displayWidth===this.displayWidth)return this._targetRange;var e=this.displayWidth>i.sizeBreakPoint?this.options.targetHeight*i.sizeBump:this.options.targetHeight,t=Math.floor(e*(1-this.options.targetHeightTolerance)),n=Math.ceil(e*(1+this.options.targetHeightTolerance));return this._targetRange={_displayWidth:this.displayWidth,targetHeight:e,minHeight:t,maxHeight:n}},computeLayout:function(){var e=this.getTargetAreaSize();return this.height=this.getScaledHeight(),this.height<e.minHeight?this.height=e.minHeight:this.height>e.maxHeight&&(this.height=e.maxHeight),this.width=this.getScaledWidth(this.height),this.overflow=this.width-this.displayWidth,this.offsetTop=this.layoutEngine.getRowStackHeight(this.rowIndex-1)+this.rowIndex*this.options.vertPadding,!0},getAspectRatio:function(){return this.payload.reduce(function(e,t){return e+t.displayItem.assetManager.getAspectRatio()},0)},getScaledWidth:function(e,t){var n;return e||(e=this.getTargetAreaSize().targetHeight),t=t===undefined?this.options.horizPadding:t|0,n=this.getAspectRatio()*e+t*(this.payload.length-1),Math.ceil(n)},getScaledHeight:function(){var e,t;return t=this.getAspectRatio(),e=this.displayWidth-(this.payload.length-1)*this.options.horizPadding,Math.ceil(1/t*e)},render:function(){var e=this,t,n,i;t=this.computeLayout();if(!t){r.log("JustifiedRow.computeLayout found no solution");return}n=this.overflow/this.payload.length|0,i=0,this.payload.forEach(function(t){var r=t.displayItem,s,o;t.position(e.offsetTop,i),o=i===0?e.overflow-n*(e.payload.length-1):n,s=r.assetManager.getScaledWidth(e.height)-o,r.resize(s,e.height),i+=r.frameWidth+e.options.horizPadding})},getWrappers:function(){return this.payload||[]},destroy:function(){this.payload.forEach(function(e){e.bindLayout(null)}),this.payload=null,this.options=null,this.layoutEngine=null,e.SimpleEventEmitter.prototype.destroy.apply(this)}}),e.LayoutEngineJustifiedRow=t},"@VERSION@",{requires:["flutil","flickr-promise","simple-event-emitter"]});
YUI.add("hermes-template-display-collection-justified-item",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=n.helperMissing;return s+='<div class="ui-display-wrapper ui-display-wrapper-justified" id="',(o=n.id)?o=o.call(t,{hash:{},data:i}):(o=t.id,o=typeof o===a?o.apply(t):o),s+=f(o)+'" data-layout-element="displayWrapper" style="'+f((o=(o=(o=t.layout,o==null||o===!1?o:o.styles),o==null||o===!1?o:o.displayWrapper),typeof o===a?o.apply(t):o))+'">\n	',u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t.displayItem,u):l.call(t,"outlet",t.displayItem,u)))+"\n</div>\n\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/display-collection-justified-item",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-display-collection-justified",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){var r="",i;r+="\n		",i=n.each.call(e,e.displayWrappers,{hash:{},inverse:a.noop,fn:a.program(2,h,t),data:t});if(i||i===0)r+=i;return r+="\n	",r}function h(e,t){var i="",s;i+="\n			",s=a.invokePartial(r["display-collection-justified-item"],"display-collection-justified-item",e,n,r,t);if(s||s===0)i+=s;return i+="\n		",i}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=this.merge(r,e.partials),i=i||{};var s="",o,u,a=this,f="function",l=this.escapeExpression;s+='<section data-layout-element="displayCollection" style="'+l((o=(o=(o=t.layout,o==null||o===!1?o:o.styles),o==null||o===!1?o:o.displayCollection),typeof o===f?o.apply(t):o))+"\">\n	<script>\n		//getting the cookie with no library\n		var liqpw = (document.cookie.match(/liqpw\\s*=\\s*(\\d+)/) || [])[1] || 0;\n\n		//if cookie width is incorrect!\n		if (window.innerWidth != liqpw) {\n			document.body && document.body.classList.add('ui-state-wrong-cookie-width');\n		}\n	</script>\n	",u=n["if"].call(t,t.displayWrappers,{hash:{},inverse:a.noop,fn:a.program(1,c,i),data:i});if(u||u===0)s+=u;return s+="\n</section>\n",s}),r={};e.Array.each(["display-collection-justified-item"],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/display-collection-justified",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-display-collection-justified-item"]});
YUI.add("layout-engine-justified",function(e){"use strict";var t,n=e.LayoutEngine.DisplayWrapper,r,i,s;i={debug:!1,vertPadding:8,horizPadding:8,bottomPadding:8,targetHeight:320,targetHeightTolerance:.25,maxHorizOverflow:5,gutterWidth:0,autoGutterToContentWidth:!1,bufferTop:3,bufferBottom:3},s={unWrapDisplayItem:function(e){return e.displayItem}},r=e.flutil.getLogger(i.debug),t=function(t){this.rows=[],this.currentRow=null,e.LayoutEngine.apply(this),this.options=e.flutil.extend({vertPadding:i.vertPadding,horizPadding:i.horizPadding,leftRightPadding:t.canvas==="fluidContainer"?0:i.horizPadding,bottomPadding:i.bottomPadding,targetHeight:i.targetHeight,gutterWidth:i.gutterWidth,autoGutterToContentWidth:i.autoGutterToContentWidth,targetHeightTolerance:i.targetHeightTolerance,viewport:null,container:null,monitorViewport:!0,scrolling:!0,template:e.flutil.getTemplate("display-collection-justified"),templatePartial:e.flutil.getTemplate("display-collection-justified-item")},t),this.init()},t.prototype=e.flutil.objectCreate(e.LayoutEngine.prototype,{init:function(t){t||(t=this.options),this.container=t.container,this.template=t.template,this.templatePartial=t.templatePartial,this.viewport=e.flutil.extend({width:800,height:600,scrollbarWidth:16},t.viewport),this.assignEventHandlers()},assignEventHandlers:function(){var t=this;!YUI.Env.isServer&&this.options.monitorViewport&&(this.options.singleRow||this.setViewportCookies(),this.options.scrolling&&this.scrollPolling(),e.use("global-events",function(e){t._resizeEventHandle=e.globalEvents.subscribe("window:resize",t.onResize.bind(t))}))},setViewportCookies:function(){e.flutil.setCookie({remove:!0,cookieName:"liqpw",path:"/",cookieValue:this.viewport.width+this.options.gutterWidth*2}),e.flutil.setCookie({remove:!0,cookieName:"liqph",path:"/",cookieValue:this.viewport.height})},scrollPolling:function(){var t,n=100,r=Math.floor(this.options.targetHeight/2),i=this;this._scroll=t={timer:null,offsetY:0,offsetVisibilityY:0,offsetTop:this.container.getY(),state:"still",shield:document.createElement("div"),shieldState:!1},t.shield.classList.add("ui-display-scrollshield"),document.body.appendChild(t.shield),t.timer=setInterval(function(){var s=e.config.win.pageYOffset;s===t.offsetY?(t.state!=="still"&&i.fire("scrollStop"),t.state="still",t.shieldState&&(t.shield.style.display="none"),t.shieldState=!1):(e.config.win.paftTiming&&(e.config.win.paftTiming=null),t.state="scroll",Math.abs(s-t.offsetY)<n?(t.shieldState&&(t.shield.style.display="none"),t.shieldState=!1):(t.shieldState||(t.shield.style.display="block"),t.shieldState=!0)),t.offsetY=s,Math.abs(s-t.offsetVisibilityY)>r&&(t.offsetVisibilityY=s,i.computeVisible())},250)},onResize:function(t){var n,r=this;switch(this.options.canvas){case"screen":case"container":n=e.config.win.innerWidth;break;case"fluidContainer":default:n=this.container.get("clientWidth")}return n?(this.options.singleRow?this.fire("resize",function(e,t){r.viewport.width=e,r.viewport.height=t,r.reflow()}):(this.options.autoGutterToContentWidth&&(this.options.gutterWidth=(n-this.options.autoGutterToContentWidth)/2),this.viewport.width=n-this.options.gutterWidth*2,this.viewport.height=e.config.win.innerHeight,this.setViewportCookies(),this.reflow()),!0):!1},computeVisible:function(){var t,n=[],r=[],o=[],u,a,f,l,c,h,p=this.rows.length,d,v,m,g;t=this._scroll?this._scroll.offsetY:e.config.win.pageYOffset,f=this.viewport.height*i.bufferTop,l=this.viewport.height*i.bufferBottom,c=t-f-this.options.targetHeight,h=t+this.viewport.height+l,u=t-this.options.targetHeight/2|0,a=t+this.viewport.height,d=this._scroll?this._scroll.offsetTop:this.container.getY(),this._bottom||(this._bottom=1);for(g=0;g<p;g++)v=this.rows[g],m=v.offsetTop+d,m>u&&m<a&&(o=o.concat(v.payload)),this.options.singleRow&&g>0?r=r.concat(v.payload):m<c?r=r.concat(v.payload):m>c&&m<h?(n=n.concat(v.payload),g===p-1&&g>this._bottom&&(this._bottom=g,this.fire("bottom",{row:this.rows[g]}))):m>h&&(r=r.concat(v.payload));this.fire("visibilitychanged",{viewsVisible:o.map(s.unWrapDisplayItem),viewsIn:n.map(s.unWrapDisplayItem),viewsOut:r.map(s.unWrapDisplayItem)})},scrollTo:function(t,n){var r,s,o;n=(n||0)-i.vertPadding;if(typeof t=="string"){for(r=0,s=this.payload.length;r<s;r++)if(this.payload[r].displayItem.photo.id===t){t=this.payload[r];break}}else if(!t.layout)for(r=0,s=this.payload.length;r<s;r++)if(this.payload[r].displayItem===t){t=this.payload[r];break}if(!t)return;o=function(){if(!o.ttl)return;if(o.view.container){var t=o.view.container.getDOMNode();t.scrollIntoView&&t.scrollIntoView(),n&&e.config.win.scrollBy(0,n);return}o.ttl--,setTimeout(o,10)},o.ttl=300,o.view=t,o()},addRow:function(){var t,n,r;t=this.rows.length,r=this.viewport.width-2*this.options.leftRightPadding-this.viewport.scrollbarWidth,n={vertPadding:this.options.vertPadding,horizPadding:this.options.horizPadding,targetHeight:this.options.targetHeight,targetHeightTolerance:this.options.targetHeightTolerance,width:this.options.infiniteRow?Number.MAX_VALUE:r},this.currentRow=new e.LayoutEngineJustifiedRow(n),this.currentRow.bindLayout({layoutEngine:this,rowIndex:t}),this.rows.push(this.currentRow)},getRowStackHeight:function(e){var t=e===undefined?this.rows.length:e+1,n=0,r;for(r=0;r<t;r++)n+=this.rows[r].height||this.rows[r].options.targetHeight;return n},append:function(e){if(!Array.isArray(e))return;var t,r={};this.container.all(".ui-display-wrapper").each(function(e){r[e.get("id")]=e}),t=e.map(function(e){var t=new n(e),i=r[t.getId()];return i&&t.setContainer(i),t}),this.payload=this.payload.concat(t),this.render(this.currentRow)},remove:function(e){e.forEach(function(e){e.remove()})},render:function(e){var t=this,n,r,i,s,o,u,a=[];if(!this.payload.length){this.fire("rendered");return}n=this.payload,e&&(this.currentRow=e,r=e.clear().shift(),n=this.payload.slice(this.payload.indexOf(r))),this.currentRow||this.addRow();for(o in n)i=n[o],t.currentRow.addItem(i),i.hasLayout()||(t.currentRow.render(),!s&&t.options.singleRow&&(
s=t.currentRow.height),t.addRow(),t.currentRow.addItem(i)),a.push(i);this.currentRow.end(),this.currentRow.render(),this.setStyles("displayCollection",{height:this.currentRow.offsetTop+this.currentRow.height+"px",position:"relative",margin:this.options.vertPadding+"px "+this.options.leftRightPadding+"px "+this.options.bottomPadding+"px "+(this.options.leftRightPadding+this.options.gutterWidth)+"px"}),s&&this.options.singleRow?u=s:u=this.currentRow.height,this.fire("adjustContainer",u),this.renderFragment(a),!this._cookieChecked&&!YUI.Env.isServer&&(this._cookieChecked=!0,setTimeout(function(){document.body.classList.remove("ui-state-wrong-cookie-width")},500))},reflow:function(){this.rows.forEach(function(e){e.destroy()}),this.rows=[],this.currentRow=null,this._bottom=null,this.render(),this.computeVisible(),this.fire("reflowed")},destroy:function(){this._scroll&&(this._scroll.shield.parentNode.removeChild(this._scroll.shield),this._scroll.shield=null,clearInterval(this._scroll.timer)),this._resizeEventHandle.detach(),this.rows.forEach(function(e){e.destroy()}),this.rows=null,this.currentRow=null,e.LayoutEngine.prototype.destroy.apply(this)}}),e.LayoutEngineJustified=t},"@VERSION@",{requires:["flutil","flickr-promise","layout-engine","layout-engine-justified-row","hermes-template-display-collection-justified","display-collection-justified-css"]});
YUI.add("display-collection-justified",function(e){"use strict";var t;t=e.Base.create("DisplayCollectionJustified",e.DisplayCollection,[],{initializer:function(t){var n,r={},i=t.gutterWidth||0,s=t.autoGutterToContentWidth||!1,o=this.get("container"),u;YUI.Env.isServer?(r.width=parseInt(this.appContext.getCookie("liqpw"),10),r.height=parseInt(this.appContext.getCookie("liqph"),10),r.scrollbarWidth=this.appContext.getCookie("liqsb")?parseInt(this.appContext.getCookie("liqsb"),10):16):this.options.canvas==="fluidContainer"?(u=e.one("."+o.getDOMNode().className.replace(" ",".")),u?r.width=u.get("clientWidth"):this._resizeQueued=!0,r.width||(r.width=parseInt(this.appContext.getCookie("liqpw"),10)),r.width||(r.width=e.config.win.innerWidth),r.scrollbarWidth=0):r.scrollbarWidth=function(){var t,n;return t=document.createElement("div"),t.style.width="100px",t.style.height="100px",t.style.overflow="scroll",t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),n=100-t.clientWidth,t.parentNode.removeChild(t),e.flutil.setCookie({remove:!0,cookieName:"liqsb",path:"/",cookieValue:n}),n}(),this.options=e.flutil.extend(this.options,{canvas:"container",hibernate:!0},t);switch(this.options.canvas){case"screen":this.options.viewport=e.flutil.extend({width:r.width||e.config.win.innerWidth||800,height:r.height||e.config.win.innerHeight||600,scrollbarWidth:r.scrollbarWidth},this.options.viewport),s&&(i=(this.options.viewport.width-s)/2),this.options.viewport.width-=i*2;break;case"fluidContainer":this.options.viewport=e.flutil.extend({width:r.width||800,height:r.height||e.config.win.innerHeight||600,scrollbarWidth:r.scrollbarWidth},this.options.viewport),s&&(i=(this.options.viewport.width-s)/2),this.options.viewport.width-=i*2;break;case"container":default:console.warn("This doesn't appear to be fully implemented yet. See note above about using canvas: 'container'."),this.options.viewport=e.flutil.extend({width:o.get("offsetWidth"),height:o.get("offsetHeight")||e.config.win.innerHeight,scrollbarWidth:r.scrollbarWidth},this.options.viewport)}return n=e.flutil.extend({},this.options,{container:o,gutterWidth:i,autoGutterToContentWidth:s}),this.setupLayoutEngine(n),this},setupLayoutEngine:function(t){var n=this,r=!0,i,s,o;i=this.options.beaconViews?function(e){var t=n.options.beaconViews,r=document.URL;e.forEach(function(e){t.queue(e.photo&&e.photo.id,r,"true")})}:function(){},s=this.options.hibernate?this._queueForHibernation.bind(this):function(){},YUI.Env.isServer||(o=e.config.win.scrollY),this.layout=new e.LayoutEngineJustified(t),this.layout.on("rendered",function(t){r&&!YUI.Env.isServer&&(r=!1,e.config.win.setTimeout(function(){n._resizeQueued&&n.layout.onResize?(n._resizeQueued=!1,n.layout.onResize(null)||n._resizePoll()):n.layout.computeVisible()},0)),n.fire("rendered",t)}),this.layout.on("resize",function(e){n.fire("resize",e)}),this.layout.on("adjustContainer",function(e){n.fire("adjustContainer",e)}),this.layout.on("reflowed",function(t){e.Views.dialog.close()}),this.layout.on("bottom",function(e){e.loading=n.next(),n.fire("bottom",e)}),this.layout.on("visibilitychanged",function(t){var r=t.viewsVisible,u=0;s("wake",t.viewsIn,function(){s("hibernate",t.viewsOut),YUI.Env.isServer||o!==e.config.win.scrollY&&n._updateScrollHistory(t.viewsVisible[0])}),e.config.win.paftTiming&&!e.config.win.paftTiming.final&&n.appContext.flipper.isFlipped("paft")&&(r.forEach(function(t){u<e.config.win.paftTiming[t.photo.id]&&(u=e.config.win.paftTiming[t.photo.id])}),n.appContext.clientMetrics&&(e.config.win.paftTiming.final=u,n.appContext.clientMetrics.record("photos_above_fold",u),n.appContext.clientMetrics.beaconLater())),i(t.viewsVisible)}),this.layout.on("scrollStop",function(){n.options.beaconViews&&n.options.beaconViews.flushQueue()})},positionFromHistory:function(){var t;if(YUI.Env.isServer)return;t=e.StorageHelper.getItem(this._generateLocationHash(),!0),t&&this.scrollToPhotoId(t,0)},scrollToPhotoId:function(e,t){this.layout.scrollTo(e,t)},_queueForHibernation:function(t,n,r){var i=25,s=n.length,o,u;if(!s)return r&&r();o=0,u=function(){var a,f=Math.min(s,o+i);for(a=o;a<f;a++)n[a][t]();if(f>=s-1)return r&&r();o=f-1,e.config.win.requestAnimationFrame(u)},e.config.win.requestAnimationFrame(u)},_updateScrollHistory:function(t){if(YUI.Env.isServer)return;t&&t.photo&&e.StorageHelper.setItem(this._generateLocationHash(),t.photo.id,!0)},_generateLocationHash:function(){var e="dc_scrollToPhotoId_"+document.location.pathname+document.location.search;return e.replace(/[^\w\d]/gi,"")},_resizePoll:function(e){function i(){setTimeout(function(){r.layout.onResize(null)||++n<t&&(e*=2,i())},e)}var t=5,n=0,r=this;e||(e=100),i()}}),e.DisplayCollectionJustified=t},"@VERSION@",{requires:["flutil","storage-helper","display-collection","layout-engine-justified","display-item-tile"]});
YUI.add("hermes-template-photo-collection",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression;return u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["display-collection"],u):a.call(t,"outlet",t["display-collection"],u)))+'\n\n<div class="progress-indicator">\n	<span class="fetching-message">',u={hash:{intlName:"photo-list.FETCHING_PHOTOS"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+'</span>\n	<span class="fetching-more-message">',u={hash:{intlName:"photo-list.FETCHING_MORE_PHOTOS"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+'</span>\n	<span class="searching-message">',u={hash:{intlName:"photo-list.SEARCHING"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+"</span>\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-collection",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-photos-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,this.EMPTY_QUERY_ID=-1,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-photos-search"].run(t,this.appContext)}},attributes:{photos:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-photos-search"],listItemIdField:"photoId"}},totalItems:{setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},apiParams:{writeOnce:"initOnly"},emptyQuery:{defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-search-fetcher","search-helper"]});
YUI.add("flickr-photos-search-fetcher",function(e){"use strict";function t(t){var n={extras:e.APIHelper.request.getRebootPhotoExtras(),per_page:t.perPage||e.SearchHelper.FETCH_PAGE_SIZE,page:t.page||1},r;return t.fetchGeo&&(n.extras+=",geo"),r=e.merge(n,t.apiParams||{}),YUI.Env.isServer&&e.SearchHelper.unescapeParameters(r),e.SearchHelper.isParameterlessSearch(r)?null:r}function n(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l,c,h={id:n.id,apiParams:e.QueryString.parse(n.id),emptyQuery:!!n.emptyQuery,photos:[]},p,d;if(!n.id)throw new ReferenceError("No `id` provided by request.");if(!r.photos||!r.photos.photo)throw new Error("No `photos.photo` property returned by API.");return c=e.APIHelper.response.parsePhotos({photos:r.photos.photo,photoModelRegistry:s,personModelRegistry:o,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}),n.fetchGeo&&r.photos.photo.forEach(function(e){typeof e.latitude!="undefined"?p={id:e.id,hasGeo:!0,latitude:e.latitude,longitude:e.longitude}:p={id:e.id,hasGeo:!1},f.exists(p.id)||f.add(p)}),h.photos={perPage:r.photos.perpage,page:r.photos.page||1,pageContent:c,totalItems:r.photos.total},h.totalItems=r.photos.total,i.exists(h.id)?(l=i.getValue(h.id,"photos").getList(),d=l.reduce(function(e,t){return e[t.id]=!0,e},{}),h.photos.pageContent=h.photos.pageContent.filter(function(e){return!d[e.id]}),h.photos.page===1&&(h.photos.forceAppend=!0),i.setValue(h.id,"photos",h.photos)):i.add(h),h.photos.pageContent}function r(t,n){var r=this,i="flickr.photos.search",s=t.emptyQuery?{}:this._processParams(t);return s||(t.emptyQuery=!0),e.batch(t.emptyQuery?new e.AutoResolvingPromise({photos:{photo:[]}}):n.callAPI(i,s),n.getModelRegistry("search-photos-models"),n.getModelRegistry("photo-models"),n.getModelRegistry("person-models"),n.getModelRegistry("photo-engagement-models"),n.getModelRegistry("photo-stats-models"),n.getModelRegistry("photo-geo-models")).then(function(e){return r._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-photos-search-fetcher] failed getting or processing API response:",e),e})}e.namespace("ListFetchers")["flickr-photos-search"]={run:r,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","type-validator","search-helper","querystring-parse-simple"],optional:["search-photos-models","photo-models","person-models","photo-engagement-models","photo-stats-models","photo-geo-models"]});
YUI.add("search-photos-collection-view",function(e){e.namespace("Views")[this.name]=e.Base.create("search-photos-collection-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.searchId=e.searchId,this.paft=e.paft,this},loadState:function(){var t=this,n;return n={appContext:this.appContext,container:this.get("container").one(".display-collection-justified"),beaconViews:this.appContext.getViewCounter({flushDelay:6e4}),canvas:"screen",displayItemExtras:{}},this.paft&&(n.displayItemExtras.paft=!0),this.displayCollection=new e.DisplayCollectionJustified(n),this.searchId?this.appContext.getModel("search-photos-models",this.searchId).then(function(n){return t.searchModel=n,t.searchCollection=new e.CollectionPaginator(n,"photos",{fetchPageSize:e.SearchHelper.FETCH_PAGE_SIZE}),t.searchCollection.passAttributesToFetcher("apiParams"),t.registerSubview(t.displayCollection),t.displayCollection.appendCollection(t.searchCollection),t.displayCollection.initialize()}):new e.AutoResolvingPromise},buildContainer:function(){var e=this;return e.setContainerHTML(e.templates("photo-collection")({"display-collection":e.displayCollection,paft:e.paft})),this.displayCollection.positionFromHistory(),this},activate:function(){return this.registerEventHandler(this.displayCollection.on("bottom",function(e){this.searchModel.getValue("photos").fetchedEnd||this.displayLoadingIndicator("fetching-more")},this)),this.registerEventHandler(this.get("container").delegate("click",this.injectPhotolistContext.bind(this),"a")),this},displayLoadingIndicator:function(e){var t=this.get("container").one(".progress-indicator");t.addClass(e),t.addClass("progress-loading"),this.registerEventHandler(this.displayCollection.on("rendered",function(n){t.removeClass(e),t.removeClass("progress-loading")}))},injectPhotolistContext:function(t){var n=t.currentTarget.getAttribute("href"),r=e.URLHelper.PHOTOPAGE_PATTERN.exec(n),i,s,o,u;r&&r.length>=5&&(i=this.searchCollection.getCurrentPageAsList().map(function(e){return e.id}),s=i.indexOf(r[4]),o=i.slice(i).slice(s,s+50),o.length<50&&(o=i.slice(s-(50-o.length),s).concat(o)),u=n+"/in/photolist-"+e.URLHelper.generateShortenedPhotolist(o),t.halt(),e.rapidTracker.beacon(this.name,"searchPhotoResultClick",{vespaRnk:s+1}),this.appContext.lang.toLowerCase()==="en-us"?this.appContext.flapp.navigate(u):window.location=u)}})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","collection-paginator","display-collection-justified","hermes-template-photo-collection","photo-collection-css","url-helper","search-helper"],optional:["search-photos-models"],langBundles:["search","photo-list"]});
YUI.add("hermes-lang-search",function(e,t){e.Intl.add("hermes/search","en-US",{RELEVANT:["Relevant"],RECENT:["Recent"],INTERESTING:["Interesting"],DEFAULT_SEARCH:['This is where you search Flickr. Here\'s a search for <span class="default-search">',"${query}","</span> to get you started!"],FLICKR_SEARCH:["Flickr Search"],NO_MATCHES_FOR_QUERY_TERM:["Oops! There are no matches for \u201c","${searchTerm}","\u201d."],NO_MATCHES_FOR_QUERY:["Oops! There are no matches for your search."],TRY_DIFFERENT:["Please try refining your search."],SEARCH_ERROR:["Oops! The date you entered does not exist."],SEARCH_START:["Start your search"],SEARCHING:["Searching"],FETCHING_PHOTOS:["Fetching more photos..."],SEARCH:["Search"],START_YOUR_SEARCH:["Start your search"],BY_USER:["by ","${user}"],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_YOUR:["Oops! There are no matches for \u201c","${searchTerm}","\u201d in your photos."],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_CONTACTS:["Oops! There are no matches for \u201c","${searchTerm}","\u201d in your contacts' photos."],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_USER:["Oops! There are no matches for \u201c","${searchTerm}","\u201d in this user's photos."],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_GROUP:["Oops! There are no matches for \u201c","${searchTerm}","\u201d in this group."],NO_MATCHES_FOR_QUERY_TERM_YOUR:["Oops! There are no matches for your search in your photos."],NO_MATCHES_FOR_QUERY_TERM_CONTACTS:["Oops! There are no matches for your search in your contacts' photos."],NO_MATCHES_FOR_QUERY_TERM_USER:["Oops! There are no matches for your search in this user's photos."],NO_MATCHES_FOR_QUERY_TERM_GROUP:["Oops! There are no matches for your search in this group."],API_ERROR_HEADER:["Oh noes! We couldn't process your search."],API_ERROR_SUBHEADER:["Please change it up a bit and try again."],YOUR_GROUPS:["Your groups"],ALL_FLICKR_GROUPS:["All Flickr groups"],MEMBER_COUNT:[{type:"plural",valueName:"count",options:{zero:"0 members",one:"${#} member",other:"${#} members"}}],GROUP_PHOTO_COUNT:[{type:"plural",valueName:"count",options:{zero:"no photos",one:"${#} photo",other:"${#} photos"}}],GROUP_DISCUSSION_COUNT:[{type:"plural",valueName:"count",options:{zero:"no discussions",one:"${#} discussion",other:"${#} discussions"}}],YOUR_PHOTOS:["Your photos"],YOUR_ALBUMS:["Your albums"],YOUR_GALLERIES:["Your galleries"],FROM_YOUR_CONTACTS:["From your contacts"],EVERYONES_PHOTOS:["Everyone's Photos"],VIEW_ALL_COUNT:[{type:"plural",valueName:"count",options:{zero:"no more photos",one:"View ${#} more",other:"View all ${#}"}}],PEOPLE_PHOTOS_COUNT:[{type:"plural",valueName:"count",options:{zero:"0 photos",one:"${#} photo",other:"${#} photos"}}],PEOPLE_VIDEOS_COUNT:[{type:"plural",valueName:"count",options:{zero:"no videos",one:"${#} video",other:"${#} videos"}}],PEOPLE_FOLLOWERS_COUNT:[{type:"plural",valueName:"count",options:{zero:"no followers",one:"${#} follower",other:"${#} followers"}}],SAFESEARCH_ON:["SafeSearch on"],SAFESEARCH_OFF:["SafeSearch off"],SAFESEARCH_MODERATE:["SafeSearch moderate"],ANY_LICENSE:["Any license"],ALL_CC:["All creative commons"],COMMERCIAL_USE:["Commercial use allowed"],MODS_ALLOWED:["Modifications allowed"],COMMERCIAL_USE_MODS:["Commercial use & mods allowed"],NO_RESTRICTIONS:["No restrictions"],US_GOVT:["U.S. Government works"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-lang-photo-list",function(e,t){e.Intl.add("hermes/photo-list","en-US",{FETCHING_PHOTOS:["Fetching photos..."],FETCHING_MORE_PHOTOS:["Fetching more photos..."],SEARCHING:["Searching..."]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-template-footer-full",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function d(e,t){var r="",i,s;r+='\n					<li class="foot-li">\n						<div class="ui-dropdown simple-drop drop-up">\n							<span>',s={hash:{},inverse:c.noop,fn:c.program(2,v,t),data:t},(i=n.selectedLang)?i=i.call(e,s):(i=e.selectedLang,i=typeof i===f?i.apply(e):i),n.selectedLang||(i=h.call(e,i,s));if(i||i===0)r+=i;r+='</span>\n							\n							<span class="ui-dialog-arrow"></span>\n							\n							<ul>\n								',i=n.each.call(e,e.menuLangs,{hash:{},inverse:c.noop,fn:c.program(4,m,t),data:t});if(i||i===0)r+=i;return r+='\n							</ul>\n							\n							<div class="ui-dropdown-shim"></div>\n						</div>\n					</li>\n					',r}function v(e,t){var r="",i;return r+='\n								<a data-track="',(i=n.code)?i=i.call(e,{hash:{},data:t}):(i=e.code,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-action="/change_language.gne?lang=',(i=n.code)?i=i.call(e,{hash:{},data:t}):(i=e.code,i=typeof i===f?i.apply(e):i),r+=l(i)+"&csrf=",(i=n.csrf)?i=i.call(e,{hash:{},data:t}):(i=e.csrf,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-value="',(i=n.code)?i=i.call(e,{hash:{},data:t}):(i=e.code,i=typeof i===f?i.apply(e):i),r+=l(i)+'" href="/change_language.gne?lang=',(i=n.code)?i=i.call(e,{hash:{},data:t}):(i=e.code,i=typeof i===f?i.apply(e):i),r+=l(i)+"&csrf=",(i=n.csrf)?i=i.call(e,{hash:{},data:t}):(i=e.csrf,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-text="',(i=n.name)?i=i.call(e,{hash:{},data:t}):(i=e.name,i=typeof i===f?i.apply(e):i),r+=l(i)+'">',(i=n.name)?i=i.call(e,{hash:{},data:t}):(i=e.name,i=typeof i===f?i.apply(e):i),r+=l(i)+"</a>\n							",r}function m(e,t){var r="",i;return r+='\n									<li data-action="set" data-value="/change_language.gne?lang=',(i=n.code)?i=i.call(e,{hash:{},data:t}):(i=e.code,i=typeof i===f?i.apply(e):i),r+=l(i)+"&csrf=",(i=n.csrf)?i=i.call(e,{hash:{},data:t}):(i=e.csrf,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-text="',(i=n.name)?i=i.call(e,{hash:{},data:t}):(i=e.name,i=typeof i===f?i.apply(e):i),r+=l(i)+'"><a data-track="',(i=n.code)?i=i.call(e,{hash:{},data:t}):(i=e.code,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-action="/change_language.gne?lang=',(i=n.code)?i=i.call(e,{hash:{},data:t}):(i=e.code,i=typeof i===f?i.apply(e):i),r+=l(i)+"&csrf=",(i=n.csrf)?i=i.call(e,{hash:{},data:t}):(i=e.csrf,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-value="',(i=n.code)?i=i.call(e,{hash:{},data:t}):(i=e.code,i=typeof i===f?i.apply(e):i),r+=l(i)+'" href="/change_language.gne?lang=',(i=n.code)?i=i.call(e,{hash:{},data:t}):(i=e.code,i=typeof i===f?i.apply(e):i),r+=l(i)+"&csrf=",(i=n.csrf)?i=i.call(e,{hash:{},data:t}):(i=e.csrf,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-text="',(i=n.name)?i=i.call(e,{hash:{},data:t}):(i=e.name,i=typeof i===f?i.apply(e):i),r+=l(i)+'">',(i=n.name)?i=i.call(e,{hash:{},data:t}):(i=e.name,i=typeof i===f?i.apply(e):i),r+=l(i)+"</a></li>\n								",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.blockHelperMissing,p=n.helperMissing;s+='<footer class="foot">\n	<div class="foot-container centered-content">\n		<div class="foot-top-row">\n			<div class="foot-nav pure-menu-horizontal">\n				<ul class="foot-nav-ul">\n					<li class="foot-li"><a href="/about">',a={hash:{intlName:"common.ABOUT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):p.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="/jobs">',a={hash:{intlName:"common.JOBS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):p.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="//blog.flickr.net/en">',a={hash:{intlName:"common.BLOG"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):p.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="//mobile.yahoo.com/flickr">',a={hash:{intlName:"common.MOBILE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):p.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="/services/developer">',a={hash:{intlName:"common.DEVELOPERS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):p.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="/help/guidelines">',a={hash:{intlName:"common.GUIDELINES"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):p.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="//yahoo.uservoice.com/forums/211185-us-flickr">',a={hash:{intlName:"common.FEEDBACK"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):p.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="/abuse">',a={hash:{intlName:"common.REPORT_ABUSE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):p.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="/help/forum">',a={hash:{intlName:"common.HELP_FORUM"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):p.call(t,"intlMessage",a)))+"</a></li>\n					\n					",a={hash:{},inverse:c.noop,fn:c.program(1,d,i),data:i},u=(o=n.isFlipped||t.isFlipped,o?o.call(t,t.flippers,"enable-footer-lang",a):p.call(t,"isFlipped",t.flippers,"enable-footer-lang",a));if(u||u===0)s+=u;return s+='\n				</ul>\n			</div>\n		</div>\n		<div class="pure-g foot-info foot-bottom-row">\n			<div class="pure-u-1-3 foot-yahoo">\n				<ul class="pure-menu-horizontal">\n					<li class="foot-li"><a href="//info.yahoo.com/privacy/us/yahoo/flickr/details.html">',a={hash:{intlName:"common.PRIVACY"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):p.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="//info.yahoo.com/legal/us/yahoo/utos/utos-173.html">',a={hash:{intlName:"common.TERMS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):p.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="//safely.yahoo.com">',a={hash:{intlName:"common.YAHOO_SAFELY"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):p.call(t,"intlMessage"
,a)))+'</a></li>\n					<li class="foot-li"><a href="//help.yahoo.com/kb/flickr">',a={hash:{intlName:"common.HELP"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):p.call(t,"intlMessage",a)))+'</a></li>\n				</ul>\n			</div>\n			\n			<div class="pure-u-1-3 foot-company">\n				',a={hash:{intlName:"common.A_YAHOO_COMPANY_WITH_LINK"},data:i},s+=l((o=n.intlHTMLMessage||t.intlHTMLMessage,o?o.call(t,a):p.call(t,"intlHTMLMessage",a)))+'\n			</div>\n			\n			<div class="pure-u-1-3 foot-social">\n				<ul class="pure-menu-horizontal">\n					<li><a class="ft-icon hide-text ft-tumblr" href="http://flickr.tumblr.com/">Tumblr</a></li>\n					<li><a class="ft-icon hide-text ft-facebook" href="https://www.facebook.com/flickr">Facebook</a></li>\n					<li><a class="ft-icon hide-text ft-twitter" href="https://twitter.com/flickr">Twitter</a></li>\n					'+'\n					<li><a class="ft-icon hide-text ft-googleplus" href="https://plus.google.com/+flickr">Google Plus</a></li>\n				</ul>\n			</div>\n		</div>\n	</div>\n</footer>\n',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/footer-full",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("dropdown",function(e){"use strict";var t,n;t={css:{closed:"ui-dropdown-closed",shim:"ui-dropdown-shim",label:'span[data-action="toggle"]',items:"[data-value]",itemSelected:"ui-dropdown-item-selected",hasDialogArrow:"ui-dropdown-has-dialog-arrow",dialogArrow:"ui-dialog-arrow",useCheckMarks:"ui-dropdown-use-checkboxes"},options:{hasDialogArrow:!1,useCheckMarks:!1}},e.namespace("Views").Dropdown=n=e.Base.create("Dropdown",e.FlickrView,[],{initializer:function(e){if(e.activate===!1)return;this.activate()},activate:function(){var n=this,r=this.get("container"),i;this.close(),this._items={},e.Lang.isArray(this.get("selected"))||this.set("selected",[this.get("selected")]),r.all(t.css.items).each(function(e){var t=e.getData();n._items[t.value]={text:t.text||'no data-text for "'+t.value+'"',sub:t.sub,node:e}}),this.labelEl=r.one(t.css.label),this.labelEl||(this.labelEl=e.Node.create('<span class="truncate" data-action="toggle" />'),r.insert(this.labelEl,0)),i=this.get("staticLabel")||this.get("defaultLabel"),i&&(i===!0?this.labelEl.set("text","set staticLabel/defaultLabel to a string, not `true`"):this.labelEl.set("text",i)),this.get("hasDialogArrow")&&!r.hasClass(t.css.hasDialogArrow)&&r.addClass(t.css.hasDialogArrow),r.hasClass(t.css.hasDialogArrow)&&(this.dialogArrowEl=r.one(t.css.dialogArrow),this.dialogArrowEl||(this.dialogArrowEl=e.Node.create('<span class="ui-dialog-arrow" />'),r.insert(this.dialogArrowEl,1))),this.get("useCheckMarks")&&!r.hasClass(t.css.useCheckMarks)&&r.addClass(t.css.useCheckMarks),this.select();if(this.get("disabled"))return this.disable();this.attachEvents({":toggle":this.toggle.bind(this),":set":function(t,r){t.halt();if(!n.get("multiSelect")&&!n.get("multiSelectSub")&&e.Array.indexOf(n.get("selected"),r.value)>=0)return n.close();n.select(r.value,r)}})},select:function(n,r,i){var s=this,o=n?this._items[n]:null,u=!0,a=[],f;o&&e.Array.indexOf(this.get("selected"),n)>=0&&(this.get("multiSelect")||this.get("multiSelectSub"))?(a=this.get("selected"),!o.sub&&this.get("multiSelect")&&a.length>this.get("minimumSelected")?(a.splice(e.Array.indexOf(this.get("selected"),n),1),u=!1):o.sub&&(a.splice(e.Array.indexOf(this.get("selected"),n),1),u=!1),this.set("selected",a)):o&&(o.sub?(a.push(n),this.get("selectParent")&&a.push(o.sub),e.Array.each(this.get("selected"),function(e){s._items[e].sub===o.sub?a.push(e):s.get("multiSelect")&&!s._items[e].sub&&a.push(e)})):this.get("multiSelect")?(a=this.get("selected"),a.push(n)):a.push(n),this.set("selected",a)),i||this.close(),f={clicked:o?{text:o.text,value:n,sub:o.sub,itemEl:o.node,isChecked:u}:null,data:r,selections:a},this.fire("selected",f),this.update(n,f,t)},update:function(t,n,r){var i=this,s=n.clicked,o=this.get("selected"),u=this.get("defaultLabel")||"[Unable to select a default item]";this.get("staticLabel")||(this.get("labelFunction")?u=this.get("labelFunction").apply(this,[t]):s?n.data&&n.data.text&&n.data.text!==s.text?u=n.data.text:u=s.text:o.length>0&&i._items[o[0]]&&(u=i._items[o[0]].text),this.labelEl.set("textContent",u||"[!empty data-text!]")),this.get("container").all(r.css.items).removeClass(r.css.itemSelected),e.Array.each(o,function(e){i._items[e]&&i._items[e].node.addClass(r.css.itemSelected)})},toggle:function(e){e&&e.halt(),this._open?this.close(e):this.open(e)},open:function(e){var n=this.get("container"),r=0,i=0,s=30;this._open=!0,this.get("shouldCreateShim")&&this._shimUp(),n.removeClass(t.css.closed),this.get("autoSizeMenu")&&(r=parseInt(this.labelEl.getComputedStyle("width"),10),i=parseInt(n.one("ul").getComputedStyle("width"),10),r+s>i&&n.one("ul").setStyles({width:r+s})),(!e||!e.silent)&&this.fire("open",e)},close:function(e){e&&e.halt(),this._open=!1,this._shimUp(!1),this.fire("close",e),this.get("container").addClass(t.css.closed)},_shimUp:function(n){if(n===!1){if(!this._shim)return;this._shim.detach("click").remove(),this._shim=null;return}this._shim=e.Node.create("<div />"),this._shim.addClass(t.css.shim),this._shim.on("click",this.close.bind(this)),this.get("container").appendChild(this._shim)},disable:function(){var e=this.get("container");this.set("disabled",!0),this.close(),e.addClass(t.css.disabled),e.detach()},destructor:function(){this._shimUp(!1),this._items=null,this.labelEl=null,this.set("selected",null),this.detachAll()}},{ATTRS:{selected:{value:[]},disabled:{value:!1},hasDialogArrow:{value:!1},useCheckMarks:{value:!1},multiSelect:{value:!1},multiSelectSub:{value:!1},selectParent:{value:!0},minimumSelected:{value:0},staticLabel:{value:!1},defaultLabel:{value:!1},labelFunction:function(){},shouldCreateShim:{value:!0},autoSizeMenu:{value:!0}}})},"@VERSION@",{requires:["flickr-view","flickrui-css"]});
YUI.add("footer-full-view",function(e){var t=["en-US","zh-HK","de-DE","es-US","fr-FR","ko-KR","it-IT","pt-BR","vn-VN","id-ID"],n={"en-US":"English","de-DE":"Deutsch","es-US":"Espa\u00f1ol","fr-FR":"Fran\u00e7ais","ko-KR":"\ud55c\uae00","it-IT":"Italiano","pt-BR":"Portugu\u00eas","vn-VN":"Ti\u1ebfng Vi\u1ec7t","id-ID":"Bahasa Indonesia","zh-HK":"\u7e41\u9ad4\u4e2d\u6587"};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.get("container").get("innerHTML")===""&&this.setContainerHTML('<div class="footer-full-content"></div>'),this.appStateParams=e,this},subviewConfig:{},loadState:function(){var r,i,s;s=this.appContext.auth&&this.appContext.auth.csrf?this.appContext.auth.csrf:"",this.lang=this.appContext.lang,this.menuLangs=[],this.lang==="zh-Hant-HK"&&(this.lang="zh-HK"),this.lang.toLowerCase()==="vi-vn"&&(this.lang="vn-VN"),this.selectedLang={code:this.lang,name:n[this.lang],csrf:s};for(r=0,i=t.length;r<i;r++){if(t[r]===this.lang)continue;typeof t[r]=="string"&&this.menuLangs.push({code:t[r].toLowerCase(),name:n[t[r]],csrf:s})}return e.Promise.resolve()},buildContainer:function(){var t={},n;return this.get("viewer")&&(t=e.merge(this.get("viewer").toJSON(),{urls:e.URLHelper.generatePersonUrls(this.get("viewer"))})),n={flippers:this.appContext.flipper.toJSON(),displayLangs:this.displayLangs,selectedLang:this.selectedLang,menuLangs:this.menuLangs},this.setContainerHTML(this.templates("footer-full")(n)),this},activate:function(){return this}})},"@VERSION@",{requires:["flickr-view","hermes-template-footer-full","footer-full-css","url-helper","flickrui-css","flickrui-dialogs-css","dropdown"],langBundles:["common"]});
YUI.add("togglebutton",function(e){"use strict";var t,n;t={css:{toggledOn:"ui-togglebutton-on",label:'span[data-action="toggle"]',disabled:"ui-togglebutton-disabled",icon:"ui-togglebutton-icon"},options:{}},e.namespace("Views").ToggleButton=n=e.Base.create("ToggleButton",e.FlickrView,[],{initializer:function(e){if(e.activate===!1)return;this.activate()},activate:function(){var n=this.get("container");n.getData("label")&&this.set("label",n.getData("label")),n.getData("labelToggled")&&this.set("labelToggled",n.getData("labelToggled")),this.labelEl=n.one(t.css.label),this.labelEl||(this.labelEl=e.Node.create('<span class="truncate" data-action="toggle" />'),n.insert(this.labelEl,0)),this.update(this.get("toggled")),this.get("showIcon")&&n.addClass(t.css.icon);if(this.get("disabled"))return this.disable();this.attachEvents({":toggle":this.toggle.bind(this)})},update:function(e){var n=this.get("container");e?(n.addClass(t.css.toggledOn),this.get("labelToggled")&&n.one(t.css.label).set("textContent",this.get("labelToggled"))):(n.removeClass(t.css.toggledOn),n.one(t.css.label).set("textContent",this.get("label")))},toggle:function(e){e,this.set("toggled",!this.get("toggled")),this.update(this.get("toggled")),this.fire("toggle",e,this.get("toggled")?"on":"off")},disable:function(){var e=this.get("container");this.set("disabled",!0),e.addClass(t.css.disabled),e.detach()},destructor:function(){this.labelEl=null,this.detachAll()}},{ATTRS:{disabled:{value:!1},toggled:{value:!1},label:{value:"Toggle Me"},labelToggled:{value:"Toggled!"},showIcon:{value:!1}}})},"@VERSION@",{requires:["flickr-view","flickrui-css"]});
YUI.add("hermes-template-filter-bar-neutered",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s;return r+='\n						<li role="menuitem" data-track="searchFilterScopeYourPhotosClick" data-action="set" data-value="1" data-text="',s={hash:{intlName:"filter-bar.YOUR_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.YOUR_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+'</li>\n						<li role="menuitem" data-track="searchFilterScopeYourContactsPhotosClick" data-action="set" data-value="2" data-text="',s={hash:{intlName:"filter-bar.CONTACTS_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.CONTACTS_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"</li>\n					",r}function d(e,t){var r="",i,s;return r+='\n						<li role="menuitem" data-track="searchFilterScopeContactPhotosClick" data-action="set" data-value="3" data-text="',s={hash:{intlName:"filter-bar.USER_PHOTOS",name:(i=e.personModel,i==null||i===!1?i:i.displayname)},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be" data-nsid="'+l((i=(i=e.personModel,i==null||i===!1?i:i.nsid),typeof i===c?i.apply(e):i))+'">',s={hash:{intlName:"filter-bar.USER_PHOTOS",name:(i=e.personModel,i==null||i===!1?i:i.displayname)},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"</li>\n					",r}function v(e,t){var r="",i,s;return r+='\n						<li role="menuitem" data-track="searchFilterScopeGroupPhotosClick" data-action="set" data-value="4" data-text="',s={hash:{intlName:"filter-bar.GROUP_PHOTOS",name:(i=e.groupModel,i==null||i===!1?i:i.title)},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be" data-nsid="'+l((i=(i=e.groupModel,i==null||i===!1?i:i.id),typeof i===c?i.apply(e):i))+'">',s={hash:{intlName:"filter-bar.GROUP_PHOTOS",name:(i=e.groupModel,i==null||i===!1?i:i.title)},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"</li>\n					",r}function m(e,t){var r="",i,s;return r+='\n		<li role="menuitem">\n			<div class="filter-cc-label ui-togglebutton ui-togglebutton-icon ui-unselectable-text" data-label="',s={hash:{intlName:"filter-bar.LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+':" data-labeltoggled="',s={hash:{intlName:"filter-bar.LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+':">\n				<span class="truncate filter-title" data-action="toggle"></span>\n			</div>\n		</li>\n		<li role="menuitem">\n			<div class="filter-cc-menu ui-dropdown ui-dropdown-closed ui-unselectable-text">\n				<span class="truncate filter-title" data-action="toggle"></span>\n				<span class="ui-dialog-arrow"></span>\n				<ul class="filter-submenu" role="menu">\n					<li role="menuitem" data-track="searchFilterLicenseAll" data-action="set" data-value="all" data-text="',s={hash:{intlName:"filter-bar.ANY_LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.ANY_LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+'</li>\n					<li role="menuitem" data-track="searchFilterLicenseCCOnly" data-action="set" data-value="cc" data-text="',s={hash:{intlName:"filter-bar.CC_LICENSE_PARENT"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.CC_LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+'</li>\n					<li role="menuitem" data-track="searchFilterLicenseCCCommericialUse" data-action="set" data-value="cc-comm" data-sub="cc" data-text="',s={hash:{intlName:"filter-bar.CC_LICENSE_PARENT"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.COMM_LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+'</li>\n					<li role="menuitem" data-track="searchFilterLicenseCCModifyAdaptBuild" data-action="set" data-value="cc-deriv" data-sub="cc" data-text="',s={hash:{intlName:"filter-bar.CC_LICENSE_PARENT"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.DERIV_LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"</li>\n				</ul>\n			</div>\n		</li>\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f=n.helperMissing,l=this.escapeExpression,c="function",h=this;s+='<div class="filter-bar-content">\n\n	<ul class="filter-menu" role="menubar">\n		<li role="menuitem">\n			<div class="filter-sort-label ui-togglebutton ui-togglebutton-icon ui-unselectable-text" data-label="',a={hash:{intlName:"filter-bar.SORT_BY"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+':" data-labeltoggled="',a={hash:{intlName:"filter-bar.SORT_BY"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+':">\n				<span class="truncate filter-title" data-action="toggle"></span>\n			</div>\n		</li>\n		<li role="menuitem">\n			<div class="ui-dropdown ui-dropdown-closed ui-unselectable-text filter-sort-menu">\n				<span class="truncate filter-title" data-action="toggle"></span>\n				<span class="ui-dialog-arrow"></span>\n				<ul class="filter-submenu" role="menu">\n					<li role="menuitem" data-track="searchFilterSortRelevanceClick" data-action="set" data-value="relevance" data-text="',a={hash:{intlName:"filter-bar.RELEVANT"},data:i},s+=l
((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.RELEVANT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+'</li>\n					<li role="menuitem" data-track="searchFilterSortRecentClick" data-action="set" data-value="date-posted-desc" data-text="',a={hash:{intlName:"filter-bar.RECENT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.RECENT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+'</li>\n					<li role="menuitem" data-track="searchFilterSortInterestingClick" data-action="set" data-value="interestingness-desc" data-text="',a={hash:{intlName:"filter-bar.INTERESTING"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.INTERESTING"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+'</li>\n				</ul>\n			</div>\n		</li>\n		<li role="menuitem">\n			<div class="filter-search-label ui-togglebutton ui-togglebutton-icon ui-unselectable-text" data-label="',a={hash:{intlName:"filter-bar.SEARCH_IN"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+':" data-labeltoggled="',a={hash:{intlName:"filter-bar.SEARCH_IN"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+':">\n				<span class="truncate filter-title" data-action="toggle"></span>\n			</div>\n		</li>\n		<li role="menuitem">\n			<div class="search-scope-menu ui-dropdown ui-dropdown-closed ui-unselectable-text ui-dropdown-ellipsis">\n				<span class="truncate filter-title" data-action="toggle"></span>\n				<span class="ui-dialog-arrow"></span>\n				<ul class="filter-submenu" role="menu">\n					<li role="menuitem" data-track="searchFilterScopeEveryoneClick" data-action="set" data-value="0" data-text="',a={hash:{intlName:"filter-bar.EVERYONE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.EVERYONE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+"</li>\n\n					",u=n["if"].call(t,(o=t.viewer,o==null||o===!1?o:o.signedIn),{hash:{},inverse:h.noop,fn:h.program(1,p,i),data:i});if(u||u===0)s+=u;s+="\n\n					",u=n["if"].call(t,t.showUserOption,{hash:{},inverse:h.noop,fn:h.program(3,d,i),data:i});if(u||u===0)s+=u;s+="\n\n					",u=n["if"].call(t,t.groupModel,{hash:{},inverse:h.noop,fn:h.program(5,v,i),data:i});if(u||u===0)s+=u;s+='\n\n					<li role="menuitem" data-track="searchFilterScopeUsersClick" data-action="set" data-value="5" data-text="',a={hash:{intlName:"filter-bar.PEOPLE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.PEOPLE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+'</li>\n					<li role="menuitem" data-track="searchFilterScopeGroupsClick" data-action="set" data-value="6" data-text="',a={hash:{intlName:"filter-bar.GROUPS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.GROUPS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+"</li>\n				</ul>\n			</div>\n		</li>\n		",a={hash:{},inverse:h.noop,fn:h.program(7,m,i),data:i},u=(o=n.isFlipped||t.isFlipped,o?o.call(t,t.flippers,"enable-license-search",a):f.call(t,"isFlipped",t.flippers,"enable-license-search",a));if(u||u===0)s+=u;return s+='\n		<li role="menuitem" class="filter-bar-right">\n			<a href="/search/advanced/',(u=n.advancedSearchQueryStr)?u=u.call(t,{hash:{},data:i}):(u=t.advancedSearchQueryStr,u=typeof u===c?u.apply(t):u),s+=l(u)+'">',a={hash:{intlName:"filter-bar.ADVANCED_SEARCH"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+"</a>\n		</li>\n	</ul>\n\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/filter-bar-neutered",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("filter-bar-neutered-view",function(e){var t;t={css:{sortMenu:".filter-sort-menu",sortLabel:".filter-sort-label",searchScopeMenu:".search-scope-menu",searchLabel:".filter-search-label",ccLabel:".filter-cc-label",ccMenu:".filter-cc-menu"}},e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.searchId=e.searchId,this.apiParams={},this.elementStates=this.setElementStates(e),this},subviewConfig:{},loadState:function(){var t=this,n,r,i=t.appContext.getViewer();return this.searchId?n=this.appContext.getModel("search-photos-models",this.searchId).then(function(n){var r=n.getValue("apiParams"),i,s=null,o=null;return t.searchModel=n,r.group_id?(i={},e.TypeValidator.matches.nsid(r.group_id)?i.id=r.group_id:i.pathAlias=r.group_id,s=t.appContext.getModel("group-pool-models",i)):s=e.AutoResolvingPromise(),r.user_id?(i={},e.TypeValidator.matches.nsid(r.user_id)?i.id=r.user_id:i.pathAlias=r.user_id,o=t.appContext.getModel("person-models",i)):o=e.AutoResolvingPromise(),e.batch(s,o).then(function(e){e[0]&&(t.groupModel=e[0]),e[1]&&(t.personModel=e[1])})}):n=new e.AutoResolvingPromise,i.signedIn?r=t.appContext.getModel("person-preferences-models",i.nsid).then(function(e){t.personPreferencesModel=e}):r=new e.AutoResolvingPromise,e.batch(n,r).then(function(){t.searchModel?t.apiParams=t.searchModel.getValue("apiParams"):e.SearchHelper.addParamDefaults(t.apiParams,t.personPreferencesModel)})},buildContainer:function(){var e="";return this.searchModel&&(e=this.generateAdvancedSearchQuery(this.searchModel.getValue("apiParams"))),this.setContainerHTML(this.templates("filter-bar-neutered")({elements:this.elementStates,advancedSearchQueryStr:e,viewer:this.appContext.getViewer(),showUserOption:this.personModel&&this.personModel.getValue("nsid")!==this.appContext.getViewer().nsid,personModel:this.personModel&&this.personModel.toJSON(),groupModel:this.groupModel&&this.groupModel.toJSON(),flippers:this.appContext.flipper.toJSON()})),this},activate:function(){var n=this,r=this.appContext.getViewer(),i;return this.filterViews={},this.elementStates.searchScope&&(i=this.getSearchScopeState(this.apiParams,r,this.personModel),this.filterViews.searchLabel=this.createLabelButton(t.css.searchLabel),this.filterViews.searchScope=this.createSimpleDropdown(t.css.searchScopeMenu,i),this.registerEventHandler(this.filterViews.searchScope.on("selected",function(t){var r=e.clone(n.apiParams),i="/search/?";delete r.user_id,delete r.group_id,delete r.contacts;switch(t.clicked.value){case"1":r.user_id=n.appContext.getViewer().nsid;break;case"2":r.contacts="all";break;case"3":r.user_id=t.clicked.itemEl.getData("nsid");break;case"4":r.group_id=t.clicked.itemEl.getData("nsid");break;case"5":i="/search/people/?",r={q:n.apiParams.q||n.apiParams.text||n.apiParams.tags},n.classicNavigate(i+e.QueryString.stringify(r));break;case"6":i="/search/groups/?",r={q:n.apiParams.q||n.apiParams.text||n.apiParams.tags},n.classicNavigate(i+e.QueryString.stringify(r))}e.SearchHelper.addParamDefaults(r,n.personPreferencesModel),n.navigate(i+e.QueryString.stringify(r))})),this.bindOpenEvent(this.filterViews.searchScope)),this.elementStates.sort&&(this.filterViews.sortLabel=this.createLabelButton(t.css.sortLabel),i=this.apiParams[e.SearchHelper.API.sort],this.filterViews.sort=this.createSimpleDropdown(t.css.sortMenu,i),this.bindSelectedEvent(this.filterViews.sort,e.SearchHelper.API.sort),this.bindOpenEvent(this.filterViews.sort)),this.elementStates.license&&(this.filterViews.ccLabel=this.createLabelButton(t.css.ccLabel),i=this.determineLicenseForUI(this.apiParams[e.SearchHelper.API.license]||"all"),this.filterViews.creativeCommons=new e.Views.Dropdown({appContext:this.appContext,container:this.get("container").one(t.css.ccMenu),selected:i,hasDialogArrow:!0,useCheckMarks:!0,multiSelect:!1,multiSelectSub:!0,selectParent:!0,minimumSelected:1,shouldCreateShim:!1,autoSizeMenu:!1}),this.bindSelectedEvent(this.filterViews.creativeCommons,e.SearchHelper.API.license),this.bindOpenEvent(this.filterViews.creativeCommons)),n},getSearchScopeState:function(e,t,n){var r=0;return e.user_id&&e.group_id?t.signedIn&&n&&n.getValue("nsid")===t.nsid?r=1:r=3:t.signedIn&&e.group_id&&e.contacts?r=2:e.user_id?t.signedIn&&n&&n.getValue("nsid")===t.nsid?r=1:r=3:e.contacts?r=2:e.group_id&&(r=4),r},determineLicenseForAPI:function(t){var n,r=t.indexOf("all")>=0,i=t.indexOf("cc")>=0,s=t.indexOf("cc-comm")>=0,o=t.indexOf("cc-deriv")>=0;return r?n=e.SearchHelper.LICENSE_TYPE.all:i&&s&&o?n=e.SearchHelper.LICENSE_TYPE.commderiv:i&&s?n=e.SearchHelper.LICENSE_TYPE.comm:i&&o?n=e.SearchHelper.LICENSE_TYPE.deriv:i&&(n=e.SearchHelper.LICENSE_TYPE.cc),n},determineLicenseForUI:function(t){var n;switch(t){case e.SearchHelper.LICENSE_TYPE.commderiv:n=["cc","cc-comm","cc-deriv"];break;case e.SearchHelper.LICENSE_TYPE.comm:n=["cc","cc-comm"];break;case e.SearchHelper.LICENSE_TYPE.deriv:n=["cc","cc-deriv"];break;case e.SearchHelper.LICENSE_TYPE.cc:n=["cc"];break;default:n=["all"]}return n},classicNavigate:function(t){window.location=e.url(t)},createSimpleDropdown:function(t,n){return new e.Views.Dropdown({appContext:this.appContext,container:this.get("container").one(t),selected:n,useCheckMarks:!0,shouldCreateShim:!1,autoSizeMenu:!1})},createLabelButton:function(t){return new e.Views.ToggleButton({appContext:this.appContext,container:this.get("container").one(t)})},bindSelectedEvent:function(t,n){var r=this;this.registerEventHandler(t.on("selected",function(t){var i=r.apiParams,s={};n==="license"?s[n]=r.determineLicenseForAPI(t.selections):s[n]=t.clicked.value,i=e.merge(i,s),e.SearchHelper.addParamDefaults(i,r.personPreferencesModel),!t.data||!t.data.track?r.appContext.warn("No data-track attribute found on clicked element. Not beaconing."):e.rapidTracker.beacon(r.name,t.data.track),r.navigate("/search/?"+e.QueryString.stringify(i))}))},navigate:function(e){e&&(this.fire("navigating"),this.appContext.flapp.navigate
(e))},bindOpenEvent:function(t){var n=this;this.registerEventHandler(t.on("open",function(t){n.openDropdown&&n.openDropdown.close(),n.openDropdown=t.target,n.registerEventHandler(e.one("body").once("click",function(){n.openDropdown&&n.openDropdown.close()}))})),this.registerEventHandler(t.on("close",function(e){n.openDropdown=null}))},setElementStates:function(e){var t={searchScope:!0,sort:!0,license:this.appContext.flipper.isFlipped("enable-license-search")};return t},generateAdvancedSearchQuery:function(t){var n=e.SearchHelper.mapAPIParamsToAdvancedSearchQuery(t);return t.q&&(n.q=t.q),"?"+e.QueryString.stringify(n)},destructor:function(){var e;for(e in this.filterViews)this.filterViews[e].destroy()}})},"@VERSION@",{requires:["flickrui-css","dropdown","togglebutton","flickr-view","flickr-promise","person-models","group-pool-models","search-photos-models","search-helper","hermes-template-filter-bar-neutered","filter-bar-neutered-css","url"],langBundles:["filter-bar"]});
YUI.add("hermes-lang-filter-bar",function(e,t){e.Intl.add("hermes/filter-bar","en-US",{EVERYONE:["Everyone's Photos"],YOUR_PHOTOS:["Your Photos"],CONTACTS_PHOTOS:["Your Contacts' Photos"],USER_PHOTOS:["${name}","'s Photos"],GROUP_PHOTOS:["Photos in ","${name}"],PEOPLE:["People"],GROUPS:["Groups"],USER_PHOTOS_IN_GROUP:["${name}","'s Photos in ","${group}"],YOUR_PHOTOS_IN_GROUP:["Your Photos in ","${group}"],CONTACTS_PHOTOS_IN_GROUP:["Your Contacts' Photos in ","${group}"],YOUR_FAVORITES:["Your Favorites"],MORE:["More"],LESS:["Less"],PHOTOS_VIDEOS:["Photos & Videos"],ONLY_PHOTOS:["Only Photos"],ONLY_VIDEOS:["Only Videos"],ALL_TIME:["All Time"],DATE_TAKEN:["Date Taken"],DATE_POSTED:["Date Posted"],FROM:["From"],TO:["To"],MONTH_CHARS:["mm"],DAY_CHARS:["dd"],YEAR_CHARS:["yyyy"],DATE_INVALID:["Date invalid"],DONE:["Done"],DATE:["Date"],LICENSE:["License"],ANY_LICENSE:["Any License"],CC_LICENSE:["Creative Commons only"],CC_LICENSE_PARENT:["Creative Commons"],COMM_LICENSE:["Commercial use allowed"],DERIV_LICENSE:["Modifications allowed"],SS_ON:["SafeSearch on"],ON:["On"],SS_MOD:["SafeSearch moderate"],MOD:["Moderate"],SS_OFF:["SafeSearch off"],OFF:["Off"],RELEVANT:["Relevant"],RECENT:["Recent"],INTERESTING:["Interesting"],SORT_BY:["Sort"],SEARCH_IN:["Search"],ADVANCED_SEARCH:["Advanced Search"]})},"@VERSION@",{requires:["intl"]});
