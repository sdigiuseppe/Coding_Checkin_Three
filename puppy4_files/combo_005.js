YUI.add("flickr-groups-pools-getContext-fetcher",function(e){"use strict";function t(t){var n={photo_id:t.photoId,extras:e.APIHelper.request.getRebootPhotoExtras()+",datecreate",num_prev:t.numNext,num_next:t.numPrev,get_group_info:1};if(t.id)n.group_id=t.id;else{if(!t.pathAlias)throw new Error("[flickr-groups-pools-getPhotos-fetcher] `id` or `pathAlias` is required.");n.group_path_alias=t.pathAlias}return n}function n(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=[],l=[],c=s.proxy(n.photoId),h,p,d,v,m,g,y=[];return h=r.prevphotos,p=r.nextphotos,l=e.APIHelper.response.parsePhotos({photos:h.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}),f=e.APIHelper.response.parsePhotos({photos:p.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}),g=i.getValue(n.id,"photoContextList"),v=g.hasMinBoundary?g.hasMinBoundary():!1,m=g.hasMaxBoundary?g.hasMaxBoundary():!1,d=g.getList(),y=e.APIHelper.response.addOrReplaceListByContext({model:c,next:l,prev:f.reverse(),current:d,hasMin:v,hasMax:m,numNext:n.numNext,numPrev:n.numPrev}),i.setValue(n.id,"photoContextList",y),{next:l,previous:f.reverse()}}function r(t,n){var r=this;return e.batch(n.callAPI("flickr.groups.pools.getContext",this._processParams(t),!0),n.getModelRegistry("group-pool-models"),n.getModelRegistry("photo-models"),n.getModelRegistry("person-models"),n.getModelRegistry("photo-engagement-models"),n.getModelRegistry("photo-stats-models")).then(function(e){return r._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-groups-pools-getContext-fetcher] failed getting or processing API response:",e),e.code===2&&e.message==="Photo not in pool"&&(e.notInContext=!0),e})}e.namespace("ListFetchers")["flickr-groups-pools-getContext"]={run:r,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["favorite-models","photo-models","photo-engagement-models","photo-stats-models","group-models"]});
YUI.add("group-pool-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-groups-pools-getPhotos"].run(t,this.appContext)},addPhoto:function(t,n){return t.registryName=this.name,e.ModelCreators["flickr-groups-pools-add"].run(t,n)},removePhoto:function(t,n){return t.registryName=this.name,e.ModelDeletors["flickr-groups-pools-remove"].run(t,n)},invitePhoto:function(t,n){return e.ModelCreators["flickr-groups-invite-photo-invite"].run(t,n)},cancelPhotoInvitation:function(t,n){return e.ModelDeletors["flickr-groups-invite-photo-cancel"].run(t,n)}},addPhotoLocal:function(e,t){return this.getValue(e,"photoPageList").unshift(t),this.getValue(e,"photoContextList").hasMaxBoundary()&&this.getValue(e,"photoContextList").appendToList(t),this},addPhotoRemote:function(e,t){return this.remote.addPhoto.call(this,{photoID:t,groupID:e},this.appContext)},removePhotoLocal:function(e,t){return this.getValue(e,"photoPageList").removeFromList(t.getValue("id")),this.getValue(e,"photoContextList").removeFromList(t.getValue("id")),this},removePhotoRemote:function(e,t){return this.remote.removePhoto.call(this,{photoID:t,groupID:e},this.appContext)},invitePhotoRemote:function(e,t){return this.remote.invitePhoto.call(this,{photoID:t,groupID:e},this.appContext)},cancelPhotoInvitationRemote:function(e,t){return this.remote.cancelPhotoInvitation.call(this,{photoID:t,groupID:e},this.appContext)},hasPhoto:function(e,t){return this.getValue(e,"photoPageList").getFromListByID(t)||this.getValue(e,"photoContextList").getFromListByID(t)},attributes:{displayType:{readOnly:!0,defaultFn:function(){return"group"}},pathAlias:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultFn:function(e){return e}},photoPageList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-groups-pools-getPhotos"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-groups-pools-getContext"],listItemIdField:"photoId"}},group:{isModel:!0},urlSuffix:{readOnly:!0,derivedBy:["pathAlias"],defaultFn:function(e){var t=this.getValue(e,"pathAlias");return t||(t=e),"pool-"+t}},url:{readOnly:!0,derivedBy:["group"],defaultFn:function(e){return this.getValue(e,"group").getValue("url")}},title:{readOnly:!0,derivedBy:["group"],defaultFn:function(e){return this.getValue(e,"group").getValue("title")}},poolCount:{readOnly:!0,derivedBy:["group"],defaultFn:function(e){return this.getValue(e,"group").getValue("poolCount")}},filteredPoolCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return this.getValue(e,"group").getValue("poolCount")}},friendlyPoolCount:{readOnly:!0,derivedBy:["group"],defaultFn:function(e){return this.getValue(e,"group").getValue("friendlyPoolCount")}}}},{buildCompoundId:function(e,t){return e+"-"+t},extractGroupFromCompoundId:function(e){return e.split("-")[0]}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-groups-pools-getContext-fetcher","flickr-groups-pools-getPhotos-fetcher","flickr-groups-pools-add-creator","flickr-groups-pools-remove-deletor","flickr-groups-invite-photo-invite-creator","flickr-groups-invite-photo-cancel-deletor","attribute-helpers"],optional:["group-top-contributors-models"]});
YUI.add("flickr-groups-pools-getGroups-fetcher",function(e){"use strict";function t(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=r.groups,a=n.id,f={},l=[];if(u)return u.group&&e.Array.each(u.group,function(e,t){var n,r,i=o.parseGroupModel(e.id,e.pathAlias,e);n=o.exists(e.id)?o.proxy(e.id):o.add(i),r=s.exists(e.id)?s.proxy(e.id):s.add({id:e.id,pathAlias:e.pathAlias,group:n}),l.push(r)}),f={id:a,memberCount:r.userGroupMemberships?r.userGroupMemberships.member:null,moderatorCount:r.userGroupMemberships?r.userGroupMemberships.moderator:null,adminCount:r.userGroupMemberships?r.userGroupMemberships.admin:null,invitedCount:r.userGroupMemberships?r.userGroupMemberships.invited:null},f.groups=e.APIHelper.response.addOrReplaceListByPage({current:i.exists(a)?i.proxy(a).getValue("groups").getList():[],perPage:n.perPage,pageNum:n.page,totalItems:r.groups.total,newPages:l}),i.exists(a)?i.setValue(a,"groups",f.groups):i.add(f),f.groups}function n(t,n){var r=this;return e.batch(n.callAPI("flickr.groups.pools.getGroups",{extras:e.APIHelper.request.getRebootGroupExtras()+", icon_urls",page:t.page||0,per_page:t.perPage||400},!0),n.getModelRegistry("person-groups-models"),n.getModelRegistry("group-pool-models"),n.getModelRegistry("group-models")).then(function(e){return r._processResponse(e,t)},function(e){throw n.error(e.message),n.error(e.stack),n[e.fatal?"error":"debug"]("[flickr-groups-pools-getGroups-fetcher] failed getting or processing API response:",e),e})}e.namespace("ListFetchers")["flickr-groups-pools-getGroups"]={run:n,_processResponse:t}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["person-groups-models","group-models","group-pool-models","person-models"]});
YUI.add("person-groups-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},faveGroup:function(t,n){return e.ModelFetchers["flickr-groups-fave"].run(t,n)},unfaveGroup:function(t,n){return e.ModelFetchers["flickr-groups-unfave"].run(t,n)}},faveGroup:function(e){var t=this,n=e.group_id,r=e.user_id;return this.remote.faveGroup(e,this.appContext).then(null,function(){t.appContext.getModel("group-models",n).then(function(e){t.getValue(r,"groupsFaved").removeFromList(n)})}),this.appContext.getModel("group-models",n).then(function(e){t.getValue(r,"groupsFaved").appendToList(e)})},unfaveGroup:function(e){var t=e.group_id,n=e.user_id,r=this;return this.remote.unfaveGroup(e,this.appContext).then(null,function(){r.appContext.getModel("group-models",t).then(function(e){r.getValue(n,"groupsFaved").appendToList(e)})}),this.appContext.getModel("group-models",t).then(function(e){r.getValue(n,"groupsFaved").removeFromList(t)})},attributes:{id:{},memberCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},moderatorCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},adminCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},invitedCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},groups:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-groups-pools-getGroups"]}},groupsAdministered:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getGroupsWithStatus"]}},groupsModerated:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getGroupsWithStatus"]}},groupsBelongingTo:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getGroupsWithStatus"]}},groupsFaved:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getGroupsWithStatus"]}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-groups-pools-getGroups-fetcher","flickr-people-getInfo-fetcher","flickr-groups-fave-fetcher","flickr-groups-unfave-fetcher","flickr-people-getGroupsWithStatus-fetcher"]});
YUI.add("person-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)}},attributes:{pathAlias:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||undefined},defaultFn:function(e){return e}},username:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},realname:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},displayname:{readOnly:!0,derivedBy:["username","realname"],getter:function(e,t){return this.getValue(t,"realname")||this.getValue(t,"username")}},buddyicon:{},nsid:{readOnly:!0,defaultFn:function(e){return e}},isPro:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},canBuyPro:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultFn:function(){return!1}},isAdFree:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},isNoAds:{derivedBy:["isPro","isAdFree"],readOnly:!0,getter:function(e,t){var n=this.getValue(t,"isPro"),r=this.getValue(t,"isAdFree");return n||r}},dateCreated:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)}},url:{readOnly:!0,derivedBy:["pathAlias"],defaultFn:function(e){var t=this.getValue(e,"pathAlias");return"/photos/"+t+"/"}},isMe:{readOnly:!0,defaultFn:function(e){var t=this.appContext.getViewer();return t.signedIn&&t.nsid===e}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","attribute-helpers"]});
YUI.add("flickr-people-getInfo-fetcher",function(e){"use strict";function t(e){var t={datecreate:1,extras:"icon_urls, safe_search"};e.extras&&typeof e.extras=="string"&&e.extras.length>0&&(t.extras=t.extras+","+e.extras);if(e.id)t.user_id=e.id;else{if(!e.pathAlias)throw new Error("`fetch` is missing required params.");t.path_alias=e.pathAlias}return e.storage&&(t.storage=e.storage),t}function n(t){var n=t.apiResponse,r=t.personModelRegistry,i=t.personRelationshipModelRegistry,s=t.personProfileModelRegistry,o=t.personPreferencesModelRegistry,u=t.personGroupsModelRegistry,a=t.photostreamModelRegistry,f=t.personNotificationsModelRegistry,l,c=n.person,h=c.id;return r.exists(h)||r.add({id:h,pathAlias:c.pathAlias,username:c.username&&c.username._content,realname:c.realname&&c.realname._content,buddyicon:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(c.iconurls),isAdFree:c.isAdFree,isPro:c.ispro,canBuyPro:c.canBuyPro,dateCreated:c.datecreate._content}),f.exists(h)?f.setValue(h,"unreadNotificationCount",3):f.add({id:h,unreadNotificationCount:0,unreadFlickrMailCount:0}),i.exists(h)||i.add({id:h,pathAlias:c.pathAlias,isContact:c.contact,isFriend:c.friend,isFamily:c.family,isIgnored:c.ignored,isIgnoredBy:c.ignoredby}),"safeSearch"in c&&(o.exists(h)||o.add({id:h,safeSearch:(c.safeSearch||1)-1})),s.exists(h)||(l={id:h,coverPhotoUrls:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(c.coverphoto_url),photoCount:c.photos.count.content,location:c.location?c.location.content:null},c.storage&&(l.storageUsed=c.storage.used.content,l.storageTotal=c.storage.total.content),c.unreadMessages&&(l.unreadMessages=c.unreadMessages.content),s.add(l)),u.exists(h)||u.add({id:h,memberCount:c.groupMemberships?c.groupMemberships.member:null,moderatorCount:c.groupMemberships?c.groupMemberships.moderator:null,adminCount:c.groupMemberships?c.groupMemberships.admin:null,invitedCount:c.groupMemberships?c.groupMemberships.invited:null}),a.exists(h)||a.add({id:h,pathAlias:c.pathAlias,owner:r.proxy(h),totalItems:c.photos.count&&c.photos.count.content}),c}function r(t,n){var r=this,i=n.getViewer();return i&&i.signedIn&&(t.id===i.nsid||t.nsid===i.nsid)&&(t.storage=1),(new e.FlickrPromise({apiResponse:n.callAPI("flickr.people.getInfo",this._processParams(t)),personModelRegistry:n.getModelRegistry("person-models"),personRelationshipModelRegistry:n.getModelRegistry("person-relationship-models"),personProfileModelRegistry:n.getModelRegistry("person-profile-models"),personPreferencesModelRegistry:n.getModelRegistry("person-preferences-models"),personGroupsModelRegistry:n.getModelRegistry("person-groups-models"),photostreamModelRegistry:n.getModelRegistry("photostream-models"),personNotificationsModelRegistry:n.getModelRegistry("person-notifications-models")})).then(function(e){return r._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-people-getInfo-fetcher] failed getting or processing API response:",e),e})}e.namespace("ModelFetchers")["flickr-people-getInfo"]={run:r,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","flickr-promise"],optional:["person-models","person-relationship-models","person-preferences-models","person-profile-models","person-groups-models","photostream-models","api-helper"]});
YUI.add("person-relationship-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,n){var r=[],i={};if(e.Lang.isObject(n,!0)){i.user_id=t,i.friend=this.getValue(t,"isFriend"),i.family=this.getValue(t,"isFamily"),"isContact"in n&&(n.isContact.newVal?r.push(e.ModelUpdaters["flickr-contacts-add"].run(i,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-remove"].run(i,this.appContext)));if("isFriend"in n||"isFamily"in n)"isFriend"in n&&(i.friend=n.isFriend.newVal),"isFamily"in n&&(i.family=n.isFamily.newVal),r.push(e.ModelUpdaters["flickr-contacts-edit"].run(i,this.appContext))}return e.batch.apply(null,r)}},toggleFollowing:function(e){var t=this.getValue(e,"isContact");t?this.setValue(e,"isContact",!1):this.setValue(e,"isContact",!0)},toggleFriend:function(e){var t=this.getValue(e,"isFriend");t?this.setValue(e,"isFriend",!1):this.setValue(e,"isFriend",!0)},toggleFamily:function(e){var t=this.getValue(e,"isFamily");t?this.setValue(e,"isFamily",!1):this.setValue(e,"isFamily",!0)},attributes:{pathAlias:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},isContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnoredBy:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnored:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isMe:{readOnly:!0,getter:function(e,t){var n=this.appContext.getViewer();return!!n&&this.getValue(t,"nsid")===n.nsid}},nsid:{readOnly:!0,defaultFn:function(e){return e}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-contacts-add-updater","flickr-contacts-remove-updater","flickr-contacts-edit-updater","attribute-helpers"]});
YUI.add("search-helper",function(e){function l(e){return!e[n.userId]&&!e[n.groupId]&&!e[n.tags]&&!e[n.text]&&!e[n.license]&&!e[n.faves]&&!e[n.contacts]&&!e[n.getty]&&!e[n.commons]&&!e[n.minTakenDate]&&!e[n.maxTakenDate]&&!e[n.minUploadDate]&&!e[n.maxUploadDate]&&!e[n.hasGeo]&&!e[n.boundingBox]&&!e[n.woeId]&&!e[n.camera]&&!e[n.minExposure]&&!e[n.maxExposure]&&!e[n.minAperture]&&!e[n.maxAperture]&&!e[n.minFocalLength]&&!e[n.maxFocalLength]&&!e[n.foursquareWoeId]&&!e[n.foursquareVenueId]}function c(e,t){var n;for(n in s){if(!t&&n===e)return s[n];if(t&&s[n]===e)return n}}function h(e){var t={nsid_or_path_alias:"userId",group_id:"groupId",set_id:"setId",page_number:"page",tag_list:"tags",location:"text",slideshow_start_id:"slideshowStartId"},r,i={};for(r in t)e[r]&&(i[n[t[r]]]=e[r]);return i}function p(e,t){var n={},s=null,o=t.getViewer();e=e||{},e.q&&(n[i.username]=e.q),e.s&&(n[i.sort]=e.s),e.see&&e.see.toString().toLowerCase()==="all"&&(n[i.userId]=o.nsid);for(s in e)r.indexOf(s)===-1&&(n[s]=e[s]);return n}function d(e){e[i.sort]||(e[i.sort]="abc")}function v(r,i){var o={},u,a,f=i.getViewer(),l=r.l,c=r.s,h=r.w,p=r.d&&r.d.split("-"),d=r.m,v=r.q,m;r.q&&(o[n.text]=r.q),typeof r["ss"]!="undefined"&&(o[n.safeSearch]=parseInt(r.ss,10)+1),typeof r["ct"]!="undefined"&&(o[n.contentType]=parseInt(r.ct,10)+1),typeof r["mt"]!="undefined"&&(o[n.mediaType]=r.mt),r.b&&(o[n.boundingBox]=r.b),r.a&&(o[n.accuracy]=r.a),r.e&&(o[n.woeId]=r.e),r.g&&(o[n.groupId]=r.g),r.cm&&(o[n.camera]=r.cm),typeof r["xel"]!="undefined"&&(o[n.minExposure]=r.xel),typeof r["xeh"]!="undefined"&&(o[n.maxExposure]=r.xeh),typeof r["xal"]!="undefined"&&(o[n.minAperture]=r.xal),typeof r["xah"]!="undefined"&&(o[n.maxAperture]=r.xah),typeof r["xfl"]!="undefined"&&(o[n.minFocalLength]=r.xfl),typeof r["xfh"]!="undefined"&&(o[n.maxFocalLength]=r.xfh),r.eui&&(o[n.excludeUserId]=r.eui);if(typeof l!="undefined")switch(l){case"cc":case"comm":case"deriv":case"commderiv":o[n.license]=s[l];break;default:a=parseInt(l,10),a>=0&&a<=8&&(o[n.license]=a)}if(c)switch(c){case"rec":o[n.sort]="date-posted-desc";break;case"rel":o[n.sort]="relevance";break;case"int":o[n.sort]="interestingness-desc";break;default:}r.hd&&(o[n.media]="hdvideo");if(h)if(h.indexOf("faves")!==-1)m=h.split("-"),o[n.faves]=1,m.length>1?o[n.userId]=m[1]:f.signedIn&&(o[n.userId]=f.nsid);else if(e.TypeValidator.matches.nsid(h))o[n.userId]=h;else switch(h){case"contacts":o[n.contacts]="all";break;case"ff":o[n.contacts]="ff";break;case"getty":o[n.getty]="true";break;case"commons":o[n.commons]="true";break;case"usg":o[n.license]=8;break;case"all":default:}if(p)switch(p[0]){case"taken":p[1]&&(o[n.minTakenDate]=e.flutil.parseYYYYMMDDDatestamp(p[1])/1e3),p[2]&&(o[n.maxTakenDate]=e.flutil.parseYYYYMMDDDatestamp(p[2])/1e3);break;case"posted":p[1]&&(o[n.minUploadDate]=e.flutil.parseYYYYMMDDDatestamp(p[1])/1e3),p[2]&&(o[n.maxUploadDate]=e.flutil.parseYYYYMMDDDatestamp(p[2])/1e3);break;default:}if(d&&v)switch(d){case"tags":o=e.merge(o,this._processTags(v)),delete o[n.text];break;default:}for(u in r)t.indexOf(u)===-1&&(o[u]=r[u]);return o}function m(e){var t={},r=e[n.userId];return e[n.text]?t.q=e[n.text]:e[n.tags]&&(t.q=e[n.tags]),e[n.faves]?r?t.w="faves-"+r:t.w="faves":r?t.w=r:e[n.contacts]==="all"?t.w="contacts":e[n.contacts]==="ff"?t.w="ff":e[n.getty]==="true"?t.w="getty":e[n.commons]==="true"?t.w="commons":parseInt(e[n.license],10)===8&&(t.w="usg"),e[n.license]&&(t.l=c(e[n.license],!0)),t}function g(e){var t={},r=/(["'])(\\?.)*?\1/g,i=/[,\+\s]/,s=/^([,\+]|AND|OR)$/,o=/[\+\s]OR[\+\s]/,u,a,f,l;return u=e.match(r)||[],a=e.replace(r,""),f=a.split(i),f=f.map(function(e){return e.trim()}).filter(function(e){return e&&!s.test(e)}),l=u.concat(f),t[n.tags]=l.join(","),o.test(e)?(t[n.tagMode]="any",l.length=Math.min(l.length,11)):t[n.tagMode]="all",t}function y(e,t){e[n.sort]||(e[n.sort]="relevance"),e[n.license]&&(e[n.license]===s.all||e[n.license]==="")&&delete e[n.license]}function b(e){var t;for(t in e)u.indexOf(t)===-1&&delete e[t]}function w(e){var t;for(t in e)o.indexOf(t)===-1&&delete e[t]}function E(t){var n=e.clone(t)||{};return delete n.page,delete n.method,delete n.extras,e.QueryString.stringify(n)}function S(t){var r=t[n.groupId],i=t[n.tags],s=t[n.text];YUI.Env.isServer&&(r&&(t[n.groupId]=e.flutil.unescape(r)),i&&(t[n.tags]=e.flutil.unescape(i)),s&&(t[n.text]=e.flutil.unescape(s)))}function x(){var t={};return t[e.SearchHelper.API.text]="_____THIS-IS-AN-EMPTY-SEARCH-PLACEHOLDER_____",t}function T(e){var t=0;return e.photos&&!e.screenshots&&!e.other?t=1:!e.photos&&e.screenshots&&!e.other?t=2:!e.photos&&!e.screenshots&&e.other?t=3:e.photos&&e.screenshots&&!e.other?t=4:!e.photos&&e.screenshots&&e.other?t=5:e.photos&&!e.screenshots&&e.other?t=6:e.photos&&e.screenshots&&e.other&&(t=7),t}function N(e){var t={},n=parseInt(e,10);switch(n){case 1:t.photos=!0;break;case 2:t.screenshots=!0;break;case 3:t.other=!0;break;case 4:t.photos=!0,t.screenshots=!0;break;case 5:t.other=!0,t.screenshots=!0;break;case 6:t.photos=!0,t.other=!0;break;default:t.photos=!0,t.screenshots=!0,t.other=!0}return t}var t=["q","ss","ct","mt","l","s","w","d","m","hd","b","a","g","e","cm","xel","xeh","xal","xah","xfl","xfh","eui"],n={userId:"user_id",groupId:"group_id",setId:"set_id",page:"page",text:"text",tags:"tags",tagMode:"tag_mode",sort:"sort",safeSearch:"safe_search",contentType:"content_type",mediaType:"media",license:"license",faves:"faves",contacts:"contacts",getty:"is_getty",commons:"is_commons",minTakenDate:"min_taken_date",maxTakenDate:"max_taken_date",minUploadDate:"min_upload_date",maxUploadDate:"max_upload_date",hasGeo:"has_geo",boundingBox:"bbox",accuracy:"accuracy",woeId:"woe_id",camera:"camera",minExposure:"exif_min_exposure",maxExposure:"exif_max_exposure",minAperture:"exif_min_aperture",maxAperture:"exif_max_aperture",minFocalLength:"exif_min_focallen",maxFocalLength:"exif_max_focallen",excludeUserId:"exclude_user_id",foursquareWoeId:"foursquare_woeid",foursquareVenueId:"foursquare_venueid",slideshowStartId:"jump_to"
},r=["s","q","see"],i={username:"username",exact:"exact",showMore:"show_more",perPage:"per_page",page:"page",userId:"user_id",sort:"sort"},s={all:"0,1,2,3,4,5,6,7,8",cc:"1,2,3,4,5,6",deriv:"1,2,4,5",comm:"4,5,6",commderiv:"4,5"},o=[n.userId,n.groupId,n.faves,n.contacts],u=[n.userId,n.groupId,n.faves,n.contacts,n.safeSearch,n.sort,n.license,n.tags,n.text],a=20,f=50;e.SearchHelper={API:n,LICENSE_TYPE:s,PREFETCH_PAGE_SIZE:a,FETCH_PAGE_SIZE:f,decodeContentType:N,encodeContentType:T,isParameterlessSearch:l,mapRouteParamsToAPI:h,convertLicenseTypeValue:c,mapClassicSearchToAPI:v,mapClassicPeopleSearchToAPI:p,mapAPIParamsToAdvancedSearchQuery:m,addParamDefaults:y,addPeopleSearchParamDefaults:d,clearAdvancedSearchParams:b,clearSearchScope:w,generateQueryString:E,unescapeParameters:S,generateDefaultSearch:x,_processTags:g}},"@VERSION@",{requires:["type-validator","flutil"]});
YUI.add("hermes-template-big-input-search",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){var r="",i;return r+='placeholder="',(i=n.searchPlaceholder)?i=i.call(e,{hash:{},data:t}):(i=e.searchPlaceholder,i=typeof i===u?i.apply(e):i),r+=a(i)+'"',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<form class="ui-large-search" action="/search/" method="get" role="search">\n    <input type="text" name="text" value="" class="ui-huge-input" autocomplete="off" aria-label="Search" role="textbox"\n		',o=n["if"].call(t,t.searchPlaceholder,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+=' autofocus>\n    <label class="submitLabel">\n        <input type="submit" data-track="gnSearchBigSearchIcon" class="large-search-icon" tabindex="-1" aria-label="Search" role="button">\n	</label>\n</form>',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/big-input-search",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-search-photos-page",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return"ui-search-no-matches"}function d(e,t){return"ui-state-no-query"}function v(e,t){return"ui-state-api-fail"}function m(e,t){var i="",s,o,u;i+="\n		<header>\n			<h2>"+l((s=(s=(s=e.searchState,s==null||s===!1?s:s.noMatchesForQuery),s==null||s===!1?s:s.noMatchesText),typeof s===f?s.apply(e):s))+"</h2>\n			<h2>",u={hash:{intlName:"search.TRY_DIFFERENT"},data:t},i+=l((s=n.intlMessage||e.intlMessage,s?s.call(e,u):c.call(e,"intlMessage",u)))+"</h2>\n		</header>\n		",o=h.invokePartial(r["big-input-search"],"big-input-search",e,n,r,t);if(o||o===0)i+=o;return i+="\n	",i}function g(e,t){var i="",s;i+="\n\n		",s=h.invokePartial(r["big-input-search"],"big-input-search",e,n,r,t);if(s||s===0)i+=s;return i+='\n\n		<div class="ui-footer-fader">\n			<a href="'+l((s=(s=e.attribution,s==null||s===!1?s:s.link),typeof s===f?s.apply(e):s))+'" class="ui-background-attribution">'+l((s=(s=e.attribution,s==null||s===!1?s:s.by),typeof s===f?s.apply(e):s))+"</a>\n		</div>\n\n	",i}function y(e,t){var i="",s,o,u;i+="\n		<header>\n			<h2>",u={hash:{intlName:"search.API_ERROR_HEADER"},data:t},i+=l((s=n.intlMessage||e.intlMessage,s?s.call(e,u):c.call(e,"intlMessage",u)))+"</h2>\n			<h2>",u={hash:{intlName:"search.API_ERROR_SUBHEADER"},data:t},i+=l((s=n.intlMessage||e.intlMessage,s?s.call(e,u):c.call(e,"intlMessage",u)))+"</h2>\n		</header>\n		",o=h.invokePartial(r["big-input-search"],"big-input-search",e,n,r,t);if(o||o===0)i+=o;return i+="\n	",i}function b(e,t){var r="",i,s;return r+="\n	",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["footer-full-view"],s):c.call(e,"outlet",e["footer-full-view"],s)))+"\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=this.merge(r,e.partials),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing,h=this;a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["global-nav-view"],a):c.call(t,"outlet",t["global-nav-view"],a)))+"\n",a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["filter-bar-neutered-view"],a):c.call(t,"outlet",t["filter-bar-neutered-view"],a)))+'\n<main class="',u=n["if"].call(t,(o=t.searchState,o==null||o===!1?o:o.noMatchesForQuery),{hash:{},inverse:h.noop,fn:h.program(1,p,i),data:i});if(u||u===0)s+=u;s+=" ",u=n["if"].call(t,(o=t.searchState,o==null||o===!1?o:o.noQuery),{hash:{},inverse:h.noop,fn:h.program(3,d,i),data:i});if(u||u===0)s+=u;s+=" ",u=n["if"].call(t,(o=t.searchState,o==null||o===!1?o:o.apiFailed),{hash:{},inverse:h.noop,fn:h.program(5,v,i),data:i});if(u||u===0)s+=u;s+='" role="main">\n\n	',a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["search-photos-collection-view"],a):c.call(t,"outlet",t["search-photos-collection-view"],a)))+"\n\n	",u=n["if"].call(t,(o=t.searchState,o==null||o===!1?o:o.noMatchesForQuery),{hash:{},inverse:h.noop,fn:h.program(7,m,i),data:i});if(u||u===0)s+=u;s+="\n\n	",u=n["if"].call(t,(o=t.searchState,o==null||o===!1?o:o.noQuery),{hash:{},inverse:h.noop,fn:h.program(9,g,i),data:i});if(u||u===0)s+=u;s+="\n\n	",u=n["if"].call(t,(o=t.searchState,o==null||o===!1?o:o.apiFailed),{hash:{},inverse:h.noop,fn:h.program(11,y,i),data:i});if(u||u===0)s+=u;s+="\n\n</main>\n\n",a={hash:{},inverse:h.noop,fn:h.program(13,b,i),data:i},u=(o=n.isFlipped||t.isFlipped,o?o.call(t,t.flippers,"enable-styleguide-footer",a):c.call(t,"isFlipped",t.flippers,"enable-styleguide-footer",a));if(u||u===0)s+=u;return s+="\n",s}),r={};e.Array.each(["big-input-search","big-input-search","big-input-search"],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-photos-page",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-big-input-search","hermes-template-big-input-search","hermes-template-big-input-search"]});
YUI.add("collection-paginator",function(e){var t=100,n=e.CollectionPaginator=function(e,n,r){r&&r.page?this.page=this.startPage=r.page-1:this.page=this.startPage=0,r&&r.fetchPageSize?this.perPage=r.fetchPageSize:this.perPage=t,r&&r.viewPageSize?this.viewPageSize=r.viewPageSize:this.viewPageSize=Number.MAX_VALUE,this.lastPage=this.startPage+Math.ceil(this.viewPageSize/this.perPage),this.modelProxy=e,this.listAttr=n,this.prepending=!1,this._advanceToFirstIncompletePage(),this.valuesChangedHandle=this.modelProxy.on("valuesChanged",this._onValuesChanged.bind(this),!0)};n.prototype={passAttributesToFetcher:function(e){this.fetcherParamAttrs=e instanceof Array?e:[e]},next:function(e){return this.page<this.lastPage&&this.page++,this._getPage()},prev:function(e){return this.page>0&&this.page--,this._getPage()},getCollectionAsList:function(){return this.modelProxy.getValue(this.listAttr).getList()},getCurrentPageAsList:function(){var t=this.modelProxy.getValue(this.listAttr).getList(),n=this.startPage*this.perPage,r=n+this.viewPageSize;return t=t.slice(n,r),t.length&&(t=e.flutil.trimArray(t)),t},currentPageIsLoaded:function(){return this.getCurrentPageAsList().length===this.viewPageSize||this.modelProxy.getValue(this.listAttr).fetchedEnd},_getPage:function(){var e={},t=this.modelProxy.getValue(this.listAttr).getList(),n=(this.page-1)*this.perPage,r=this.page*this.perPage,i=this.startPage*this.perPage+this.viewPageSize,s=!1,o,u=this;if(this.viewPageSize<1e3&&this.page&&this.perPage){for(o=r+1;o<i;o++)if(typeof t[o]!="undefined"){s=!0;break}if(s)for(o=n;o<r;o++)if(typeof t[o]=="undefined"){this.prepending=!0;break}}return this.page&&(e.page=this.page),this.perPage&&(e.perPage=this.perPage),this.fetcherParamAttrs&&this.fetcherParamAttrs.forEach(function(t){e[t]=u.modelProxy.getValue(t)}),this.modelProxy.getValue(this.listAttr).getPage(e)},_onValuesChanged:function(e){var t;e[this.listAttr]&&e[this.listAttr].listDiff&&(t=e[this.listAttr].listDiff,this.prepending&&(this.prepending=!1,t.prepended=t.added),this.fire("listValueChanged",t))},_advanceToFirstIncompletePage:function(){var e=this.modelProxy.getValue(this.listAttr).getList(),t;if(this.viewPageSize===Number.MAX_VALUE)this.page=Math.floor(this.getCollectionAsList().length/this.perPage);else while(this.page<this.lastPage){t=e.slice(this.page*this.perPage,(this.page+1)*this.perPage);if(!(t.length>=this.perPage&&t.every(function(e){return typeof e!="undefined"})))break;this.page++}}},e.augment(n,e.EventTarget)},"@VERSION@",{requires:["event-custom","flutil"]});
YUI.add("storage-helper",function(e){e.StorageHelper={setItem:function(t,n,r){var i=r?"sessionStorage":"localStorage";if(e.config.win&&e.config.win[i])try{e.config.win[i][t]=n}catch(s){}},getItem:function(t,n){var r=n?"sessionStorage":"localStorage",i;if(e.config.win&&e.config.win[r])try{i=e.config.win[r][t]}catch(s){}return i},remove:function(t,n){var r=n?"sessionStorage":"localStorage";if(e.config.win&&e.config.win[r])try{e.config.win[r].removeItem(t)}catch(i){}},hasEntries:function(t,n){var r=n?"sessionStorage":"localStorage",i=!1;if(e.config.win&&e.config.win[r])try{i=typeof e.config.win[r][t]!="undefined"}catch(s){}return i}}},"@VERSION@",{requires:["url"]});
YUI.add("simple-event-emitter",function(e){"use strict";var t=function(){this.__events={},this.__state={}};t.prototype={on:function(e,t,n){this.__events[e]||(this.__events[e]=[]),this.__events[e].push([t,n||this])},fire:function(e){var t=Array.prototype.slice.call(arguments,1);this.__events[e]&&this.__events[e].forEach(function(e){e[0].apply(e[1],t)}),this.__state[e]=!0},detach:function(e,t){if(!t){this.__events[e]=[];return}this.__events[e]&&(this.__events[e]=this.__events[e].filter(function(e){return t===e[0]?!1:!0}))},is:function(e,t){return t===undefined?!!this.__state[e]:this.__state[e]=!!t},destroy:function(){this.__events=null,this.__state=null}},e.SimpleEventEmitter=t},"@VERSION@",{requires:[]});
YUI.add("asset-manager",function(e){"use strict";var t,n,r=e.flutil;n={normalizeAspect:{min:.65,max:10,fill:"#111111"},deferLoading:!1,placeHolderImg:"https://s.yimg.com/pw/images/spaceball.gif",errorImg:"https://s.yimg.com/pw/images/spaceball.gif",imgSelector:".ui-display-image",fadeOutClass:"ui-state-fade-out",detectHighDensityDisplay:!1,maxUpSampleAmount:.05,enableClassWidth:!1},t=e.AssetManager=function(t,i){e.SimpleEventEmitter.apply(this),this.options=r.extend({container:null,imgSelector:n.imgSelector,imgNode:null,normalizeAspect:!1,placeHolderImg:n.placeHolderImg,errorImg:n.errorImg,fadeOutClass:n.fadeOutClass,detectHighDensityDisplay:n.detectHighDensityDisplay,maxUpSampleAmount:n.maxUpSampleAmount,deferLoading:n.deferLoading,enableClassWidth:n.enableClassWidth},i),this.photo=t,this.options.normalizeAspect?this.normalize=r.extend({},n.normalizeAspect,this.options.normalizeAspect===!0?null:this.options.normalizeAspect):this.normalize={min:0,max:999},this.init()},t.prototype=r.objectCreate(e.SimpleEventEmitter.prototype,{init:function(e){e||(e=this.options),this.container=e.container,this.imgNode=e.imgNode||null,this.source=null,this.previous=null,this.sizes=null,this.width=0,this.height=0,this._hidden=!0,this._loaded=null,this._timers={},this.generateSizes()},generateSizes:function(){var e,t=this,n=this.photo.getValue("needsInterstitial"),r;e=this.photo.getValue("sizes"),r=Object.keys(e).reduce(function(r,i){if(i==="o")return r;if(t.options.noSquares)if(i==="q"||i==="sq")return r;var s=e[i];return s.url=s.url.replace(/^http:/i,"https:"),r.push({size:i,src:n?t.options.placeHolderImg:s.url,width:parseInt(s.width,10),height:parseInt(s.height,10),loaded:!1,_img:null,_cbs:[]}),r},[]),this.sizes=r.sort(function(e,t){return t.height-e.height})},updateHost:function(){if(!this.options.enableClassWidth||!this.container)return;var e,t=this.width,n=this.container.getDOMNode();t>400?e="ui-width-full":t>325?e="ui-width-large":t>250?e="ui-width-medium":t>175?e="ui-width-small":t>100?e="ui-width-mini":e="ui-width-nano",n.classList.remove("ui-width-full"),n.classList.remove("ui-width-large"),n.classList.remove("ui-width-medium"),n.classList.remove("ui-width-small"),n.classList.remove("ui-width-mini"),n.classList.remove("ui-width-nano"),n.classList.add(e)},updateImageNode:function(){var e=this;this.getImageNode(function(t){var n={width:e.naturalWidth+"px",height:e.naturalHeight+"px"};e.paddingLeft&&(n["border-left"]=[e.paddingLeft+"px","solid",e.normalize.fill].join(" ")),e.paddingLeft||(n["border-left"]="none"),e.paddingRight&&(n["border-right"]=[e.paddingRight+"px","solid",e.normalize.fill].join(" ")),e.paddingRight||(n["border-right"]="none"),t.setStyles(n),e.load()})},setSize:function(e,t){var n=this.options.maxUpSampleAmount,r,i,s,o,u,a,f,l,c;u=this.sizes[0];for(l=0,c=this.sizes.length;l<c;l++){o=this.sizes[l];if(o.height<t){a=u,f=o,s=t*n,r=Math.abs(a.height-t),i=Math.abs(f.height-t),i<r&&i<=s?this.render(e,t,f):this.render(e,t,a);return}u=o}this.render(e,t,this.sizes[0])},render:function(e,t,n){var r;this.previous=this.getSize(),this.source=n||{error:"no source"},e||(e=this.getScaledWidth(t)),t||(t=this.getScaledHeight(e)),this.width=e,this.height=t,this.naturalWidth=this.getNaturalScaledWidth(this.height),this.naturalHeight=this.height,this.paddingLeft=this.paddingRight=this.croppingHorizontal=0,this.source.size==="q"&&(this.naturalWidth=this.naturalHeight=this.width=this.height),r=this.width-this.naturalWidth,r>0?(this.paddingLeft=Math.floor(r/2),this.paddingRight=r-this.paddingLeft):this.croppingHorizontal=r/2>>0,this.updateHost(),this.updateImageNode()},getNaturalAspectRatio:function(){return this.sizes[0].width/this.sizes[0].height},getNaturalScaledHeight:function(e){return Math.ceil(1/this.getNaturalAspectRatio()*e)},getNaturalScaledWidth:function(e){return Math.ceil(this.getNaturalAspectRatio()*e)},getAspectRatio:function(){var e=this.getNaturalAspectRatio();return e<this.normalize.min?this.normalize.min:e>this.normalize.max?this.normalize.max:e},getScaledHeight:function(e){return Math.ceil(1/this.getAspectRatio()*e)},getScaledWidth:function(e){return Math.ceil(this.getAspectRatio()*e)},getImageNode:function(e,t){var n=this;t===undefined&&(t=10);if(!t)return;if(!this.container)return;this.imgNode||(this.imgNode=this.container.one(this.options.imgSelector),this.imgNode&&(this.imgNode.getDOMNode().onload=null));if(e&&!YUI.Env.isServer){if(!this.imgNode){n._timers.getImageNode=setTimeout(function(){n.getImageNode(e,t-1)},10);return}return e(this.imgNode)}return this.imgNode||null},load:function(){var e=this,t,n=this.getImageNode();if(!n)return;t=function(){n.getAttribute("src")!==e.source.src&&n.set("src",e.source.src),e.show()},this.queueResource(this.source,t)},queueResource:function(e,t){if(YUI.Env.isServer)return!1;if(e.loaded)return t&&t(),!0;if(!e._img){e._img=new Image,e._img.onload=function(){if(e.loaded)return;e.loaded=!0;while(e._cbs.length)e._cbs.shift()();e._img=null},e._img.onerror=function(){e._img=null},t&&e._cbs.push(t),e._img.src=e.src;if(e._img.complete){e.loaded=!0;while(e._cbs.length)e._cbs.shift()();return e._img=null,!0}}else t&&e._cbs.push(t);return!1},cancel:function(){var e=this.options.placeHolderImg,t;this.hide(),this.sizes.forEach(function(t){if(t.loaded||!t._img)return;t._img.src=e}),t=this.getImageNode();if(!t)return;t.set("src",e)},show:function(){if(!this._hidden)return;var e=this.getImageNode();if(!e)return;this._hidden=!1,e.getDOMNode().classList.remove(this.options.fadeOutClass)},hide:function(){if(this._hidden)return;var e=this.getImageNode();if(!e)return;this._hidden=!0,e.getDOMNode().classList.add(this.options.fadeOutClass)},getSize:function(){var e="";return this.paddingLeft&&(e+=["border-left:",this.paddingLeft+"px","solid",this.normalize.fill+";"].join(" ")),this.paddingRight&&(e+=["border-right:",this.paddingRight+"px","solid",this.normalize.fill+";"].join(" ")),this.croppingHorizontal&&(e+="margin-left: "+this.croppingHorizontal+"px;"),{src:this.source?
this.source.src:null,width:this.width,height:this.height,naturalWidth:this.naturalWidth,naturalHeight:this.naturalHeight,paddingLeft:this.paddingLeft,paddingRight:this.paddingRight,style:e,source:this.source||null}},toJSON:function(){var e=this.getSize();return this.options.deferLoading?(e.src=this.options.placeHolderImg,e.loaded=!1):e.loaded=this.queueResource(this.source),e},setContainer:function(e){this.imgNode=null,this.container=e},setImageNode:function(e){this.imgNode=e,this.container=null,this.imgSelector=null},destroy:function(){clearTimeout(this._timers.getImageNode),this.photo=null,this.container=null,this.sizes=null,this.source=null,this.previous=null,e.SimpleEventEmitter.prototype.destroy.apply(this)}})},"@VERSION@",{requires:["simple-event-emitter","flutil","asset-manager-css"]});
YUI.add("display-item",function(e){var t=this.name,n=e.flutil,r;r=e.Base.create(t,e.FlickrView,[],{is:function(e,t){return this.__state||(this.__state={}),t!==undefined&&(this.__state[e]=!!t),!!this.__state[e]},fire:function(t){this.is(t,!0),e.FlickrView.prototype.fire.apply(this,arguments)},when:function(e,t){if(this.is(e))return t();this.once(e,t)},subviewConfig:null,initialize:function(){this.render()},setupSubviews:function(){var t=this,r=this.subviewConfig||this.options.subviews||[],i=Array.isArray(r)?r.slice():Object.keys(r),s=i.length,o;return s?(this.fire("rendering"),o=new e.FlickrPromise(function(r,o){var u,a;u=function(e){if(--s)return;r()},a=function(e,r){r||(r={success:!0});if(!r.success)return o(r.msg);t.subviews||(t.subviews={}),i.forEach(function(r){var i,s,o;o=n.extend({appContext:t.appContext,parent:t},t.options),delete o.templateName,delete o.container,i=t.subviews[r]=new e.Views[r](o),s=t.getContainer({subview:i}),s&&i.set("container",s),i.when("rendered",u),i.initialize()})},e.betterUse(i).then(a)}),o):new e.AutoResolvingPromise},activateSubviews:function(){var e=this;Object.keys(this.subviews||{}).forEach(function(t){e.subviews[t].activate()})},activate:function(){this.fire("activated")},setupEvents:function(){},render:function(){this.buildContainer({})},buildContainer:function(e,t){var r,i,s,o,u,a;this._acquireEl?this._acquireEl=null:(s=this.get("container"),e=n.extend({state:this.__state,views:n.camelCaseifyKeys(this.subviews||{}),layout:{styles:this.stylesToJSON()}},e),t||(t=this.options.templateName),i=this.templates(t),r=i?i(e):'-- TEMPLATE "'+t+'" NOT FOUND --',s.setHTML(r),this.resetStyles(),u=Object.keys(e.views),!YUI.Env.isServer&&u.length&&(o=u.reduce(function(t,n){var r=e.views[n];return t[r.getId()]=r.get("container").getDOMNode(),t},{}),a=Array.prototype.slice.call(s.getDOMNode().getElementsByClassName("hb-placeholder")),a.forEach(function(e){if(!o[e.id])return;e.parentNode.replaceChild(o[e.id],e)}))),this.is("rendering",!1),this.fire("rendered",{view:this})},acquireContainer:function(e){this.set("container",e),this._acquireEl=!0,this.initialize()},setStyles:function(e,t){this._style||(this._style={}),this._style[e]||(this._style[e]={}),n.extend(this._style[e],t)},resetStyles:function(){this._style={}},stylesToJSON:function(){var e=this;return this._style||(this._style={}),Object.keys(this._style).reduce(function(t,n){var r=e._style[n];return t[n]=Object.keys(r).reduce(function(e,t){return e+t+":"+r[t]+";"},""),t},{})},updateDom:function(){if(YUI.Env.isServer)return;var e=this,t=this.get("container");this._style||(this._style={}),Object.keys(this._style).forEach(function(n){var r=e._el[n];r||(e._el[n]=r=t.getDOMNode().getAttribute("data-layout-element")===n?t:t.one('[data-layout-element="'+n+'"]'));if(!r)return;r.setStyles(e._style[n])}),this.resetStyles()},getId:function(){if(!this.__id){this.__id="DI-"+this.name.replace(/[^a-z]/gi,"").toUpperCase();var e=this.photo||this.get("photo");e&&(this.__id+="-"+e.id)}return this.__id},promiseState:function(t){var n=this,r;if(!t)throw new Error("DisplayItem.promiseState: eventName is required.");return this.is(t)?e.AutoResolvingPromise():(r=new e.FlickrPromise(function(e,r){n.once(t,e)}),r)},remove:function(){console.warn("display-item::remove() is a no-op. Implement on a subclass if needed.")},destructor:function(){return this.subviews=null,this.__state=null,this}},{ATTRS:{container:{value:"",setter:function(e){var t=e||this.getContainer({viewName:n.unCamelCaseify(this.name)});return this.assetManager&&this.assetManager.setContainer(t),t}}}}),e.namespace("Views")[t]=r},"@VERSION@",{requires:["flutil","flickr-view","better-use","asset-manager"]});
YUI.add("hermes-template-display-item-tile",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return"ui-display-tile-video"}function d(e,t){return"ui-state-restricted-interstitial"}function v(e,t){return"ui-state-fade-out"}function m(e,t){var n="",r;return n+="if (window.paftTiming) { window.paftTiming['"+l((r=(r=e.photo,r==null||r===!1?r:r.id),typeof r===f?r.apply(e):r))+"'] = new Date().getTime(); } ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<figure class="ui-display ui-display-tile ',u=n["if"].call(t,(o=t.photo,o==null||o===!1?o:o.isVideo),{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;s+=" ",u=n["if"].call(t,(o=t.photo,o==null||o===!1?o:o.needsInterstitial),{hash:{},inverse:c.noop,fn:c.program(3,d,i),data:i});if(u||u===0)s+=u;s+='" data-layout-element="display" style="'+l((o=(o=(o=t.layout,o==null||o===!1?o:o.styles),o==null||o===!1?o:o.display),typeof o===f?o.apply(t):o))+'">\n\n    <div class="ui-display-mask" data-action-click="open" data-action-touchstart="open" data-action-touchmove="showExif" data-layout-element="displayMask" style="'+l((o=(o=(o=t.layout,o==null||o===!1?o:o.styles),o==null||o===!1?o:o.displayMask),typeof o===f?o.apply(t):o))+'">\n		<a href="'+l((o=(o=t.photo,o==null||o===!1?o:o.url),typeof o===f?o.apply(t):o))+'" class="ui-display-link">\n			<img class="ui-display-image ',u=n.unless.call(t,(o=(o=t.photo,o==null||o===!1?o:o.current),o==null||o===!1?o:o.loaded),{hash:{},inverse:c.noop,fn:c.program(5,v,i),data:i});if(u||u===0)s+=u;s+='" src="'+l((o=(o=(o=t.photo,o==null||o===!1?o:o.current),o==null||o===!1?o:o.src),typeof o===f?o.apply(t):o))+'" width="'+l((o=(o=(o=t.photo,o==null||o===!1?o:o.current),o==null||o===!1?o:o.naturalWidth),typeof o===f?o.apply(t):o))+'" height="'+l((o=(o=(o=t.photo,o==null||o===!1?o:o.current),o==null||o===!1?o:o.naturalHeight),typeof o===f?o.apply(t):o))+'" data-layout-element="displayImage" onload="',u=n["if"].call(t,t.paft,{hash:{},inverse:c.noop,fn:c.program(7,m,i),data:i});if(u||u===0)s+=u;return s+="this.classList.remove('ui-state-fade-out');\" style=\""+l((o=(o=(o=t.photo,o==null||o===!1?o:o.current),o==null||o===!1?o:o.style),typeof o===f?o.apply(t):o))+'">\n			<div class="ui-display-shield"></div>\n		</a>\n    </div>\n\n    <button class="ui-delete-button unfluid" data-action="delete" title="',a={hash:{intlName:"groups.REMOVE_PHOTO"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'"><span>&nbsp;</span></button>\n\n    <a class="ui-bottom-gradient" href="'+l((o=(o=t.photo,o==null||o===!1?o:o.url),typeof o===f?o.apply(t):o))+'"></a>\n	<div class="meta-bar">\n		',a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,(o=t.views,o==null||o===!1?o:o.displayWidgetMeta),a):h.call(t,"outlet",(o=t.views,o==null||o===!1?o:o.displayWidgetMeta),a)))+'\n		<div class="inline-icons">\n			',a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,(o=t.views,o==null||o===!1?o:o.displayWidgetFave),a):h.call(t,"outlet",(o=t.views,o==null||o===!1?o:o.displayWidgetFave),a)))+"\n			",a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,(o=t.views,o==null||o===!1?o:o.displayWidgetComment),a):h.call(t,"outlet",(o=t.views,o==null||o===!1?o:o.displayWidgetComment),a)))+"\n		</div>\n	</div>\n\n</figure>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/display-item-tile",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-dialog-tooltip",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){return" ui-dialog-tooltip-witharrow"}function h(e,t){return" drop-up"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=this,f=n.helperMissing,l=this.escapeExpression;s+='<div class="ui-dialog-wrapper ui-dialog ui-dialog-tooltip',o=n["if"].call(t,t.arrow,{hash:{},inverse:a.noop,fn:a.program(1,c,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t.dropUp,{hash:{},inverse:a.noop,fn:a.program(3,h,i),data:i});if(o||o===0)s+=o;return s+='" data-action="halt">\n	<span class="ui-dialog-arrow"></span>\n	<div class="ui-dialog-body">\n	',u={hash:{},data:i},s+=l((o=n.dialogOutlet||t.dialogOutlet,o?o.call(t,t.content,u):f.call(t,"dialogOutlet",t.content,u)))+"\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/dialog-tooltip",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-dialog-modal",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression;return s+='<div class="ui-dialog-wrapper ui-dialog ui-dialog-modal">\n	<div class="ui-dialog-body">\n	',u={hash:{},data:i},s+=f((o=n.dialogOutlet||t.dialogOutlet,o?o.call(t,t.content,u):a.call(t,"dialogOutlet",t.content,u)))+"\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/dialog-modal",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-dialog-alert",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=n.helperMissing;return s+='<div class="ui-dialog-wrapper ui-dialog ui-dialog-alert">\n    <div class="dialog-title">\n		<h3>'+f((o=(o=t.attrs,o==null||o===!1?o:o.title),typeof o===a?o.apply(t):o))+'</h3>\n		<i class="close-alert ui-dialog-button-close" data-action="dismiss"></i>\n    </div>\n    <div class="dialog-content">\n        <i class="ui-icon-modal-error '+f((o=(o=t.attrs,o==null||o===!1?o:o.level),typeof o===a?o.apply(t):o))+'"></i>\n        <div class="alert-dialog-text">\n    	',u={hash:{},data:i},s+=f((o=n.dialogOutlet||t.dialogOutlet,o?o.call(t,t.content,u):l.call(t,"dialogOutlet",t.content,u)))+'\n    	</div>\n    </div>\n    <button class="ui-button ui-button-cta" data-action="ok">\n        <span>'+f((o=(o=t.attrs,o==null||o===!1?o:o.confirmLabel),typeof o===a?o.apply(t):o))+"</span>\n    </button>\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/dialog-alert",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-dialog-cta",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return"ui-buttonbar-vertical"}function d(e,t){var n="",r;return n+='\n				<button class="ui-button ui-button-cta" data-action="confirm"><span>'+l((r=(r=e.attrs,r==null||r===!1?r:r.confirmButtonText),typeof r===f?r.apply(e):r))+"</span></button>\n			",n}function v(e,t){var r="",i;r+="\n				",i=n["if"].call(e,e.buttonMarkup,{hash:{},inverse:c.program(8,g,t),fn:c.program(6,m,t),data:t});if(i||i===0)r+=i;return r+="\n			",r}function m(e,t){var n="",r;return n+="\n					"+l((r=e.buttonMarkup,typeof r===f?r.apply(e):r))+"\n				",n}function g(e,t){var r="",i;r+='\n					<button class="ui-button" ',i=n["if"].call(e,e.buttonAction,{hash:{},inverse:c.noop,fn:c.program(9,y,t),data:t});if(i||i===0)r+=i;return r+="><span>"+l((i=e.buttonLabel,typeof i===f?i.apply(e):i))+"</span></button>\n				",r}function y(e,t){var n="",r;return n+='data-action="'+l((r=e.buttonAction,typeof r===f?r.apply(e):r))+'"',n}function b(e,t){var n="",r;return n+='\n				<button class="ui-button" data-action="decline"><span>'+l((r=(r=e.attrs,r==null||r===!1?r:r.cancelButtonText),typeof r===f?r.apply(e):r))+"</span></button>\n			",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<div class="ui-dialog-wrapper ui-dialog ui-dialog-cta">\n	<h1 class="ui-dialog-title">'+l((o=(o=t.attrs,o==null||o===!1?o:o.title),typeof o===f?o.apply(t):o))+'</h1>\n	<div class="ui-dialog-body">\n		<div class="ui-util-paragraph">\n			',a={hash:{},data:i},s+=l((o=n.dialogOutlet||t.dialogOutlet,o?o.call(t,t.content,a):h.call(t,"dialogOutlet",t.content,a)))+'\n		</div>\n		<div class="ui-buttonbar ',u=n["if"].call(t,(o=t.attrs,o==null||o===!1?o:o.verticalButtonList),{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;s+='">\n			',u=n.unless.call(t,(o=t.attrs,o==null||o===!1?o:o.hideConfirmButton),{hash:{},inverse:c.noop,fn:c.program(3,d,i),data:i});if(u||u===0)s+=u;s+="\n			\n			",u=n.each.call(t,(o=t.attrs,o==null||o===!1?o:o.additionalButtons),{hash:{},inverse:c.noop,fn:c.program(5,v,i),data:i});if(u||u===0)s+=u;s+="\n			\n			",u=n["if"].call(t,(o=t.attrs,o==null||o===!1?o:o.useCancelButton),{hash:{},inverse:c.noop,fn:c.program(11,b,i),data:i});if(u||u===0)s+=u;return s+="\n		</div>\n	</div>\n</div>\n\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/dialog-cta",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("dialog",function(e){"use strict";var t,n,r={},i=e.config.win,s=e.config.doc;t={css:{state:"c-state-{{state}}",hidden:"ui-util-hidden",loading:"ui-util-loading",working:"ui-util-working",locked:"ui-util-locked",complete:"ui-util-complete",removed:"ui-util-removed",content:"js-content",wrapper:"ui-dialog-wrapper",anchorSelected:"ui-util-selected",curtain:"ui-dialog-modal-curtain",curtainClear:"ui-dialog-modal-curtain-clear",arrow:"ui-dialog-arrow"},transitionTimeout:2e3,debug:!1},n=e.merge(e.flutil,{log:function(){if(!t.debug||!console.log.apply)return;var e=[].slice.call(arguments);e.unshift("DIALOG"),n.dump.apply(null,e)},propagateWrapperAttributes:function(e,n){var r=[],i;return n?(Array.prototype.slice.call(n.getDOMNode().classList).forEach(function(i){if(i===t.css.wrapper)return;n.removeClass(i),e.addClass(i),r.push(i)}),i=n.getAttribute("data-action"),i&&(n.removeAttribute("data-action"),r.push({attr:"data-action",restore:e.getAttribute("data-action")||null}),e.setAttribute("data-action",i)),r):r},rollbackWrapperAttributes:function(e,t){if(!t)return;for(var n=0,r=t.length;n<r;n++)typeof t[n]=="object"?t[1].restore?e.setAttribute(t[n].name,t[n].restore):e.removeAttribute(t[n].name):e.removeClass(t[n])}}),e.namespace("Views").dialog={_dialogs:{},getInstance:function(t,r){var i,s,o;return r.id?s={id:r.id}:(s=e.merge(r),delete s.parent,delete s.rootEl,delete s.template,delete s.appContext,typeof s.content=="object"&&s.content instanceof e.FlickrView?s.content=s.content.get("container").toString():typeof s.content=="function"?s.content=s.content({}):s.content.toString()),i="SGL"+n.createHashCode(s),o=this._dialogs[t+":"+i],o?o:this._new(t,i,r)},getNewInstance:function(e,t){var n="OBJ"+(Object.keys(this._dialogs).length+1)+(new Date).getTime();return this._new(e,n,t)},_new:function(t,n,i){var s,o,u,a,f;if(e.Env.isServer)throw new Error("Dialogs are client-only!");i=e.mix(i||{});if(i.parent)o=i.parent,delete i.parent,a=o.getContainer({subviewName:t,subviewParams:i}),u=o.appContext;else{if(!i.appContext)throw new Error('Either the "appContext" or "parent" parameter is required!');o=null,u=i.appContext,a=e.Node.create("<div/>"),a.addClass("view").addClass(t)}return i.appContext=u,i.container=a,s=new r[t](i),f=t+(n?":"+n:""),this.registerView(s,f),this._navigateCloseHook||(this._navigateCloseHook=u.flapp.on("navigate",this.close.bind(this))),s},registerView:function(e,t){var n=this;t=t||"REG"+(Object.keys(this._dialogs).length+1),e.manager=this,this._dialogs[t]=e,e.on("destroy",function(){delete n._dialogs[t]})},hide:function(e){this.close(e,"hide")},close:function(e,t){var n=this,r;t=t||"close",typeof e=="string"?r=function(r){if(e!==r.split(/:/)[0])return;n._dialogs[r][t]()}:typeof e=="object"?r=function(r){if(e===n._dialogs[r])return;n._dialogs[r][t]()}:r=function(e){n._dialogs[e].get("autoCloseable")&&n._dialogs[e][t]()},Object.keys(this._dialogs).forEach(r)},isOpen:function(e){},util:n},e.namespace("Views").dialogs=r,r["dialog-base"]=e.Base.create("dialog-base",e.FlickrView,[],{initializer:function(e){return e=e||{},this.state={},this.manager=null,this.appContext=this.appContext||e.appContext,this},render:function(){var n=this.templates(this.get("template"))(this.toJSON());return this.setContainerHTML(n),e.namespace("Views").dialog.util.propagateWrapperAttributes(this.get("container"),this.get("container").one("."+t.css.wrapper)),this.renderContent(),this.activate(),this.get("container").addClass(t.css.hidden),this.anchorToLayout(),this.state.visible=!0,this.hide(),this.state.rendered=!0,this.fire("rendered"),this},renderContent:function(r){var i=this.get("content"),s=this.get("container"),o=s.one("."+t.css.content);e.namespace("Views").dialog.util.rollbackWrapperAttributes(this.get("container"),this._contWrap);if(i instanceof e.FlickrView){i=i.get("container");if(!i)throw new Error("The Content View doesn't have a container");o.setHTML(""),o.appendChild(i)}else i instanceof e.Node?(o.setHTML(""),o.appendChild(i)):typeof i=="function"?(i=i(e.merge(this.toJSON(),r)),o.setHTML(i)):typeof i=="string"&&this.state.rendered&&o.setHTML(i);this._contWrap=n.propagateWrapperAttributes(s,o.one("."+t.css.wrapper))},renderCurtain:function(){var n=this,r,i=e.Number.parse(this.get("tintCurtain"));this.get("curtain")||(r=e.Node.create("<div/>"),r.addClass(t.css.curtain).addClass(t.css.hidden),this.get("visibleShim")||r.addClass(t.css.curtainClear),r.on("click",this.dismiss,this),i&&r.setStyle("backgroundColor","rgba(0, 0, 0, "+i+")"),this.set("curtain",r),this.get("appendCurtainTo")?this.get("appendCurtainTo").appendChild(r):this.get("container").ancestor()&&this.get("container").ancestor().insert(r,"after")),n.get("curtain").removeClass(t.css.hidden)},anchorToLayout:function(){var e=this.get("container"),t=this.get("anchorTo"),n;(this.get("appendTo")||t||this.get("rootEl")).appendChild(e),this.get("positioning")?(this.get("dropUp")&&(n="bottomright"),this.refreshPosition(n)):this.manualPosition()},refreshPosition:function(n){var r,s,o,u,a,f,l,c,h=this.get("container"),p=this.get("anchorTo"),d=this.get("offsetLeft")||0,v,m;u=h.getDOMNode().getBoundingClientRect(),this.set("width",h.getComputedStyle("width")),this.set("height",h.getComputedStyle("height")),h.getComputedStyle("position")==="fixed"&&h.setStyles({marginLeft:(-1*u.width/2|0)-d+"px",marginTop:(-1*u.height/2|0)+"px"});if(p){r=p.getDOMNode().getBoundingClientRect(),this.set("anchorWidth",r.width),this.set("anchorHeight",r.height),m=e.merge({top:0,bottom:0,left:0,right:0},this.get("constraints")),c={top:m.top,bottom:i.innerHeight+m.bottom,left:m.left,right:i.innerWidth+m.right},a=[[r.bottom+u.height<c.bottom&&r.right+u.width<c.right,{left:0,top:r.height},"topleft"],[r.bottom+u.height<c.bottom&&r.left-u.width>c.left,{right:0,top:r.height},"topright"],[r.top>u.height+c.top&&r.right+u.width<c.right,{left:0,bottom:r.height},"bottomleft"],[r.top>u.height+c.top&&r.left-u.width>c.left,{right:0,bottom:r.height},"bottomright"],[!0,{left:Math.round
(-1*(u.width-r.width)/2),top:r.height},"topcenter"]],n&&(n=n.toLowerCase(),a=a.filter(function(e){return e[2]===n?(e[0]=!0,!0):!1})||a);while(a.length){l=a.shift();if(l[0]){f=l[1],h.addClass("ui-dialog-tooltip-witharrow-"+l[2]),h.setStyles(e.mix({top:"auto",bottom:"auto",left:"auto",right:"auto"},f,!0));break}}v=h.one("."+t.css.arrow),v&&(s=20,f.left!==0&&f.right!==0?o=Math.round((u.width-s)/2)+"px":o=Math.round((r.width-s)/2)+"px",v.setStyles({right:f.right===undefined?"auto":o,left:f.left===undefined?"auto":o}))}},manualPosition:function(){if(this.get("arrow")){var e=typeof this.get("arrow")=="string"?this.get("arrow"):"topleft";this.get("container").addClass("ui-dialog-tooltip-witharrow-"+e)}},activate:function(){var e={":confirm":this.confirm,":decline":this.decline,":dismiss":this.dismiss,":ok":this.dismiss,":halt":function(e){e.halt()}};return this.attachEvents(e),this},toJSON:function(){var t=this.getAttrs();return Object.keys(t).reduce(function(n,r){var i=t[r];return i instanceof e.Node?n:i instanceof e.FlickrView?n:(i&&i.toJSON&&(i=i.toJSON()),n[r]=i,n)},{})},isVisible:function(){return!!this.state.visible},isLocked:function(){return!!this.state.locked},isWorking:function(){return!!this.state.working},show:function(r){var i=this,s=this.get("container"),o=this.get("anchorTo");this.set("dismissing",!1),this.switchToLoading(!1);if(this.state.visible)return;this.state.rendered||this.render(),i.state.visible=!0,s.addClass(this.get("dialogClass")),this.fire("show"),s.removeClass(t.css.removed),setTimeout(function(){n.onTransitionEnd(s,r),s.removeClass(t.css.hidden),o&&o.addClass(t.css.anchorSelected)},10),e.fire("flickr:setKeyEventScope",this.getKeyEventScope())},handleError:function(e){return function(t){console.error(e,!t.toString||t.toString().match(/^\[object/)?t:t.toString())}},getKeyEventScope:function(){return this.name+this._yuid},close:function(e){if(this._destroyed)return;var t=this;this.set("dismissing",!1),this.fire("close"),this.hide(function(){t.destructor(),e&&e()})},destructor:function(){var t=this.get("container");t.detach(),t.remove(),this.set("container",null),this.set("content",null),this.set("appendTo",null),this.set("anchorTo",null),this.set("rootEl",null),this.set("dialogClass",null),this.manager=null,e.FlickrView.prototype.destroy.call(this),this._destroyed=!0,this.fire("destroy"),this.detachAll()},hide:function(r){e.fire("flickr:removeKeyEventScope",this.getKeyEventScope());if(!this.state.visible)return;var i=this,s=this.get("container"),o=this.get("anchorTo"),u=this.get("curtain"),a=!this.state.rendered;this.state.visible=!1,o&&o.removeClass(t.css.anchorSelected),u?(this.set("curtain",null),u.detach(),n.onTransitionEnd(u,function(){u.remove()}),u.addClass(t.css.hidden)):s.addClass(t.css.removed),e.namespace("Views").dialog.util.onTransitionEnd(s,function(){i.set("dismissing",!1),a||i.fire("hide"),i.state.visible||s.addClass(t.css.removed),r&&r()}),s.addClass(t.css.hidden)},toggle:function(e){this[this.state.visible?"hide":"show"](e),this.fire("toggle",this.state.visible)},switchToLoading:function(e){this.switchToUIState("loading",e)},switchToComplete:function(e){this.switchToUIState("complete",e)},switchToLocked:function(e){this.switchToUIState("locked",e)},switchToWorking:function(e){this.switchToUIState("working",e)},switchToUIState:function(e,n){var r;n=n===!1?!1:!0;if(this.state[e]===n)return;n&&this.show(),this.state[e]=n,r=t.css[e]||t.css.state.replace(/\{\{state\}\}/,e),this.get("container")[n?"addClass":"removeClass"](r)},confirm:function(t,n){t.halt(),this.fire("confirm",n),this.get("hideOnButtonClick")&&this.hide(),e.namespace("Views").dialog.util.log("CONFIRM")},decline:function(t,n){t.halt(),this.fire("decline",n),this.get("hideOnButtonClick")&&this.hide(),e.namespace("Views").dialog.util.log("DECLINE")},dismiss:function(t,n){if(this.isWorking()||!this.get("hideOnCurtainClick"))if(t.target===this.get("curtain"))return;this.set("dismissing",!0),t.halt(),this.fire("dismiss",n),this.hide(),e.namespace("Views").dialog.util.log("DISMISS")}},{ATTRS:{template:{value:"dialog"},anchorTo:{value:null},offsetLeft:{value:0},appendTo:{value:null},appendCurtainTo:{value:null},hideOnCurtainClick:{value:!0},tintCurtain:{value:0},rootEl:{value:e.Node&&e.one(s&&s.body)},content:{value:null},attrs:{value:{}},stack:{value:!1},hideOnButtonClick:{value:!0},visibleShim:{value:!0},positioning:{value:!0},arrow:{value:!1},dropUp:{value:!1},constraints:{value:{}},dialogClass:{value:""},autoCloseable:{value:!0}}}),r["dialog-tooltip"]=e.Base.create("dialog-tooltip",r["dialog-base"],[],{show:function(){this.get("stack")||this.manager&&this.manager.close&&this.manager.close(this),r["dialog-base"].prototype.show.apply(this,arguments),this.renderCurtain()}},{ATTRS:{template:{value:"dialog-tooltip"},offsetLeft:{value:0},visibleShim:{value:!1}}}),r["dialog-modal"]=e.Base.create("dialog-modal",r["dialog-base"],[],{anchorToLayout:function(){this.set("anchorTo",null),r["dialog-base"].prototype.anchorToLayout.apply(this,arguments)},show:function(e,t){var n=t||{},i=n.hideOthers||!1;i?this.get("stack")||this.manager.hide(this):this.get("stack")||this.manager.close(this),r["dialog-base"].prototype.show.call(this,e),this.renderCurtain()}},{ATTRS:{template:{value:"dialog-modal"}}}),r["dialog-alert"]=e.Base.create("dialog-alert",r["dialog-base"],[],{show:function(){this.get("stack")||this.manager.close(this),r["dialog-base"].prototype.show.apply(this,arguments),this.renderCurtain()}},{ATTRS:{template:{value:"dialog-alert"},offsetLeft:{value:0},visibleShim:{value:!1}}}),r["dialog-cta"]=e.Base.create("dialog-cta",r["dialog-base"],[],{show:function(){this.get("stack")||this.manager.close(this),r["dialog-base"].prototype.show.apply(this,arguments),this.renderCurtain()},hide:function(){this.get("curtain")&&(this.get("curtain").remove(),this.set("curtain",null)),r["dialog-base"].prototype.hide.apply(this,arguments)}},{ATTRS:{template:{value:"dialog-cta"},offsetLeft:{value:0},visibleShim:{value:!1}}}
),r["dialog-progress"]=e.Base.create("dialog-progress",r["dialog-base"],[],{},{ATTRS:{template:{value:"dialog-progress"}}}),e.Handlebars.registerHelper("dialogOutlet",function(n){var r=['<div class="'+t.css.content+'">'];return n instanceof e.FlickrView||n instanceof e.Node?r.push("<!--"+(n.name||"DOM-node")+"-->"):r.push((n||"")+""),r.push("</div>"),new e.Handlebars.SafeString(r.join(""))})},"@VERSION@",{requires:["flickr-view","handlebars-base","flutil","hermes-template-dialog-tooltip","hermes-template-dialog-modal","hermes-template-dialog-alert","hermes-template-dialog-cta","flickrui-css"]});
YUI.add("signin-helper",function(e){function t(t,n){e.FlickrStorage.store(t,n)}function n(e,n){var r="fave";t(r,e),a(r,n)}function r(e,t){var n="comment";a(n,t)}function i(e,n){var r="share";t(r,e),a(r,n)}function s(t){var n,r,i=[];if(!t)return;if(e.FlickrStorage.hasEntries()){n=e.FlickrStorage.retrieve();for(r in n)o(t,n[r])||i.push(n[r])}return e.FlickrStorage.remove(),i}function o(e,t){var n=t.key,r=t.value;switch(n){case"fave":return u(e,r),!0;case"share":return!1}}function u(e,t){var n=t.id,r=e.getModelRegistry("photo-engagement-models");r.then(function(e){var t=e.proxy(n);t.registry.addAsFave(n)&&t.remoteUpdate()})}function a(t,n){if(n&&n.withPopup)var r=e.config.win.open(f(n),"_blank","height=650,resizable=1,scrollbars=1,location=yes"),i=setInterval(function(){r.closed&&(clearInterval(i),window.location.reload())},1e3);else e.config.win.location=f(n)}function f(t){t=t||{},t.closeWhenDone&&(t.postLoginUrl=e.url("/photo_grease_postlogin.gne",{protocol:!1}));var n=t.postLoginUrl||e.config.win.location.href,r=t.url||e.url("/signin/yahoo/",{protocol:!1});return r+"?redir="+encodeURIComponent(n)}e.FlickrStorage={_storageKey:"flickrStorage",store:function(t,n){try{var r=[];e.StorageHelper.hasEntries(this._storageKey)&&(r=this.retrieve()),r.push({key:t,value:n}),e.StorageHelper.setItem(this._storageKey,JSON.stringify(r))}catch(i){}},retrieve:function(){var t={};try{t=JSON.parse(e.StorageHelper.getItem(this._storageKey))}catch(n){}return t},remove:function(){try{e.StorageHelper.remove(this._storageKey)}catch(t){}},hasEntries:function(){return e.StorageHelper.hasEntries(this._storageKey)}},e.SigninHelper={savePreLoginAction:t,addPendingFave:n,addPendingComment:r,addPendingShare:i,checkPendingQueue:s,_redirectToSignin:a,_getSigninUrl:f}},"@VERSION@",{requires:["url","storage-helper"]});
YUI.add("hermes-template-confirmation-dialog",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return'\n<div class="delete-image-dialog-content">\n	<div class="delete-image-image">\n	        <img class="photo-to-delete" />\n	</div>\n</div>\n\n'}function d(e,t){var r="",i,s,o;r+='\n<div class="dialog-content">\n	',i=n["if"].call(e,e.icon,{hash:{},inverse:c.noop,fn:c.program(4,v,t),data:t});if(i||i===0)r+=i;return r+='\n	<div class="dialog-description">\n		<div>',o={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e.content,!1,o):h.call(e,"outlet",e.content,!1,o)))+" ",(s=n.deletePhotoConfirmation)?s=s.call(e,{hash:{},data:t}):(s=e.deletePhotoConfirmation,s=typeof s===f?s.apply(e):s),r+=l(s)+"</div>\n	</div>\n</div>\n",r}function v(e,t){var r="",i;return r+='\n		<i class="dialog-icon ',(i=n.icon)?i=i.call(e,{hash:{},data:t}):(i=e.icon,i=typeof i===f?i.apply(e):i),r+=l(i)+'"></i>\n	',r}function m(e,t){var r="",i,s;return r+='\n	<a class="ui-button ui-button-cta ui-dialog-button-confirm" href="',(i=n.organizrLink)?i=i.call(e,{hash:{},data:t}):(i=e.organizrLink,i=typeof i===f?i.apply(e):i),r+=l(i)+'" target="_blank"><span>',s={hash:{intlName:"photo-page-scrappy.GO_TO_ORGANIZER"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+"</span></a>\n",r}function g(e,t){var r="",i;r+="\n	",i=n["if"].call(e,e.showConfirmButton,{hash:{},inverse:c.noop,fn:c.program(9,y,t),data:t});if(i||i===0)r+=i;r+="\n	",i=n["if"].call(e,e.showCancelButton,{hash:{},inverse:c.noop,fn:c.program(11,b,t),data:t});if(i||i===0)r+=i;r+="\n	",i=n["if"].call(e,e.showAuxiliaryButton,{hash:{},inverse:c.noop,fn:c.program(13,w,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function y(e,t){var r="",i;return r+='\n		<button class="ui-button ui-button-cta ui-dialog-button-confirm ',(i=n.confirmButtonClass)?i=i.call(e,{hash:{},data:t}):(i=e.confirmButtonClass,i=typeof i===f?i.apply(e):i),r+=l(i)+'"><span>',(i=n.confirmButtonLabel)?i=i.call(e,{hash:{},data:t}):(i=e.confirmButtonLabel,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span></button>\n	",r}function b(e,t){var r="",i;return r+='\n		<button class="ui-button ui-button-cta ui-dialog-button-confirm ui-dialog-button-cancel ',(i=n.cancelButtonClass)?i=i.call(e,{hash:{},data:t}):(i=e.cancelButtonClass,i=typeof i===f?i.apply(e):i),r+=l(i)+'"><span>',(i=n.cancelButtonLabel)?i=i.call(e,{hash:{},data:t}):(i=e.cancelButtonLabel,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span></button>\n	",r}function w(e,t){var r="",i;return r+='\n		<button class="ui-button ui-button-cta ui-dialog-button-confirm auxiliary-confirmation ',(i=n.auxiliaryButtonClass)?i=i.call(e,{hash:{},data:t}):(i=e.auxiliaryButtonClass,i=typeof i===f?i.apply(e):i),r+=l(i)+'"><span>',(i=n.auxiliaryButtonLabel)?i=i.call(e,{hash:{},data:t}):(i=e.auxiliaryButtonLabel,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span></button>\n	",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<div class="dialog-title">\n		<h3>',a={hash:{},data:i},s+=l((o=n.renderTrustedMarkup||t.renderTrustedMarkup,o?o.call(t,t.title,a):h.call(t,"renderTrustedMarkup",t.title,a)))+'</h3>\n		<i class="cancel-confirmation ui-dialog-button-close"></i>\n</div>\n\n',u=n["if"].call(t,t.deletePhotoConfirmation,{hash:{},inverse:c.program(3,d,i),fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;s+="\n\n",u=n["if"].call(t,t.organizrLink,{hash:{},inverse:c.program(8,g,i),fn:c.program(6,m,i),data:i});if(u||u===0)s+=u;return s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/confirmation-dialog",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
