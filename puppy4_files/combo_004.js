YUI.add("search-photos-page-view",function(e){e.namespace("Views")[this.name]=e.Base.create("search-photos-page-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){this.searchId=t.searchId,this.apiParams={},this.searchTerm=t.searchTerm,this.apiFailed=t.apiFailed;var n=this.name.replace(/-/g,"_");return this.appContext.flipper.isFlipped("paft")&&e.config.flickr.paft_metrics_samples&&e.config.flickr.paft_metrics_samples[n]&&(t.paft=!0),this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,isSearchResults:!0},"filter-bar-neutered-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-photos-collection-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){var t=this,n,r,i=this.appContext.getViewer(),s;return i.signedIn?r=this.appContext.getModel("person-preferences-models",i.nsid):r=new e.AutoResolvingPromise,this.apiFailed?n=new e.AutoResolvingPromise:n=this.appContext.getModel("search-photos-models",this.searchId),s=e.batch(r,n),s.then(function(n){n[0]&&(t.personPreferencesModel=n[0]),n[1]?(t.searchModel=n[1],t.apiParams=t.searchModel.getValue("apiParams")):e.SearchHelper.addParamDefaults(t.apiParams,t.personPreferencesModel)}),s},buildContainer:function(){var e="",t="",n="",r={apiFailed:!1,noQuery:!1,noMatchesForQuery:!1},i,s,o;return this.apiFailed?(r.apiFailed=!0,s=this.intlMessage({intlName:"search.SEARCH"}),t=this.subviews["filter-bar-neutered-view"].get("container"),n=this.subviews["footer-full-view"].get("container")):this.searchModel.getValue("photos").getList().length?(e=this.subviews["search-photos-collection-view"].get("container"),t=this.subviews["filter-bar-neutered-view"].get("container"),n=this.subviews["footer-full-view"].get("container")):this.searchModel.getValue("emptyQuery")?(r.noQuery=!0,s=this.intlMessage({intlName:"search.SEARCH_START"}),i=this.intlMessage({intlName:"search.BY_USER",user:"Gilles Couturier"})):(r.noMatchesForQuery=this.buildNoMatchesFoundMessage(),s=this.intlMessage({intlName:"search.SEARCH"}),t=this.subviews["filter-bar-neutered-view"].get("container"),n=this.subviews["footer-full-view"].get("container")),o={"global-nav-view":this.subviews["global-nav-view"].get("container"),"filter-bar-neutered-view":t,"search-photos-collection-view":e,searchState:r,searchPlaceholder:s,flippers:this.appContext.flipper.toJSON(),"footer-full-view":n,attribution:{link:"/photos/papy06/11384700923",by:i}},this.setContainerHTML(this.templates("search-photos-page")(o)),this},buildNoMatchesFoundMessage:function(){var t,n,r,i=this.appContext.getViewer();return n=this.searchModel.getValue("apiParams"),n.user_id?i.signedIn&&n.user_id===i.nsid?this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_YOUR":r="search.NO_MATCHES_FOR_QUERY_TERM_YOUR":this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_USER":r="search.NO_MATCHES_FOR_QUERY_TERM_USER":n.contacts?this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_CONTACTS":r="search.NO_MATCHES_FOR_QUERY_TERM_CONTACTS":n.group_id?this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_GROUP":r="search.NO_MATCHES_FOR_QUERY_TERM_GROUP":this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM":r="search.NO_MATCHES_FOR_QUERY",this.searchTerm?t=this.intlMessage({intlName:r,searchTerm:e.flutil.unescape(this.searchTerm)}):t=this.intlMessage({intlName:r}),{noMatchesText:t}},activate:function(){var t=this,n;return this.registerEventHandler(this.subviews["filter-bar-neutered-view"].on("navigating",function(){var e=t.subviews["search-photos-collection-view"];e&&e.displayLoadingIndicator("searching")})),n=this.get("container").one("form.ui-large-search"),n&&this.registerEventHandler(n.on("submit",function(n){delete t.apiParams[e.SearchHelper.API.tags],t.apiParams[e.SearchHelper.API.text]=this.one("input").get("value"),e.SearchHelper.clearAdvancedSearchParams(t.apiParams),e.SearchHelper.addParamDefaults(t.apiParams,t.personPreferencesModel),t.appContext.flapp.navigate("/search/?"+e.QueryString.stringify(t.apiParams)),n.preventDefault()})),e.later(100,this,function(){t.appContext.flipper.isFlipped("enable-scrappy-photo-page")?e.use("photo-page-scrappy-view"):e.use("photo-page-view")}),this}},{ATTRS:{spaceid:{value:792600534}}})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","search-helper","hermes-template-search-photos-page","search-photos-page-css","search-photos-collection-view","display-collection-justified","flickrui-css","footer-full-view","filter-bar-neutered-view","querystring-stringify-simple"],optional:["search-photos-models"],langBundles:["search"]});
YUI.add("hermes-lang-client-app",function(e,t){e.Intl.add("hermes/client-app","en-US",{SAVING_LAST_ACTIONS:["Hey! We\u2019re still saving your last actions, you might lose them if you leave this page."]})},"@VERSION@",{requires:["intl"]});
