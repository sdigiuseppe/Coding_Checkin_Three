YUI.add("confirmation-dialog-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.set("title",e.title?e.title:this.intlMessage({intlName:"common.CONFIRM"})),this.set("icon",e.icon?e.icon:!1),this.set("content",e.content?e.content:"A blurb about what this will do"),this.set("confirmButtonLabel",e.confirmButtonLabel?e.confirmButtonLabel:this.intlMessage({intlName:"common.OK"})),this.set("cancelButtonLabel",e.cancelButtonLabel?e.cancelButtonLabel:this.intlMessage({intlName:"common.CANCEL"})),this.set("auxiliaryButtonLabel",e.auxiliaryButtonLabel?e.auxiliaryButtonLabel:this.intlMessage({intlName:"common.CANCEL"})),this.set("confirmButtonClass",e.confirmButtonClass?e.confirmButtonClass:""),this.set("cancelButtonClass",e.cancelButtonClass?e.cancelButtonClass:""),this.set("auxiliaryButtonClass",e.auxiliaryButtonClass?e.auxiliaryClass:""),this.set("showConfirmButton",typeof e.showConfirmButton=="undefined"?!0:e.showConfirmButton),this.set("showCancelButton",typeof e.showCancelButton=="undefined"?!1:e.showCancelButton),this.set("showAuxiliaryButton",typeof e.showAuxiliaryButton=="undefined"?!1:e.showAuxiliaryButton),this.set("deletePhotoConfirmation",e.deletePhotoConfirmation?e.deletePhotoConfirmation:!1),this.set("imgSrc",e.imgSrc?e.imgSrc:""),this.set("organizrLink",e.organizrLink?e.organizrLink:!1),this.set("dialog",e.dialog),this},render:function(){return this.setContainerHTML(this.templates("confirmation-dialog")({title:this.get("title"),icon:this.get("icon"),heading:this.get("heading"),content:this.get("content"),confirmButtonLabel:this.get("confirmButtonLabel"),cancelButtonLabel:this.get("cancelButtonLabel"),auxiliaryButtonLabel:this.get("auxiliaryButtonLabel"),confirmButtonClass:this.get("confirmButtonClass"),cancelButtonClass:this.get("cancelButtonClass"),auxiliaryButtonClass:this.get("auxiliaryButtonClass"),deletePhotoConfirmation:this.get("deletePhotoConfirmation"),imgSrc:this.get("imgSrc"),organizrLink:this.get("organizrLink"),showConfirmButton:this.get("showConfirmButton"),showCancelButton:this.get("showCancelButton"),showAuxiliaryButton:this.get("showAuxiliaryButton")})),this},handleCancelClick:function(t){e.Views.dialog.close()},handleAuxiliaryClick:function(e){this.fire("auxiliaryClick")},activate:function(){var e=this,t=this.get("container").one(".ui-dialog-button-close");return this.get("showCancelButton")&&(this.get("container").one(".cancel-confirmation").on("click",function(t){e.handleCancelClick(t)}),this.get("container").one(".ui-dialog-button-cancel").on("click",function(t){e.handleCancelClick(t)})),this.get("showAuxiliaryButton")&&this.get("container").one(".auxiliary-confirmation").on("click",function(t){e.handleAuxiliaryClick(t)}),t&&t.on("click",function(t){e.handleCancelClick(t)}),this}})},"@VERSION@",{requires:["flickr-view","confirmation-dialog-css","hermes-template-confirmation-dialog"],optional:["set-models"],langBundles:["common","photo-page-scrappy"]});
YUI.add("hermes-lang-photo-page-scrappy",function(e,t){e.Intl.add("hermes/photo-page-scrappy","en-US",{PAGE_TITLE:["${title}"," | Flickr - Photo Sharing!"],BACK_TO:["Back to ","${entryType}"],COULDNT_UPDATE_SETTINGS:["We couldn't update your settings"],ADULT_CONTENT:["Adult Content"],MATURE_AUDIENCES:["This content is for mature audiences only."],USER_DISCRETION:["User discretion is advised."],SHOW_ME_THIS_CONTENT_TYPE:["Show Me This Content Type From Now On"],CHANGE_SAFE_SEARCH_IN_SETTINGS:['You can always change <a href="/account/prefs/safesearch/?from=privacy"  data-track="photoWellSafeSearchClick">SafeSearch settings</a> in your account preferences.'],SIGNED_IN_FOR_CONTENT:["You must be signed in to see this content."],VIDEO_COMING_SOON:["Video support coming soon"],FIND_OUT_MORE_AD:["Find out more at ","${brand}"],SHARE_THIS_PHOTO:["Share this photo"],DOWNLOAD_THIS_VIDEO:["Download this video"],DOWNLOAD_THIS_PHOTO:["Download this photo"],VIEW_ALL_SIZES:["View all sizes"],DOWNLOAD_PHOTO:["Download photo"],SOME_RIGHTS_RESERVED:["Some rights reserved"],DOWNLOAD:["Download"],ERROR_LOADING_CONTEXT:["Error loading context"],ADD_TITLE:["Add title"],ADD_DESCRIPTION:["Add description"],TITLE_DESCRIPTION_FAILURE:["We couldn't change the Title and Description at this time."],VIEW_PREVIOUS_COMMENT:["View previous comment"],VIEW_MORE_PREVIOUS_COMMENTS:["View ","${count}"," previous comments"],EMPTY_COMMENT_ERROR:["An empty comment box? That won't work!"],COMMENT_RATE_LIMIT_ERROR:["Slow down, partner! To protect the Flickr community against spam and spammy behavior we place a few restrictions on commenting."],COMMENT_POST_ERROR:["We couldn't post your comment."],MORE_COMMENTS_ERROR:["We couldn't get more comments."],COMMENT_PERMALINK_ERROR:["We were unable to find the specified comment on the photo."],DELETE_COMMENT:["Delete Comment"],COMMENT_DELETE_CONFIRMATION:["Are you sure you want to delete this comment?"],COMMENT_DELETE_ERROR:["We couldn't delete your comment."],COMMENT_LOADING_ERROR:["Error loading comments"],COMMENT:["Comment"],SHOW_MORE_COMMENTS:["${count}"," more"],REPLY:["Reply"],PERMALINK:["Permalink"],SINGLE_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAlias}",'/">',"${displayName}","</a> faved this"],DOUBLE_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAliasOne}",'/">',"${displayNameOne}",'</a> and <a class="faved-by-person-link" href="/photos/',"${pathAliasTwo}",'/">',"${displayNameTwo}","</a> faved this"],TRIPLE_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAliasOne}",'/">',"${displayNameOne}",'</a>, <a class="faved-by-person-link" href="/photos/',"${pathAliasTwo}",'/">',"${displayNameTwo}",'</a>, and <a class="faved-by-person-link" href="/photos/',"${pathAliasThree}",'/">',"${displayNameThree}","</a> faved this"],MULTI_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAliasOne}",'/">',"${displayNameOne}",'</a>, <a class="faved-by-person-link" href="/photos/',"${pathAliasTwo}",'/">',"${displayNameTwo}",'</a> and <a class="remaining-faved-by" href="#">',"${count}"," more people</a> faved this"],RELATIONSHIP_FRIEND_ERROR:["There was a problem setting your friend relationship."],RELATIONSHIP_FAMILY_ERROR:["There was a problem setting your family relationship."],HIDE_EXIF:["Hide EXIF"],SHOW_EXIF:["Show EXIF"],EDIT_LOCATION:["Edit Location"],EDIT_LOCATION_ORGANIZR:["We\u2019re hard at work redesigning our brand new photo experience. For now, you can Edit Location in Organizr."],APERTURE:["Aperture"],FOCAL_LENGTH:["Focal length"],EXPOSURE_TIME:["Exposure time"],FLASH_AUTO_FIRED:["Flash (auto, fired)"],FLASH_AUTO_NO_FIRE:["Flash (auto, did not fire)"],FLASH_ON_FIRED:["Flash (on, fired)"],FLASH_ON_NO_FIRE:["Flash (on, did not fire)"],FLASH_OFF:["Flash (off, did not fire)"],POWERED_BY:["POWERED BY"],FOURSQUARE:["FOURSQUARE"],ADD_PHOTO_TO_MAP:["Add this photo to your map"],SINGULAR_FAVE:["fave"],PLURAL_FAVE:["faves"],SINGULAR_VIEW:["view"],PLURAL_VIEW:["views"],SINGULAR_COMMENT:["comment"],PLURAL_COMMENT:["comments"],LICENSE_ERROR:["There was a problem changing your photo's license"],ALL_RIGHTS_RESERVED:["All rights reserved"],NO_RESTRICTIONS:["No known copyright restrictions"],USA_GOV_WORK:["United States government work"],SAFETY_CHANGE_ERROR:["There was an error while changing your photo's safety level"],PRIVACY_CHANGE_ERROR:["There was a problem changing your photo's privacy"],COMMENT_PERM_CHANGE_ERROR:["There was an error while changing your photo's commenting permission"],FLAG_PHOTO:["Flag Photo"],MARK_FOR_REVIEW:["Mark for review"],ADDITIONAL_INFO:["Additional info"],VIEWING_THIS_PHOTO:["Viewing this photo"],PRIVACY_UPDATE_ERROR:["There was an error while updating the privacy. Please try again."],COMMENT_PERMS_UPDATE_ERROR:["There was an error while updating commenting permission. Please try again."],COMMENTING_ON_THIS_PHOTO:["Commenting on this photo"],SAFETY_UPDATE_ERROR:["There was an error while updating the safety level. Please try again."],SAFETY_LEVEL_OF_PHOTO:["Safety level of this photo"],FLAG_ERROR:["There was an error trying to flag this photo. Please try again."],PROVIDE_FEEDBACK:["Provide feedback on the new photo page"],ERROR_DELETING_AUTOTAG:["Error deleting Autotag"],AUTOTAGS:["Autotags"],CONTACT_LIST_ERROR:["An error occurred while trying to fetch your contact list. Please try again."],FAILED_TO_REMOVE_PERSON:["Failed to remove that person from the photo at this time."],PERSON_CANNOT_BE_TAGGED:["This person cannot be tagged."],PEOPLE_IN_PHOTO:["People in photo"],ADD_PEOPLE:["Add people"],ADD_PERSON:["Add a person"],ERROR_REMOVING_FROM_GROUP:["There was a problem removing this photo from the group"],ERROR_ACCEPTING_INVITATION:["There was a problem accepting the group invitation"],SEARCH_GROUPS:["Search groups"],PHOTO_NOT_IN_GROUPS:["This photo is currently not in any groups"],ADD_TO_GROUP:["Add to group"],INVITE_TO_GROUP:["Invite to group"],ONE_GROUP_INVITATION:["You have 1 group invitation"],N_GROUP_INVITATIONS
:["You have ","${count}"," group invitations"],VIEW_MORE_GROUPS:["View more groups"],ERROR_REMOVING_FROM_ALBUM:["There was a problem removing this photo from the album"],WARNING_REMOVE_LAST_PHOTO_FROM_ALBUM:["You're about to remove the last photo from an album, which will also delete the album."],REMOVE_PHOTO_AND_ALBUM:["Remove photo and delete album"],ADD_PHOTO_TO_ALBUM:["Add this photo to an album"],SEARCH_ALBUMS:["Search albums"],ADD_TO_ALBUM:["Add to album"],PHOTO_NOT_IN_ALBUMS:["This photo is currently not in any albums"],VIEW_MORE_ALBUMS:["View more albums"],PHOTO_IN_ONE_ALBUM:["This photo is in 1 album"],PHOTO_IN_N_ALBUMS:["This photo is in ","${count}"," albums"],INVITE_PENDING:["Invite pending"],CANCEL_INVITE:["Cancel invite"],ACCEPT_INVITE:["Accept invite"],ONE_ITEM:["1 item"],N_ITEMS:["${count}"," items"],ERROR_REMOVING_FROM_GALLERY:["There was a problem removing this photo from the gallery"],SEARCH_GALLERIES:["Search galleries"],ADD_TO_GALLERY:["Add to gallery"],PHOTO_NOT_IN_GALLERIES:["This photo is currently not in any galleries"],VIEW_MORE_GALLERIES:["View more galleries"],PHOTO_IN_ONE_GALLERY:["This photo is in 1 gallery"],PHOTO_IN_N_GALLERIES:["This photo is in ","${count}"," galleries"],DELETE_PHOTO:["Delete Photo"],PERMANTENTLY_DELETE:["Do you want to permanently delete this photo?"],EDIT_PHOTO:["Edit photo"],NO_VIDEOS_IN_AVIARY:["Videos cannot be edited in Aviary"],ENHANCE_WITH_AVIARY:["Enhance with Aviary"],NO_VIDEO_ROTATION:["Videos cannot be rotated"],ROTATE:["Rotate"],NO_VIDEO_REPLACE:["Videos cannot be replaced"],REPLACE:["Replace"],PHOTO_NAVIGATION:["Photo navigation"],THUMBNAIL_NAVIGATION:["Thumbnail navigation"],ZOOM:["Zoom"],VIEW_IN_LIGHTBOX:["View in light box"],BACK_TO_CONTEXT:["Back to context"],ADD_TAG:["Add tag"],GO_TO_ORGANIZER:["Go to Organizr"],ALBUM:["album"],ALBUMS:["albums"],ERROR_LOADING_ALBUMS:["There was a problem loading your albums"],ERROR_ADDING_PHOTO_TO_ALBUM:["There was a problem adding this photo to the album"],ERROR_REMOVING_PHOTO_FROM_ALBUM:["There was a problem removing this photo from the album"],ERROR_LOADING_GROUPS:["There was a problem loading the groups you can add photos to"],ERROR_ADDING_TO_GROUP:["There was a problem adding this photo to the group"],ERROR_ADDING_TO_GROUP_NOT_OWNER:["Sorry, the photo couldn't be added to the group because you don't own the photo."],ERROR_ADDING_TO_GROUP_NOT_MEMBER:["Sorry, the photo couldn't be added to the group. You are not a member of the group."],ERROR_ADDING_TO_GROUP_ALREADY_IN_POOL:["The photo is already in that group pool."],ERROR_ADDING_TO_GROUP_MAX_POOLS:["Sorry, the photo couldn't be added to the group because it is already in the maximum number of group pools."],ERROR_ADDING_TO_GROUP_MAX_PHOTOS_FROM_USER:["Sorry, the photo couldn't be added to the group. You have already added the maximum number of photos to the pool."],ERROR_ADDING_TO_GROUP_ADDED_TO_QUEUE:["Your photo has been added to the pending queue for the group."],ERROR_ADDING_TO_GROUP_ALREADY_IN_QUEUE:["Your photo is already in the pending queue for the group."],ERROR_ADDING_TO_GROUP_INVALID_CONTENT:["Sorry, the photo couldn't be added to the group. For more information, check the group requirements for media type, content type, safety level, and geo location."],ERROR_ADDING_TO_GROUP_MAX_IN_POOL:["Sorry, the photo couldn't be added to the group. The group has the maximum number of photos allowed in a pool."],ERROR_INVITING_TO_GROUP:["There was a problem inviting this photo to the group"],ERROR_CANCELING_GROUP_INVITIATON:["There was a problem canceling this photo's invitation to the group"],NO_MATCHES:["No matches"],CREATE_NEW:["Create new"],ERROR_LOADING_GROUP_INVITATIONS:["There was a problem loading this photo's group invitations"],NO_GROUP_INVITATIONS:["No pending group invitations"],PENDING_INVITATIONS_FOR_PHOTO:["Pending invitations for this photo"],LOADING_INVITATIONS:["Loading invitations"],ERROR_LOADING_GALLERIES:["There was a problem loading your galleries"],ERROR_ADDING_TO_GALLERY:["There was a problem adding this photo to the gallery"],ERROR_PHOTO_NOT_ALLOWED_IN_GALLERY:["The owner of this photo does not allow the photo to be added to your gallery"],ERROR_CREATING_GALLERY:["There was a problem creating your new gallery"],DATE_TAKEN_FORMAT:["The taken date must be in the MM/DD/YYYY hh:mm:ss format."],DATE_POSTED_FUTURE:["The posted date cannot be in the future."],DATE_POSTED_FLICKR_JOIN:["Posted date must be after you joined Flickr."],ERROR_SAVING_DATE:["Error saving dates"],DATE_INVALID:["One or more dates are invalid"],EDIT_DATES:["Edit Dates"],DATE_TAKEN_ON:["Date Taken On"],DATE_POSTED_ON:["Date Posted On"],TAKEN_CIRCA:["Taken circa ","${intlDate}"],TAKEN_SOMETIME_IN:["Taken sometime in ","${intlDate}"],TAKEN_IN:["Taken in ","${intlDate}"],TAKEN_ON:["Taken on ",{type:"date",valueName:"intlDate",format:"long"}],UPLOADED_ON:["Uploaded on ","${intlDate}"],SOMETHING_WENT_WRONG:["Something went wrong."],REFRESH_BROWSER:["Please refresh your browser and try again."],TWITTER_NOT_FOUND:["Twitter account not found on posting"],TUMBLR_NOT_FOUND:["Tumblr account not found on posting"],LINK:["Link"],LINK_TO_VIDEO:["Link to this video:"],LINK_TO_PHOTO:["Link to this photo:"],NO_LINKS_FOR_RESTRICTED_VIDEO:["Links are not available for restricted videos"],PRIVATE_VIDEO_SHARE:["This is a private video, do you still want to share it?"],NO_LINKS_FOR_RESTRICTED_PHOTO:["Links are not available for restricted photos"],PRIVATE_PHOTO_SHARE:["This is a private photo, do you still want to share it?"],SHARING_RESTRICTED_VIDEO:["Sharing is restricted for this video"],SHARING_RESTRICTED_PHOTO:["Sharing is restricted for this photo"],EMBED:["Embed"],PUBLIC_TO_SHARE:["Please share this photo publicly to view embed code"],SIZE:["Size:"],TITLE_AND_OWNER_AT_START:["Display title and owner at start"],SHARE_NOW:["Share now!"],SHARE_PHOTO:["Share Photo"],SHARE_ON_TWITTER:["Share on Twitter"],AUTHORIZE_FOR_TWITTER:["please authorize Flickr to post on Twitter"
],SHARE_ON_TUMBLR:["Share on Tumblr"],PUBLISH_NOW:["Publish now"],ADD_TO_QUEUE:["Add to queue"],SAVE_AS_DRAFT:["Save as draft"],AUTHORIZE_FOR_TUMBLR:["please authorize Flickr to post on Tumblr"],SHARE_VIA_MAIL:["Share via mail"],SCREEN_NAME_OR_EMAIL:["Screen name or email"],SQUARE:["Square"],SMALL:["Small"],MEDIUM:["Medium"],LARGE:["Large"],ORIGINAL:["Original"],DUPLICATE_TAG:["Duplicate Tag"],INVALID_TAG:["Invalid Tag"],MAXIMUM_TAG_LIMIT:["Maximum tag limit (76) reached"],ERROR_ADDING_TAG:["Error adding tag"],ERROR_DELETING_TAG:["Error deleting tag"],TAGS:["Tags"],ADD_TAGS:["Add tags"],ADD_A_TAG:["Add a tag"],PHOTO_IN_ONE_GROUP:["This photo is in 1 group"],PHOTO_IN_MANY_GROUPS:["This photo is in ",{type:"number",valueName:"count"}," groups"],PHOTO_IN_NO_GROUPS:["This photo is not in any groups"],ADD_A_COMMENT:["Add a comment"],COMMENT_TUTORIAL:["press Enter to post and Shift+Enter for newline"],SIGNED_IN_TO_POST_A_COMMENT:["You must be signed in to post a comment"],SHARE:["Share"],CODE:["Code"],INCLUDE_A_MESSAGE:["Include a message"],FOR_MORE_INFORMATION_SAFESEARCH:['For more information please read <a href="//www.flickr.com/help/photos/?search=flag#145">this FAQ</a>.'],FLAG_CONFIRMATION_SAFE_WITHIN:['This photo is marked as <a href="//www.flickr.com/help/filters/#258">safe</a> and falls within your <a href="//www.flickr.com/account/prefs/safesearch/">SafeSearch settings</a>.'],FLAG_CONFIRMATION_SAFE_OUTSIDE:['This photo is marked as <a href="//www.flickr.com/help/filters/#258">safe</a> and falls outside your <a href="//www.flickr.com/account/prefs/safesearch/">SafeSearch settings</a>.'],FLAG_CONFIRMATION_MODERATE_WITHIN:['This photo is marked as <a href="//www.flickr.com/help/filters/#258">moderate</a> and falls within your <a href="//www.flickr.com/account/prefs/safesearch/">SafeSearch settings</a>.'],FLAG_CONFIRMATION_MODERATE_OUTSIDE:['This photo is marked as <a href="//www.flickr.com/help/filters/#258">moderate</a> and falls outside your <a href="//www.flickr.com/account/prefs/safesearch/">SafeSearch settings</a>.'],FLAG_CONFIRMATION_RESTRICTED_WITHIN:['This photo is marked as <a href="//www.flickr.com/help/filters/#258">restricted</a> and falls within your <a href="//www.flickr.com/account/prefs/safesearch/">SafeSearch settings</a>.'],FLAG_CONFIRMATION_RESTRICTED_OUTSIDE:['This photo is marked as <a href="//www.flickr.com/help/filters/#258">restricted</a> and falls outside your <a href="//www.flickr.com/account/prefs/safesearch/">SafeSearch settings</a>.'],PRIVATE_PHOTO:["Private photo"],PHOTO_UNFIT_FOR_YOUR_EYES:["Photo is unfit for your eyes. Have a kitten: (^._.^)\uff89"],NO_PHOTO_WITH_THAT_ID:["No photo found with id ","${photoId}"],NO_MEMBERS_FOUND:["No members found"],TAKEN_ON_INTL:["Taken on ",{type:"date",valueName:"intlDate",format:"long"}],UPLOADED_ON_INTL:["Uploaded on ",{type:"date",valueName:"intlDate",format:"long"}],TAKEN_IN_MONTH:["Taken in ",{type:"date",valueName:"intlDate",format:"monthYear"}],VIEW_IN_LIGHTBOX_SHORTCUT:["View in light box"],ZOOM_MAX_MESSAGE:["Whoa there, tiger! This photo is already at maximum size."],CLICK_TO_FAVE_PHOTO:["Click here to fave this photo"],CLICK_TO_FAVE_VIDEO:["Click here to fave this video"],BACK_TO_ACTIVITY_FEED:["Back to activity feed"],BACK_TO_PHOTOSTREAM:["Back to photostream"],BACK_TO_ALBUM:["Back to album"],BACK_TO_CONTACTS_LIST:["Back to contacts list"],BACK_TO_FAVORITES:["Back to favorites"],BACK_TO_GALLERY:["Back to gallery"],BACK_TO_PROFILE:["Back to profile"],BACK_TO_EXPLORE:["Back to explore"],BACK_TO_COMMONS:["Back to commons"],BACK_TO_GROUP:["Back to group"],BACK_TO_MAP:["Back to map"],BACK_TO_SEARCH:["Back to search"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-template-widget-fave",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){var r="",i;r+='\n        <a href="#" data-action="fave" ',i=n.unless.call(e,e.isOwner,{hash:{},inverse:a.noop,fn:a.program(2,h,t),data:t});if(i||i===0)r+=i;r+='>\n            <span class="fave-star ',i=n["if"].call(e,e.isFaved,{hash:{},inverse:a.noop,fn:a.program(7,v,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,e.isOwner,{hash:{},inverse:a.noop,fn:a.program(9,m,t),data:t});if(i||i===0)r+=i;return r+='"></span>\n            <span class="fave-counter">',(i=n.faveCount)?i=i.call(e,{hash:{},data:t}):(i=e.faveCount,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span>\n        </a>\n	",r}function h(e,t){var r="",i;r+='title="',i=n["if"].call(e,e.isFaved,{hash:{},inverse:a.program(5,d,t),fn:a.program(3,p,t),data:t});if(i||i===0)r+=i;return r+='"',r}function p(e,t){return"Remove this photo from your favorites?"}function d(e,t){return"Add this photo to your favorites?"}function v(e,t){return"is-faved"}function m(e,t){return"can-not-fave"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=this,f="function",l=this.escapeExpression;s+='<div class="ui-display-widget-fave">\n	',u=n["if"].call(t,(o=t.state,o==null||o===!1?o:o.activated),{hash:{},inverse:a.noop,fn:a.program(1,c,i),data:i});if(u||u===0)s+=u;return s+="\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/widget-fave",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("display-widget-fave",function(e){"use strict";var t,n=this.name,r=e.flutil;t=e.Base.create(n,e.Views["display-item"],[],{langBundles:this.details.langBundles,initializer:function(e){this.options=r.extend({templateName:"widget-fave"},e),this.set("photo",this.options.photo),this.processingFave=!1},initialize:function(){var e=this;this.appContext.getModel("photo-engagement-models",this.get("photo").id).then(function(t){e.set("photo-engagement",t),e.fire("activated"),e.render()})},toggleFave:function(t){var n=this,r=this.get("photo-engagement"),i=this.get("photo");t.halt(),r&&!this.processingFave&&(this.appContext.getViewer().signedIn?r.getValue("canFave")&&(this.processingFave=!0,r.registry.toggleFave(i.id),n.render(),r.remoteUpdate().then(function(){n.processingFave=!1},function(e){n.processingFave=!1,r.registry.toggleFave(i.id),n.render(),n.appContext.error(e.message)}),e.rapidTracker.beacon(this.name,"faveStarDisplayItemButtonClick")):this.promptTheUserToSignIn(i.id))},promptTheUserToSignIn:function(t){var n,r,i,s,o,u;i=this.intlMessage({intlName:"grease.YAY"}),s=this.intlMessage({intlName:"grease.JOIN_TO_FAVE_LINK",joinLink:"/signup/"}),u=this.intlMessage({intlName:"grease.SIGN_UP_TXT"}),o=this.intlMessage({intlName:"grease.SIGN_IN_TXT"}),n=new e.Views["confirmation-dialog-view"]({title:i,icon:"ui-icon-big-fave",content:s,confirmButtonClass:"ui-button-minimal",confirmButtonLabel:o,showAuxiliaryButton:!0,auxiliaryButtonLabel:u}),n.appContext=this.appContext,n.render(),n.activate(),n.on("auxiliaryClick",function(){window.location=e.url("/signup")}),r=e.Views.dialog.getNewInstance("dialog-modal",{content:n.get("container"),appContext:this.appContext}),r.show(),n.registerEventHandler(n.get("container").one(".ui-dialog-button-confirm").on("click",function(){r.close(),r.destroy(),e.SigninHelper.addPendingFave({id:t})}))},activate:function(){this.attachEvents({":fave":this.toggleFave})},render:function(){var e=this.get("photo-engagement"),t=e.getValue("faveCount");t?t>99?t="99+":t=t.toString():t="",this.buildContainer({faveCount:t,isFaved:e.getValue("isFaved"),isOwner:e.getValue("isOwner")})}}),e.namespace("Views")[n]=t},"@VERSION@",{requires:["flutil","display-item","dialog","signin-helper","confirmation-dialog-view","display-widget-fave-css","hermes-template-widget-fave","url"],langBundles:["grease"]});
YUI.add("hermes-lang-grease",function(e,t){e.Intl.add("hermes/grease","en-US",{JOIN_TO_FAVE:["You want to fave? Join Flickr!"],JOIN_TO_FAVE_LINK:['You want to fave? <a class="ui-join-link" data-action="follow" href="',"${joinLink}",'">Join Flickr!</a>'],JOIN_TO_COMMENT:["You want to comment? Join Flickr!"],JOIN_TO_COMMENT_LINK:['You want to comment? <a class="ui-join-link" data-action="follow" href="',"${joinLink}",'">Join Flickr!</a>'],JOIN_TO_EMAIL_STREAM:['You want to email this photostream? <a class="ui-join-link" data-action="follow" href="',"${joinLink}",'">Join Flickr!</a>'],JOIN_TO_SHARE_STREAM:['You want to share this photostream? <a class="ui-join-link" data-action="follow" href="',"${joinLink}",'">Join Flickr!</a>'],SIGN_IN_TO_COMMENT:["So you want to comment? Sign in and try again."],SIGN_IN_TO_FAVE:["So you want to fave? Sign in and try again."],SIGN_IN_TO_FAVE_BYE:["You must be signed in to fave. You will be redirected to signin now."],SIGN_IN_REQUIRED:["Sign in required"],OOPS:["Oops!"],YAY:["Yay!"],SIGN_UP:["Sign-up"],SIGN_IN:["Sign-in"],SIGN_UP_TXT:["Sign up"],SIGN_IN_TXT:["Sign in"],FORGET_IT:["Forget it"],NO:["No"],NO_THANKS:["No thanks"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-template-comment",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function d(e,t){var n="",r;return n+='\n			<img src="'+l((r=(r=(r=e.author,r==null||r===!1?r:r.buddyicon),r==null||r===!1?r:r["default"]),typeof r===f?r.apply(e):r))+'" width="25" height="25">\n		',n}function v(e,t){var n="",r;return n+='\n			<img src="'+l((r=(r=e.author,r==null||r===!1?r:r.buddyicon),typeof r===f?r.apply(e):r))+'" width="25" height="25">\n		',n}function m(e,t){var r="",i;r+="\n				",i=n["if"].call(e,e.commentBelongsToViewer,{hash:{},inverse:c.program(12,E,t),fn:c.program(6,g,t),data:t});if(i||i===0)r+=i;r+="\n				",i=n["if"].call(e,e.canCommentBeDeleted,{hash:{},inverse:c.noop,fn:c.program(20,C,t),data:t});if(i||i===0)r+=i;return r+='\n				<a href="',(i=n.permalink)?i=i.call(e,{hash:{},data:t}):(i=e.permalink,i=typeof i===f?i.apply(e):i),r+=l(i)+'" class="comment-permalink ui-icon-comment-permalink" data-track="commentPermalinkClick" data-action="follow"></a>\n			',r}function g(e,t){var r="",i;r+="\n					",i=n["if"].call(e,e.noIcons,{hash:{},inverse:c.program(9,b,t),fn:c.program(7,y,t),data:t});if(i||i===0)r+=i;return r+="\n				",r}function y(e,t){return"\n					"}function b(e,t){var r="",i;r+="\n						",i=n["if"].call(e,e.enabledEditableComments,{hash:{},inverse:c.noop,fn:c.program(10,w,t),data:t});if(i||i===0)r+=i;return r+="\n					",r}function w(e,t){var r="",i;return r+='\n							<a href="#" class="comment-edit ui-icon-comment-edit" data-id="',(i=n.id)?i=i.call(e,{hash:{},data:t}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-action="edit" title="Edit"></a>\n						',r}function E(e,t){var r="",i;r+="\n					",i=n["if"].call(e,e.canComment,{hash:{},inverse:c.noop,fn:c.program(13,S,t),data:t});if(i||i===0)r+=i;return r+="\n				",r}function S(e,t){var r="",i,s,o;r+='\n						<a href="#" class="comment-reply ',i=n["if"].call(e,e.noIcons,{hash:{},inverse:c.program(16,T,t),fn:c.program(14,x,t),data:t});if(i||i===0)r+=i;r+='" data-pathalias="'+l((i=(i=e.author,i==null||i===!1?i:i.pathAlias),typeof i===f?i.apply(e):i))+'" data-action="reply" title="Reply">',o={hash:{},inverse:c.noop,fn:c.program(18,N,t),data:t},(s=n.noIcons)?s=s.call(e,o):(s=e.noIcons,s=typeof s===f?s.apply(e):s),n.noIcons||(s=h.call(e,s,o));if(s||s===0)r+=s;return r+="</a>\n					",r}function x(e,t){var n="";return n}function T(e,t){return"ui-icon-comment-reply"}function N(e,t){return"Reply"}function C(e,t){var r="",i;return r+='\n					<a href="#" class="comment-delete ui-icon-comment-delete" data-id="',(i=n.id)?i=i.call(e,{hash:{},data:t}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-action="delete" title="Delete"></a>\n				',r}function k(e,t){var r="",i,s;return r+='\n        <div class="comment-content">',s={hash:{},data:t},r+=l((i=n.renderSafeInlineComment||e.renderSafeInlineComment,i?i.call(e,e.contentSecure,e.ellipsis,s):p.call(e,"renderSafeInlineComment",e.contentSecure,e.ellipsis,s)))+"</div>\n	",r}function L(e,t){var r="",i,s;return r+='\n        <div class="comment-content">',s={hash:{},data:t},r+=l((i=n.renderTrustedMarkupWithLineBreaks||e.renderTrustedMarkupWithLineBreaks,i?i.call(e,e.contentSecure,s):p.call(e,"renderTrustedMarkupWithLineBreaks",e.contentSecure,s)))+"</div>\n	",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.blockHelperMissing,p=n.helperMissing;s+='<li class="comment" id="',a={hash:{},data:i},s+=l((o=n.commentPermalinkId||t.commentPermalinkId,o?o.call(t,t.id,a):p.call(t,"commentPermalinkId",t.id,a)))+'">\n	<div class="comment-icon circle-icon">\n		<a data-person-nsid="'+l((o=(o=t.author,o==null||o===!1?o:o.nsid),typeof o===f?o.apply(t):o))+'" href="/photos/'+l((o=(o=t.author,o==null||o===!1?o:o.pathAlias),typeof o===f?o.apply(t):o))+'/" data-track="commentBuddyIconClick" data-action="follow">\n		',u=n["if"].call(t,(o=(o=t.author,o==null||o===!1?o:o.buddyicon),o==null||o===!1?o:o["default"]),{hash:{},inverse:c.program(3,v,i),fn:c.program(1,d,i),data:i});if(u||u===0)s+=u;s+='\n		</a>\n	</div>\n	<p class="comment-author">\n		<a href="/photos/'+l((o=(o=t.author,o==null||o===!1?o:o.pathAlias),typeof o===f?o.apply(t):o))+'/" data-track="commentUserNameClick" data-action="follow">\n			',a={hash:{},data:i},s+=l((o=n.truncate||t.truncate,o?o.call(t,(o=t.author,o==null||o===!1?o:o.displayname),20,a):p.call(t,"truncate",(o=t.author,o==null||o===!1?o:o.displayname),20,a)))+'\n		</a>\n		<span class="comment-actions">\n			',u=n["if"].call(t,t.isSignedIn,{hash:{},inverse:c.noop,fn:c.program(5,m,i),data:i});if(u||u===0)s+=u;s+='\n		</span>\n	</p>\n	<div class="comment-date">',(u=n.timeago)?u=u.call(t,{hash:{},data:i}):(u=t.timeago,u=typeof u===f?u.apply(t):u),s+=l(u)+"</div>\n	",u=n["if"].call(t,t.isTooltipComment,{hash:{},inverse:c.program(24,L,i),fn:c.program(22,k,i),data:i});if(u||u===0)s+=u;return s+="\n</li>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/comment",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-comments",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function u(e,t){var r="",i;r+="\n	<ul class='comments'>\n		",i=n.each.call(e,e.comments,{hash:{},inverse:o.noop,fn:o.program(2,a,t),data:t});if(i||i===0)r+=i;return r+="\n	</ul>\n",r}function a(e,t){var i="",s;i+="\n			",s=o.invokePartial(r.comment,"comment",e,n,r,t);if(s||s===0)i+=s;return i+="\n		",i}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=this.merge(r,e.partials),i=i||{};var s,o=this;return s=n["if"].call(t,t.comments,{hash:{},inverse:o.noop,fn:o.program(1,u,i),data:i}),s||s===0?s:""}),r={};e.Array.each(["comment"],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/comments",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-comment"]});
YUI.add("hermes-template-comment-form",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){var r="",i,s;r+='\n		<div class="comment-icon circle-icon">\n			',s=n["if"].call(e,(i=(i=e.user,i==null||i===!1?i:i.buddyicon),i==null||i===!1?i:i.medium),{hash:{},inverse:f.program(4,h,t),fn:f.program(2,c,t),data:t});if(s||s===0)r+=s;return r+='\n		</div>\n		<div class="comment-form-field">\n			<textarea class="new-comment-text" name="comment" placeholder="Add a comment" data-notutorial="Add a comment" data-tutorial="press Enter to post and Shift+Enter for newline" data-action="comment"></textarea>\n			<textarea class="false-comment-content"></textarea>\n		</div>\n	',r}function c(e,t){var n="",r;return n+='\n				<img src="'+a((r=(r=(r=e.user,r==null||r===!1?r:r.buddyicon),r==null||r===!1?r:r.medium),typeof r===u?r.apply(e):r))+'" width="25" height="25" />\n			',n}function h(e,t){var n="",r;return n+='\n				<img src="'+a((r=(r=(r=e.user,r==null||r===!1?r:r.buddyicon),r==null||r===!1?r:r["default"]),typeof r===u?r.apply(e):r))+'" width="25" height="25" />\n			',n}function p(e,t){return'\n		<div class="comment-form-field is-logged-out">\n			<a href="#"></a>\n			<textarea name="comment" disabled placeholder="You must be signed in to post a comment" data-action="comment"></textarea>\n		</div>\n	'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="comments-form">\n	',o=n["if"].call(t,t.user,{hash:{},inverse:f.program(6,p,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/comment-form",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-comments-view",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function f(e,t){return'\n	<div class=\'loadingError\'>\n		<p>Error loading comments</p>\n		<p><button href="#" class="ui-button ui-button-cta ui-button-transparent retry">Retry</button></p>\n	</div>\n'}function l(e,t){var r="",i;r+="\n	<div class='comments-holder order-",(i=n.commentsOrder)?i=i.call(e,{hash:{},data:t}):(i=e.commentsOrder,i=typeof i===o?i.apply(e):i),r+=u(i)+" ",(i=n.photosInCommentsClass)?i=i.call(e,{hash:{},data:t}):(i=e.photosInCommentsClass,i=typeof i===o?i.apply(e):i),r+=u(i)+"'>\n		",i=n["if"].call(e,e.commentsChronological,{hash:{},inverse:a.program(12,m,t),fn:a.program(4,c,t),data:t});if(i||i===0)r+=i;return r+="\n	</div>\n",r}function c(e,t){var i="",s;i+="\n			",s=n["if"].call(e,e.showMore,{hash:{},inverse:a.noop,fn:a.program(5,h,t),data:t});if(s||s===0)i+=s;i+="\n			",s=a.invokePartial(r.comments,"comments",e,n,r,t);if(s||s===0)i+=s;i+="\n			",s=n["if"].call(e,e.canComment,{hash:{},inverse:a.noop,fn:a.program(10,v,t),data:t});if(s||s===0)i+=s;return i+="\n		",i}function h(e,t){var r="",i;r+="\n				<div class='comments-more'>\n					<i class=\"ui-icon-comments\"></i>\n					",i=n["if"].call(e,e.isTooltipComments,{hash:{},inverse:a.program(8,d,t),fn:a.program(6,p,t),data:t});if(i||i===0)r+=i;return r+="\n				</div>\n			",r}function p(e,t){var r="",i;return r+='\n                        <a href="',(i=n.photoUrl)?i=i.call(e,{hash:{},data:t}):(i=e.photoUrl,i=typeof i===o?i.apply(e):i),r+=u(i)+'" data-action="follow" >',(i=n.showMoreString)?i=i.call(e,{hash:{},data:t}):(i=e.showMoreString,i=typeof i===o?i.apply(e):i),r+=u(i)+"</a>\n					",r}function d(e,t){var r="",i;return r+="\n                        <a href='#'>",(i=n.showMoreString)?i=i.call(e,{hash:{},data:t}):(i=e.showMoreString,i=typeof i===o?i.apply(e):i),r+=u(i)+"</a>\n					",r}function v(e,t){var i="",s;i+="\n				",s=a.invokePartial(r["comment-form"],"comment-form",e,n,r,t);if(s||s===0)i+=s;return i+="\n			",i}function m(e,t){var i="",s;i+="\n			",s=n["if"].call(e,e.canComment,{hash:{},inverse:a.noop,fn:a.program(10,v,t),data:t});if(s||s===0)i+=s;i+="\n			",s=a.invokePartial(r.comments,"comments",e,n,r,t);if(s||s===0)i+=s;i+="\n			",s=n["if"].call(e,e.showMore,{hash:{},inverse:a.noop,fn:a.program(13,g,t),data:t});if(s||s===0)i+=s;return i+="\n		",i}function g(e,t){var r="",i;return r+="\n				<div class='comments-more'><a href='#'>",(i=n.showMoreCount)?i=i.call(e,{hash:{},data:t}):(i=e.showMoreCount,i=typeof i===o?i.apply(e):i),r+=u(i)+" more</a></div>\n			",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=this.merge(r,e.partials),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n["if"].call(t,t.loadingError,{hash:{},inverse:a.program(3,l,i),fn:a.program(1,f,i),data:i}),s||s===0?s:""}),r={};e.Array.each(["comments","comment-form","comment-form","comments"],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/comments-view",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-comments","hermes-template-comment-form","hermes-template-comment-form","hermes-template-comments"]});
YUI.add("flickr-photos-comments-addComment-creator",function(e){"use strict";function t(e){var t={extras:"icon_urls"};return t.photo_id=e.photoId,t.comment_text=e.commentText,t.expand_bbml=!0,t.use_text_for_links=1,t.secure_image_embeds=1,e.photosInCommentsEnabled&&(t.bbml_need_all_photo_sizes=!0,t.primary_photo_longest_dimension=240),t}function n(t){var n=t[0],r=t[1],i=t[2],s={id:n.comment.author,username:n.comment.authorname,pathAlias:n.comment.pathAlias,realname:n.comment.realname,buddyicon:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(n.comment.iconurls),isPro:n.comment.ispro,isAdFree:n.comment.isAdFree},o=r.exists(n.comment.author)?r.proxy(n.comment.author):r.add(s);return i.add({id:n.comment.id,author:o,date:n.comment.datecreate,permalink:n.comment.permalink,content:n.comment.content,contentRaw:n.comment.rawComment.content,contentSecure:n.comment.secureComment.content})}function r(t,n){var r=this;return e.batch(n.callAPI("flickr.photos.comments.addComment",this._processParams(t)),n.getModelRegistry("person-models"),n.getModelRegistry("comment-models")).then(r._processResponse,function(e){throw n[e.fatal?"error":"debug"]("[flickr-photos-comments-addComment-creator] failed getting or processing API response:",e),e})}e.namespace("ModelCreators")["flickr-photos-comments-addComment"]={run:r,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("flickr-photos-comments-editComment-updater",function(e){"use strict";function t(e){var t={extras:"icon_urls"};return t.comment_id=e.commentId,t.comment_text=e.content,t.expand_bbml=!0,t.full_result=1,t.use_text_for_links=1,t.secure_image_embeds=1,e.photosInCommentsEnabled&&(t.bbml_need_all_photo_sizes=!0,t.primary_photo_longest_dimension=240),t}function n(e){var t=e[0],n=e[1];return n.setValues({content:t.comment.content,contentRaw:t.comment.rawComment.content,contentSecure:t.comment.secureComment.content}),n}function r(t,n){var r=this;return e.batch(n.callAPI("flickr.photos.comments.editComment",this._processParams(t)),n.getModel("comment-models",t.commentId)).then(r._processResponse,function(e){throw n[e.fatal?"error":"debug"]("[flickr-photos-comments-editComment-updater] failed getting or processing API response:",e),e})}e.namespace("ModelUpdaters")["flickr-photos-comments-editComment"]={run:r,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("flickr-photos-comments-deleteComment-deletor",function(e){"use strict";function t(e,t){var n={};return n.comment_id=e,t.callAPI("flickr.photos.comments.deleteComment",n).then(null,function(e){throw t[e.fatal?"error":"debug"]("[flickr-photos-comments-deleteComment-deletor] failed getting or processing API response:",e),e})}e.namespace("ModelDeletors")["flickr-photos-comments-deleteComment"]={run:t}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("comment-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{create:function(t){return e.ModelCreators["flickr-photos-comments-addComment"].run(t,this.appContext)},update:function(t,n){return e.ModelUpdaters["flickr-photos-comments-editComment"].run({commentId:t,content:n.content.newVal,photosInCommentsEnabled:this.appContext.flipper.isFlipped("photos-in-comments")},this.appContext)},"delete":function(t){return e.ModelDeletors["flickr-photos-comments-deleteComment"].run(t,this.appContext)}},attributes:{author:{isModel:!0},date:{},timeago:{readOnly:!0,derivedBy:["date"],getter:function(t,n){return e.moment.unix(this.getValue(n,"date")).fromNow()}},permalink:{},content:{},contentSecure:{},contentRaw:{}}})},"@VERSION@",{requires:["flickr-model-registry","moment","flickr-photos-comments-addComment-creator","flickr-photos-comments-editComment-updater","flickr-photos-comments-deleteComment-deletor"]});
YUI.add("photo-comments-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{comments:{isListProxy:!0,rangeFetch:{listFetcher:e.ListFetchers["flickr-photos-comments-getList"]}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-comments-getList-fetcher"]});
YUI.add("flickr-photos-comments-getList-fetcher",function(e){"use strict";function t(e){var t={photo_id:e.id,offset:e.offset||0,limit:e.limit||4,sort:e.sort||"date-posted-desc",extras:"icon_urls",expand_bbml:!0,use_text_for_links:1,secure_image_embeds:1};return e.photosInCommentsEnabled&&(t.bbml_need_all_photo_sizes=!0,t.primary_photo_longest_dimension=240),t}function n(t){var n=t[0],r=t[1],i=t[2],s=t[3],o=[],u=typeof n.comments.comment=="undefined"?0:n.comments.comment.length,a,f,l,c,h;return u>0&&e.Array.each(n.comments.comment,function(t,n,r){a={id:t.author,username:t.authorname,realname:t.realname,pathAlias:t.pathAlias,buddyicon:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(t.iconurls),isAdFree:t.isAdFree,isPro:t.ispro},a.pathAlias=t.pathAlias,l=s.exists(t.author)?s.proxy(t.author):s.add(a),f={id:t.id,author:l,date:t.datecreate,permalink:t.permalink,content:t.content,contentRaw:t.rawComment.content,contentSecure:t.secureComment.content},o.push(i.exists(t.id)?i.proxy(t.id):i.add(f))}),r.exists(n.comments.photoId)?(c=r.proxy(n.comments.photoId).getValue("comments").getList(),h=c.concat(o),r.proxy(n.comments.photoId).setValue("comments",h)):r.add({id:n.comments.photoId,comments:o}),o}function r(t,n){var r=this;return e.batch(n.callAPI("flickr.photos.comments.getList",this._processParams(t)),n.getModelRegistry("photo-comments-models"),n.getModelRegistry("comment-models"),n.getModelRegistry("person-models")).then(r._processResponse,function(e){throw n[e.fatal?"error":"debug"]("[flickr-photos-comments-getList-fetcher] failed getting or processing API response:",e),e})}e.namespace("ListFetchers")["flickr-photos-comments-getList"]={run:r,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise"],optional:["photo-comments-models","comment-models","person-models"]});
YUI.add("comments-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.photoId=e.photoId,this.appContext.flipper.isFlipped("comments-chronological")?(this.initiallyShowingMaximum=e.initiallyShowingMaximum?e.initiallyShowingMaximum:3,this.showMoreMaximum=e.showMoreMaximum?e.showMoreMaximum:200):(this.initiallyShowingMaximum=e.initiallyShowingMaximum?e.initiallyShowingMaximum:4,this.showMoreMaximum=e.showMoreMaximum?e.showMoreMaximum:10),this.isTooltipComments=e.isTooltipComments?!0:!1,this.currentlyShowingCount=0,this.initiallyShowingCount=0,this.textAreaMaxHeight=180,this.textAreaMinHeight=35,this.textAreaUserSetHeight=this.textAreaMinHeight,this.noIcons=e.noIcons,this.postingComment=!1,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var t=this,n=[];return n.push(this.appContext.getModelRegistry("comment-models").then(function(e){t.commentModelsRegistry=e})),n.push(this.appContext.getModel("photo-engagement-models",this.photoId).then(function(n){t.photoEngagement=n;var r=t.photoEngagement.getValue("commentCount"),i=e.config.win.location.hash,s=/#comment{1}/g;i&&s.test(i)?(t.initiallyShowingCount=r,t.currentlyShowingCount=r):r>=t.initiallyShowingMaximum?(t.initiallyShowingCount=t.initiallyShowingMaximum,t.currentlyShowingCount=t.initiallyShowingMaximum):(t.initiallyShowingCount=r,t.currentlyShowingCount=r)}).then(function(){return t.appContext.getModel("photo-comments-models",t.photoId)}).then(function(e){t.photoComments=e;if(t.photoEngagement.getValue("commentCount")>0)return t.photoComments.getValue("comments").getRange({offset:0,limit:t.initiallyShowingCount,photosInCommentsEnabled:t.appContext.flipper.isFlipped("photos-in-comments")}).then(function(e){t.set("comments",e)});t.set("comments",[])})),n.push(this.appContext.getModel("photo-models",this.photoId).then(function(e){t.photoModel=e})),this.appContext.getViewer().signedIn&&n.push(t.appContext.getModel("person-models",t.appContext.getViewer().nsid).then(function(e){t.person=e})),e.batch.apply(null,n)},buildContainer:function(){var t,n=this.photoModel.getValue("url"),r=this.person?this.person.toJSON():null,i=this.get("comments"),s=this.appContext.flipper.isFlipped("comments-chronological")?"chronological":"reverse-chronological",o=this.calculateShowMoreCount(),u=o===1?"1 more comment":o+" more comments",a,f=e.config.win.location.hash,l=/#comment{1}/g;this.appContext.flipper.isFlipped("comments-chronological")&&(i=i.reverse()),this.isTooltipComments&&(this.ellipsis=this.intlMessage({intlName:"comments.SEE_MORE_LINK",photoUrl:n}));for(a=0;a<i.length;a++)i[a]=i[a].toJSON?i[a].toJSON():i[a],i[a].isSignedIn=this.appContext.getViewer().signedIn,i[a].isLoggedInUsersPhoto=this.isLoggedInUsersPhoto(),i[a].canCommentBeDeleted=this.canCommentBeDeleted(i[a].author.nsid),i[a].commentBelongsToViewer=this.commentBelongsToViewer(i[a].author.nsid),i[a].enabledEditableComments=this.appContext.flipper.isFlipped("enable-editable-comments"),i[a].canComment=this.photoModel.getValue("canComment"),i[a].isTooltipComment=this.isTooltipComments,i[a].ellipsis=this.ellipsis,i[a].noIcons=this.noIcons;return t=this.templates("comments-view")({user:r,comments:i,showMore:this.calculateShowMoreCount()>0?!0:!1,showMoreCount:this.calculateShowMoreCount(),showMoreString:u,canComment:this.photoModel.getValue("canComment"),tutorialMode:!0,isTooltipComments:this.isTooltipComments,photoUrl:n,commentsOrder:s,commentsChronological:this.appContext.flipper.isFlipped("comments-chronological"),photosInCommentsClass:this.appContext.flipper.isFlipped("photos-in-comments")?"photosInComments":""}),this.setContainerHTML(t),this.retinafyCommentImages(),f&&l.test(f)&&this.jumpToPermalinkedComment(),this},buildErrorContainer:function(){this.setContainerHTML(this.templates("comments-view")({loadingError:!0}))},activate:function(){var t=this,n=t.get("container").one(".new-comment-text");return t.get("container").one(".comments-more")&&t.registerEventHandler(t.get("container").one(".comments-more a").on("click",t.handleMoreCommentsClick.bind(t))),e.use("transition",function(e){t.attachEvents({"keydown:comment":t.handleCommentKeyDown.bind(t),"blur:comment":t.handleCommentBlur.bind(t),"focus:comment":t.handleCommentFocus.bind(t),"mouseup:comment":t.handleCommentMouseUp.bind(t),"mouseleave:comment":t.handleCommentMouseLeave.bind(t),"mousedown:comment":t.handleCommentMouseDown.bind(t),".comment-reply click:reply":t.handleReplyClick.bind(t),".comment-delete click:delete":t.handleDeleteClick.bind(t),".comment-edit click:edit":t.handleEditClick.bind(t)})}),n&&n.setStyles({minHeight:this.textAreaMinHeight+"px",maxHeight:this.textAreaMaxHeight+"px"}),this},postComment:function(t){var n=this,r,i,s,o,u=this.photoEngagement.getValue("commentCount");n.fire("addingNewComment");if(e.Lang.trim(t)===""){this.onError("An empty comment box? That won't work!"),this.postingComment=!1;return}e.rapidTracker.beacon(this.name,"commentPosted"),this.commentModelsRegistry.remoteCreate({photoId:this.photoId,commentText:t,photosInCommentsEnabled:this.appContext.flipper.isFlipped("photos-in-comments")}).then(function(t){i=t.toJSON(),i.isSignedIn=n.appContext.getViewer().signedIn,i.isLoggedInUsersPhoto=n.isLoggedInUsersPhoto(),i.enabledEditableComments=this.appContext.flipper.isFlipped("enable-editable-comments"),i.canCommentBeDeleted=!0,i.commentBelongsToViewer=!0,i.canComment=!0,n.get("container").one(".new-comment-text").set("value","").setStyle("height",n.textAreaMinHeight+"px"),r=e.Node.create(n.templates("comment")(i)).setStyle("opacity","0.1"),u>0?n.appContext.flipper.isFlipped("comments-chronological")?n.get("container").one(".comments").append(r).one("li:last-child").transition({easing:"ease-in",duration:.5,opacity:"1"}):n.get("container").one(".comments").prepend(r).one("li:first-child").transition({easing:"ease-in",duration:.5,opacity:"1"}):(n.appContext.flipper.isFlipped("comments-chronological"
)?n.get("container").one(".comments-holder").prepend("<ul class='comments'></ul>"):n.get("container").one(".comments-holder").append("<ul class='comments'></ul>"),n.get("container").one(".comments").append(r).one("li:first-child").transition({easing:"ease-in",duration:.5,opacity:"1"})),n.retinafyCommentImages(),s=n.photoComments.getValue("comments").prependToList(t),o=n.photoEngagement.getValue("commentCount")+1,n.photoEngagement.setValue("commentCount",o),n.currentlyShowingCount++,n.fire("newCommentAdded"),n.postingComment=!1},function(e){e.code===409?n.onError("Slow down, partner! To protect the Flickr community against spam and spammy behavior we place a few restrictions on commenting."):e.code===8?n.onError("An empty comment box? That won't work!"):n.onError("We couldn't post your comment."),n.postingComment=!1}).then(null,function(e){n.appContext.error(e.message),n.appContext.error(e.stack)})},handleMoreCommentsClick:function(e){e.preventDefault();var t=this,n=this.get("container"),r="",i=n.one(".comments-more"),s;i.one("a").set("text","Loading"),i.addClass("is-loading"),this.appContext.getModel("photo-comments-models",this.photoId).then(function(e){e.getValue("comments").getRange({offset:t.currentlyShowingCount,limit:t.calculateShowMoreCount(),photosInCommentsEnabled:t.appContext.flipper.isFlipped("photos-in-comments")}).then(function(e){var o;t.appContext.flipper.isFlipped("comments-chronological")&&(e=e.reverse());for(o=0;o<e.length;o++)s=e[o].toJSON(),s.isSignedIn=t.appContext.getViewer().signedIn,s.isLoggedInUsersPhoto=t.isLoggedInUsersPhoto(),s.canCommentBeDeleted=t.canCommentBeDeleted(s.author.nsid),s.commentBelongsToViewer=t.commentBelongsToViewer(s.author.nsid),s.enabledEditableComments=t.appContext.flipper.isFlipped("enable-editable-comments"),s.canComment=t.photoModel.getValue("canComment"),r+=t.templates("comment")(s);t.appContext.flipper.isFlipped("comments-chronological")?n.one(".comments").prepend(r):n.one(".comments").append(r),t.retinafyCommentImages(),t.currentlyShowingCount=t.currentlyShowingCount+e.length,t.calculateShowMoreCount()>0?(i.one("a").set("text",t.calculateShowMoreCount()+" more"),i.removeClass("is-loading")):i.remove()},function(e){t.onError("We couldn't get more comments.")}).then(null,function(e){t.appContext.error(e.message),t.appContext.error(e.stack)})})},calculateShowMoreCount:function(){var e=this.photoEngagement.getValue("commentCount");return e>this.currentlyShowingCount+this.showMoreMaximum?this.showMoreMaximum:e<=this.currentlyShowingCount+this.showMoreMaximum?e-this.currentlyShowingCount:0},isLoggedInUsersPhoto:function(){return this.photoModel.getValue("owner").getValue("nsid")===this.appContext.getViewer().nsid},canCommentBeDeleted:function(e){return e===this.appContext.getViewer().nsid||this.isLoggedInUsersPhoto()?!0:!1},commentBelongsToViewer:function(e){return e===this.appContext.getViewer().nsid?!0:!1},jumpToPermalinkedComment:function(){var t=e.config.win.location.hash,n=this.get("container"),r,i=this,s;r=n.one(t),r?(r.scrollIntoView(!0),r.addClass("permalinked-comment")):i.fire("viewEvent","getDialogOffset",function(t){s=e.Views.dialog.getNewInstance("dialog-alert",{content:"We were unable to find the specified comment in the Photo.",attrs:{title:"Oops!",level:"warning",confirmLabel:"OK"},parent:i,offsetLeft:t}),s.show()})},retinafyCommentImages:function(){if(this.appContext.getCookie("density")>1){var t=e.all(".comments li .comment-content a[data-photo-size-m]");t.each(function(e){e.one("img").setAttribute("src",e.getAttribute("data-photo-size-m")),e.removeAttribute("data-photo-size-m")})}},handleCommentKeyDown:function(e){var t=this,n=this.get("container").one(".new-comment-text"),r=n.get("value"),i=this.get("container").one(".false-comment-content"),s;if(e.charCode===13&&!e.altKey&&!e.shiftKey&&!this.postingComment){this.textAreaUserSetHeight=this.textAreaMinHeight,e.preventDefault(),this.postingComment=!0,this.postComment(r);return}setTimeout(function(){i.set("value",n.get("value")),s=i._node.scrollHeight<t.textAreaMinHeight?t.textAreaMinHeight:i._node.scrollHeight,s=i._node.scrollHeight>t.textAreaMaxHeight?t.textAreaMaxHeight:s,s=t.textAreaUserSetHeight>i._node.scrollHeight?t.textAreaUserSetHeight:s,n.setStyle("height",s+"px")},10)},handleCommentMouseDown:function(e){var t=this.get("container").one(".new-comment-text"),n=0;t&&(n=t.getComputedStyle("height"),isNaN(n)||(this.textAreaUserSetHeight=this.textAreaUserSetHeight!==n?n:this.textAreaUserSetHeight))},handleCommentMouseUp:function(e){var t=this.get("container").one(".new-comment-text"),n=0;t&&(n=parseInt(t.getComputedStyle("height"),10),!isNaN(n)&&this.textAreaUserSetHeight!==n&&(this.textAreaUserSetHeight=n>this.textAreaMaxHeight?this.textAreaMaxHeight:n,t.setStyle("height",this.textAreaUserSetHeight+"px")))},handleCommentMouseLeave:function(t){e.config.win.clearTimeout(this.textAreaUserMouseLeave),this.textAreaUserMouseLeave=setTimeout(e.bind(function(){var e=this.get("container").one(".new-comment-text"),t=0;e&&(t=parseInt(e.getComputedStyle("height"),10),isNaN(t)||(this.textAreaUserSetHeight=t<this.textAreaMinHeight?this.textAreaMinHeight:t,this.textAreaUserSetHeight=t>this.textAreaMaxHeight?this.textAreaMaxHeight:t))},this),100)},handleCommentBlur:function(e){var t=this.get("container").one("textarea");t.getData("notutorial")&&t.set("placeholder",t.getData("notutorial"))},handleCommentFocus:function(e){var t=this.get("container").one("textarea");t.getData("tutorial")&&t.set("placeholder",t.getData("tutorial"))},handleReplyClick:function(t){t.preventDefault();var n=this.get("container").one("textarea"),r=n.get("value"),i="",s=n.getDOMNode(),o;r.length>0&&(i+=r+" "),i+="["+e.url("/photos/"+t.target.getAttribute("data-pathalias"))+"] ",s.setSelectionRange?(s.focus(),s.setSelectionRange(s.value.length,s.value.length)):s.createTextRange&&(o=s.createTextRange(),o.collapse(!0),o.moveEnd("character",s.value.length),o.moveStart("character",s.value.length),o.select()),n.focus()
,n.set("value",i),s.scrollTop=s.scrollHeight},handleEditClick:function(t){t.preventDefault();var n=this,r=t.target.ancestor(".comment"),i=t.target.getAttribute("data-id"),s,o,u,a=this.get("container").one(".false-comment-content"),f;if(r.one("textarea")){r.one("textarea").remove(),r.one(".comment-content").show();return}n.appContext.getModel("comment-models",i).then(function(t){r.one(".comment-content").hide(),n.appContext.flipper.isFlipped("photos-in-comments")?r.append("<textarea>"+t.getValue("contentRaw")+"</textarea>"):r.append("<textarea>"+t.getValue("content")+"</textarea>"),s=r.one("textarea"),a.set("value",s.get("value")),f=a._node.scrollHeight<n.textAreaMinHeight?n.textAreaMinHeight:a._node.scrollHeight,f=a._node.scrollHeight>n.textAreaMaxHeight?n.textAreaMaxHeight:f,s.setStyle("height",f+"px"),s.select(),s.on("keydown",function(l){setTimeout(function(){a.set("value",s.get("value")),f=a._node.scrollHeight<n.textAreaMinHeight?n.textAreaMinHeight:a._node.scrollHeight,f=a._node.scrollHeight>n.textAreaMaxHeight?n.textAreaMaxHeight:f,s.setStyle("height",f+"px")},10);if(l.charCode===13&&!l.altKey&&!l.shiftKey&&!n.postingEditedComment){l.preventDefault();if(e.Lang.trim(s.get("value"))===""){n.onError("An empty comment box? That won't work!");return}n.postingEditedComment=!0,t.setValues({content:s.get("value")}),n.appContext.modelRegistries["comment-models"].remoteUpdate(i).then(function(i){i?u=i.toJSON():u=t.toJSON(),u.isSignedIn=n.appContext.getViewer().signedIn,u.isLoggedInUsersPhoto=n.isLoggedInUsersPhoto(),u.enabledEditableComments=n.appContext.flipper.isFlipped("enable-editable-comments"),u.canCommentBeDeleted=!0,u.commentBelongsToViewer=!0,u.canComment=n.photoModel.getValue("canComment"),u.isTooltipComment=n.isTooltipComments,u.ellipsis=n.ellipsis,o=e.Node.create(n.templates("comment")(u)),r.replace(o),n.fire("commentEdited"),n.postingEditedComment=!1},function(e){n.postingEditedComment=!1,t.revertValue("content"),n.onError(e.message)})}})})},handleDeleteClick:function(t){t.preventDefault();var n=this,r,i,s=t.target.ancestor(".comment"),o=t.target.getAttribute("data-id"),u;r=new e.Views["confirmation-dialog-view"]({photoID:this.photoId,appContext:this.appContext,title:"Delete Comment",icon:"ui-icon-modal-warning",content:"Are you sure you want to delete this comment?",confirmButtonLabel:"Delete"}),r.render(),r.activate(),i=r.get("container"),r.registerEventHandler(i.one(".ui-dialog-button-confirm").on("click",function(){n.commentingDialog.close(),n.commentingDialog.destroy(),n.appContext.modelRegistries["comment-models"].remoteDelete(o).then(function(){n.photoComments.getValue("comments").removeFromList(o),u=n.photoEngagement.getValue("commentCount")-1,n.photoEngagement.setValue("commentCount",u),n.currentlyShowingCount--,n.fire("commentDeleted"),s.transition({easing:"ease-out",duration:.5,opacity:"0"},function(){s.remove(),u===0&&n.get("container").one(".comments").remove()})},function(e){n.onError("We couldn't delete your comment.")}).then(null,function(e){n.appContext.error(e.message),n.appContext.error(e.stack)})})),this.fire("subviewViewEvent","getDialogOffset",function(t){n.commentingDialog=e.Views.dialog.getNewInstance("dialog-modal",{content:r.get("container"),appContext:n.appContext,offsetLeft:t}),n.commentingDialog.show()})},onError:function(t){var n=this;this.fire("subviewViewEvent","getDialogOffset",function(r){var i=e.Views.dialog.getNewInstance("dialog-alert",{content:t,attrs:{title:"Error",level:"warning",confirmLabel:"OK"},parent:n,offsetLeft:r});i.show()})}})},"@VERSION@",{requires:["dialog","flickr-view","moment","comments-css","hermes-template-comments","hermes-template-comment","hermes-template-comments-view","url"],langBundles:["comments"],optional:["photo-comments-models"]});
YUI.add("hermes-lang-comments",function(e,t){e.Intl.add("hermes/comments","en-US",{LOADING:["Loading"],MORE:["more"],ERROR_LOADING_COMMENTS:["Error loading comments"],COULDNT_POST_COMMENT:["We couldn't post your comment"],COULDNT_GET_MORE_COMMENTS:["We couldn't get more comments"],CONFIRM_DELETE:["Confirm Delete"],YES_CONFIRM_DELETE:["Yes, Delete It"],ARE_YOU_SURE_DELETE:["Are you sure you want to delete this comment?"],COULDNT_DELETE_COMMENT:["We couldn't delete your comment"],ERROR:["Error!"],NO_COMMENTS:["No comments"],ADD_A_COMMENT:["Add a comment"],MUST_BE_LOGGED_IN_TO_COMMENT:["You must be logged in to post a comment"],LOADING_COMMENTS:["Loading comments..."],SEE_MORE:["See more"],SEE_MORE_LINK:['... <a href="',"${photoUrl}",'">Read more</a>']})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-template-widget-comment",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="ui-display-widget-comment">\n	<span class="ui-link" data-action="getcomments">\n		<span class="ui-icon-comments"></span>\n		<span class="comment-counter">',(o=n.commentCount)?o=o.call(t,{hash:{},data:i}):(o=t.commentCount,o=typeof o===u?o.apply(t):o),s+=a(o)+"</span>\n	</span>\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/widget-comment",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("display-widget-comment",function(e){"use strict";var t,n=this.name,r=e.flutil;t=e.Base.create(n,e.Views["display-item"],[],{langBundles:this.details.langBundles,initializer:function(t){this.options=r.extend({templateName:"widget-comment"},t),this.set("photo",this.options.photo),this.CommentsView=e.namespace("Views")["comments-view"]},initialize:function(){var e=this;this.appContext.getModel("photo-engagement-models",this.get("photo").id).then(function(t){e.set("photo-engagement",t),e.fire("activated"),e.render()})},showCommentDialog:function(t){var n=this,r=this.get("photo"),i=new this.CommentsView({appContext:this.appContext,isTooltipComments:!0,photoId:r.id,noIcons:!0}),s,o;t.preventDefault(),this.appContext.getViewer().signedIn?(this.target=this.target||t.target.hasClass("ui-link")?t.target:t.target.ancestor(".ui-link"),this.target&&(e.rapidTracker.beacon(this.name,"commentDisplayItemButtonClick"),this.target.addClass("ui-state-fetching"),i.initialize().then(function(t){s=n.target.ancestor(".ui-display-wrapper"),o=e.Views.dialog.getInstance("dialog-tooltip",{content:i.get("container"),appendCurtainTo:n.get("container").ancestor(".ui-display-wrapper").get("parentNode"),anchorTo:n.target,positioning:!0,constraints:{top:90},parent:n,arrow:!0,id:n.getId()}),n.setEnvironmentToShowInlineComment(s,o),o.on("hide",function(){n.cleanEnvironmentAfterShowingInlineComment(s)}),n.convertCommentsIntoInlineComments(i),i.on("addingNewComment",function(){e.Views.dialog.close(),n.target.addClass("ui-state-fetching")}),i.on("newCommentAdded",function(){n.target.removeClass("ui-state-fetching"),n.updateCounter(),n.convertCommentsIntoInlineComments(i)}),i.on("commentEdited",function(){n.convertCommentsIntoInlineComments(i)}),i.on("commentDeleted",function(){n.updateCounter()}),o.show(),i.render(),n.target.removeClass("ui-state-fetching"),i.activate()}))):n.promptTheUserToSignIn(r.id)},promptTheUserToSignIn:function(t){var n,r,i,s,o,u;i=this.intlMessage({intlName:"grease.YAY"}),s=this.intlMessage({intlName:"grease.JOIN_TO_COMMENT_LINK",joinLink:"/signup/"}),u=this.intlMessage({intlName:"grease.SIGN_UP_TXT"}),o=this.intlMessage({intlName:"grease.SIGN_IN_TXT"}),n=new e.Views["confirmation-dialog-view"]({title:i,icon:"ui-icon-big-comment",content:s,confirmButtonClass:"ui-button-minimal",confirmButtonLabel:o,showAuxiliaryButton:!0,auxiliaryButtonLabel:u}),n.appContext=this.appContext,n.render(),n.activate(),n.on("auxiliaryClick",function(){window.location=e.url("/signup")}),r=e.Views.dialog.getNewInstance("dialog-modal",{content:n.get("container"),appContext:this.appContext}),r.show(),n.registerEventHandler(n.get("container").one(".ui-dialog-button-confirm").on("click",function(){r.close(),r.destroy(),e.SigninHelper.addPendingComment({id:t})}))},updateCounter:function(){this.render()},convertCommentsIntoInlineComments:function(e){var t=e.get("container");t.all(".comment-content a").each(function(e){e.setAttribute("data-action","follow")}),t.all(".comment-content img").each(function(e){e.remove()})},setEnvironmentToShowInlineComment:function(e,t){var n=e.one(".ui-display-shield");e.addClass("ui-state-inline-commenting"),this.shieldClickSubscription=n.on("click",function(e){e.halt(),t.close()})},cleanEnvironmentAfterShowingInlineComment:function(e){e.removeClass("ui-state-inline-commenting"),this.shieldClickSubscription&&this.shieldClickSubscription.detach(),this.shieldClickSubscription=null},activate:function(){this.attachEvents({":getcomments":this.showCommentDialog})},render:function(){var e=this.get("photo-engagement"),t=e.getValue("commentCount");t?t>99?t="99+":t=t.toString():t="",this.buildContainer({commentCount:t})}}),e.namespace("Views")[n]=t},"@VERSION@",{requires:["flutil","dialog","display-item","comments-view","dialog","signin-helper","display-widget-comment-css","confirmation-dialog-view","hermes-template-widget-comment","url"],langBundles:["grease"]});
YUI.add("hermes-template-widget-meta",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=n.helperMissing;return s+='<div class="ui-display-widget-meta">\n	<span class="title">\n		<a href="',(o=n.photoUrl)?o=o.call(t,{hash:{},data:i}):(o=t.photoUrl,o=typeof o===a?o.apply(t):o),s+=f(o)+'" title="',(o=n.title)?o=o.call(t,{hash:{},data:i}):(o=t.title,o=typeof o===a?o.apply(t):o),s+=f(o)+'">',(o=n.title)?o=o.call(t,{hash:{},data:i}):(o=t.title,o=typeof o===a?o.apply(t):o),s+=f(o)+'</a>\n	</span>\n	<span class="attribution">\n		',u={hash:{intlName:"widget-meta.BY_LINK",userUrl:t.userUrl,displayName:t.displayName,displayName:t.displayName},data:i},s+=f((o=n.intlHTMLMessage||t.intlHTMLMessage,o?o.call(t,u):l.call(t,"intlHTMLMessage",u)))+"\n	</span>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/widget-meta",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("display-widget-meta",function(e){"use strict";var t,n=this.name,r=e.flutil;t=e.Base.create(n,e.Views["display-item"],[],{langBundles:this.details.langBundles,initializer:function(e){this.options=r.extend({templateName:"widget-meta"},e),this.photo=this.options.photo},initialize:function(){var e=this.photo,t=e.getValue("owner"),n,r;e.getValue("isOwner")?n=this.intlMessage({intlName:"widget-meta.YOU"}):n=t.getValue("displayname"),r={title:e.getValue("title")||this.intlMessage({intlName:"default.UNTITLED"}),photoUrl:e.getValue("url"),displayName:n,userUrl:t.getValue("url")},this.render(r)},activate:function(){},render:function(e){this.buildContainer(e)}}),e.namespace("Views")[n]=t},"@VERSION@",{requires:["flutil","display-item","display-widget-meta-css","hermes-template-widget-meta"],langBundles:["widget-meta","default"]});
YUI.add("hermes-lang-widget-meta",function(e,t){e.Intl.add("hermes/widget-meta","en-US",{BY_LINK:['by <a href="',"${userUrl}",'" title="',"${displayName}",'">',"${displayName}","</a>"],YOU:["YOU!"]})},"@VERSION@",{requires:["intl"]});
